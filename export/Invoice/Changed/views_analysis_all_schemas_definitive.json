[
  {
    "view_info": {
      "schema": "Billing",
      "name": "vwAccountBillings",
      "created": "2025-08-25 16:04:00.960000",
      "last_altered": "2025-08-25 16:04:00.960000",
      "check_option": "NO CHECK OPTION",
      "comment": "",
      "definition": "\r\nCREATE VIEW [Billing].[vwAccountBillings]\r\nAS\r\nSELECT B.BillingID,B.AmountBilled,B.AmountPaid,B.EnergySource,B.EnergyUnit,B.AccountEnergyUsage,B.EnergyUsage,B.AccountDemandUsage,B.DemandUsage,B.BillingPeriod,DATEDIFF(D, B.FromDate, B.ToDate) + 1 AS BillingPeriodDays,B.DateBilled,B.DateDue,B.FromDate,B.ToDate,B.IsEstimated,B.IsManualEntry,B.AccountID,CASE WHEN ISNULL(B.AccountID, 0) = 0 THEN B.AccountNumber ELSE A.AccountNumber END AS AccountNumber,A.FormattedAccountNumber,B.GroupID,G.GroupName,B.ProviderID,P.ProviderName,B.CreatedDate,B.CreatedBy,B.ModifiedDate,B.ModifiedBy,B.Active,B.IsLockedForEdit,B.ManualPaymentOverrideAmount\r\nFROM \r\n(\r\n\tSELECT BillingID,\r\n AccountID,\r\n AccountNumber,\r\n GroupID,\r\n ProviderID,\r\n AmountBilled,\r\n AmountPaid,\r\n EnergySource,\r\n AccountEnergyUsage,\r\n AccountDemandUsage,\r\n EnergyUnit,\r\n EnergyUsage,\r\n DemandUsage,\r\n DateBilled,\r\n DateDue,\r\n BillingPeriod,\r\n BillingPeriodDays,\r\n FromDate,\r\n ToDate,\r\n IsEstimated,\r\n IsManualEntry,\r\n Active,\r\n IsLockedForEdit,\r\n ManualPaymentOverrideAmount,\r\n CreatedDate,\r\n CreatedBy,\r\n ModifiedDate,\r\n ModifiedBy \r\n FROM Billing.EC3_Invoice_vwAccountBillingsManual\r\n\tUNION ALL\r\n\tSELECT \r\n BillingID,\r\n AccountID,\r\n AccountNumber,\r\n GroupID,\r\n ProviderID,\r\n AmountBilled,\r\n AmountPaid,\r\n EnergySource,\r\n AccountEnergyUsage,\r\n AccountDemandUsage,\r\n EnergyUnit,\r\n EnergyUsage,\r\n DemandUsage,\r\n DateBilled,\r\n DateDue,\r\n BillingPeriod,\r\n BillingPeriodDays,\r\n FromDate,\r\n ToDate,\r\n IsEstimated,\r\n IsManualEntry,\r\n Active,\r\n IsLockedForEdit,\r\n ManualPaymentOverrideAmount,\r\n CreatedDate,\r\n CreatedBy,\r\n ModifiedDate,\r\n ModifiedBy \r\n\tFROM Billing.EC3_Invoice_vwAccountBillingsManualConEdSteam_2\r\n) B\r\n\tLEFT JOIN Billing.EC3_Invoice_vwAccounts AS A ON A.AccountID = B.AccountID\r\n\tLEFT JOIN Billing.EC3_Invoice_vwProviders AS P ON P.ProviderID = B.ProviderID\r\n\tLEFT JOIN Billing.EC3_Invoice_vwInvoiceAccountGroups AS G ON G.GroupID = B.GroupID;\r\n",
      "is_replicated": false,
      "is_published": false
    },
    "columns": [
      {
        "name": "BillingID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 1,
        "comment": ""
      },
      {
        "name": "AmountBilled",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 20,
        "scale": 4,
        "ordinal_position": 2,
        "comment": ""
      },
      {
        "name": "AmountPaid",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 20,
        "scale": 4,
        "ordinal_position": 3,
        "comment": ""
      },
      {
        "name": "EnergySource",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 4,
        "comment": ""
      },
      {
        "name": "EnergyUnit",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 6,
        "precision": null,
        "scale": null,
        "ordinal_position": 5,
        "comment": ""
      },
      {
        "name": "AccountEnergyUsage",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 6,
        "comment": ""
      },
      {
        "name": "EnergyUsage",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 32,
        "precision": null,
        "scale": null,
        "ordinal_position": 7,
        "comment": ""
      },
      {
        "name": "AccountDemandUsage",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 12,
        "scale": 2,
        "ordinal_position": 8,
        "comment": ""
      },
      {
        "name": "DemandUsage",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 32,
        "precision": null,
        "scale": null,
        "ordinal_position": 9,
        "comment": ""
      },
      {
        "name": "BillingPeriod",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 6,
        "precision": null,
        "scale": null,
        "ordinal_position": 10,
        "comment": ""
      },
      {
        "name": "BillingPeriodDays",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 11,
        "comment": ""
      },
      {
        "name": "DateBilled",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 12,
        "comment": ""
      },
      {
        "name": "DateDue",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 13,
        "comment": ""
      },
      {
        "name": "FromDate",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 14,
        "comment": ""
      },
      {
        "name": "ToDate",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 15,
        "comment": ""
      },
      {
        "name": "IsEstimated",
        "data_type": "bit",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 16,
        "comment": ""
      },
      {
        "name": "IsManualEntry",
        "data_type": "bit",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 17,
        "comment": ""
      },
      {
        "name": "AccountID",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 18,
        "comment": ""
      },
      {
        "name": "AccountNumber",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 8000,
        "precision": null,
        "scale": null,
        "ordinal_position": 19,
        "comment": ""
      },
      {
        "name": "FormattedAccountNumber",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 20,
        "comment": ""
      },
      {
        "name": "GroupID",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 21,
        "comment": ""
      },
      {
        "name": "GroupName",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 22,
        "comment": ""
      },
      {
        "name": "ProviderID",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 23,
        "comment": ""
      },
      {
        "name": "ProviderName",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 24,
        "comment": ""
      },
      {
        "name": "CreatedDate",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 25,
        "comment": ""
      },
      {
        "name": "CreatedBy",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 26,
        "comment": ""
      },
      {
        "name": "ModifiedDate",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 27,
        "comment": ""
      },
      {
        "name": "ModifiedBy",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 28,
        "comment": ""
      },
      {
        "name": "Active",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 29,
        "comment": ""
      },
      {
        "name": "IsLockedForEdit",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 1,
        "precision": null,
        "scale": null,
        "ordinal_position": 30,
        "comment": ""
      },
      {
        "name": "ManualPaymentOverrideAmount",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 20,
        "scale": 4,
        "ordinal_position": 31,
        "comment": ""
      }
    ],
    "dependencies": [
      {
        "referenced_schema": "Billing",
        "referenced_object": "EC3_Invoice_vwAccountBillingsManual",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Billing",
        "referenced_object": "EC3_Invoice_vwAccountBillingsManualConEdSteam_2",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Billing",
        "referenced_object": "EC3_Invoice_vwAccounts",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Billing",
        "referenced_object": "EC3_Invoice_vwInvoiceAccountGroups",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Billing",
        "referenced_object": "EC3_Invoice_vwProviders",
        "referenced_type": "USER_TABLE"
      }
    ],
    "analysis": {
      "view_name": "vwAccountBillings",
      "explanation": "#### 1. Overview\nThe `Billing.vwAccountBillings` view is designed to aggregate and present billing information related to accounts, energy usage, and providers. It consolidates data from two primary sources: `Billing.EC3_Invoice_vwAccountBillingsManual` and `Billing.EC3_Invoice_vwAccountBillingsManualConEdSteam_2`, using a `UNION ALL` operation. The view enriches this data by joining with additional tables to include account details, provider information, and group names. This view is used for reporting and analysis of billing data, providing a comprehensive snapshot of billing activities and associated metadata.\n\n#### 2. Complexity Level: Medium\nThe complexity of this view is considered medium due to the following factors:\n- It involves a `UNION ALL` operation, which combines data from two similar structures, increasing the volume of data processed.\n- The view includes multiple `LEFT JOIN` operations to enrich the data with additional details from related tables.\n- The use of conditional logic in the `CASE` statement adds a layer of complexity to the data retrieval process.\n\n#### 3. Data Model Analysis\n- **Primary Data Sources**: The view pulls data from two main tables: `Billing.EC3_Invoice_vwAccountBillingsManual` and `Billing.EC3_Invoice_vwAccountBillingsManualConEdSteam_2`. These tables contain similar schema structures, as evidenced by the `UNION ALL` operation.\n- **Additional Dependencies**: The view joins with `Billing.EC3_Invoice_vwAccounts`, `Billing.EC3_Invoice_vwProviders`, and `Billing.EC3_Invoice_vwInvoiceAccountGroups` to obtain account numbers, provider names, and group names, respectively.\n- **Columns**: The view includes a wide range of columns, from identifiers and financial figures to dates and status flags, providing a comprehensive dataset for billing analysis.\n\n#### 4. Business Context and Use Cases\n- **Billing Analysis**: The view is used for analyzing billing data across different accounts and providers, helping businesses track billed amounts, payments, and usage metrics.\n- **Reporting**: It can serve as a foundation for generating reports that summarize billing activities, outstanding payments, and energy consumption patterns.\n- **Account Management**: The view provides insights into account-specific billing details, which can be useful for customer service and account management teams.\n\n#### 5. Performance Considerations\n- **Data Volume**: The `UNION ALL` operation can lead to large datasets, especially if the underlying tables are extensive. This could impact query performance.\n- **Join Operations**: The multiple `LEFT JOIN` operations, while necessary for data enrichment, can slow down query execution, particularly if the joined tables are large or lack proper indexing.\n- **Calculated Columns**: The `DATEDIFF` function and `CASE` statement introduce additional processing overhead, which could affect performance if the view is queried frequently.\n\n#### 6. Security and Access Control\n- **Access Control**: Ensure that access to this view is restricted to authorized users only, as it contains sensitive billing information.\n- **Data Sensitivity**: Columns such as `AmountBilled`, `AmountPaid`, and `AccountNumber` should be protected to prevent unauthorized access and data breaches.\n- **Role-Based Access**: Implement role-based access controls to ensure that users only have access to the data necessary for their roles.\n\n#### 7. Potential Issues or Recommendations\n- **Indexing**: Consider indexing the columns used in join conditions (`AccountID`, `ProviderID`, `GroupID`) to improve join performance.\n- **Data Quality**: Ensure data consistency and integrity across the underlying tables to prevent discrepancies in the view's output.\n- **Optimization**: Evaluate the necessity of all columns in the view. Removing unused or redundant columns can reduce the data footprint and improve performance.\n- **Documentation**: Maintain comprehensive documentation for the view, detailing its purpose, structure, and any business rules applied, to aid in maintenance and future development.",
      "complexity": "Medium",
      "model_used": "gpt-4o-2024-08-06",
      "tokens_used": 2152,
      "api_response_id": "chatcmpl-C8aZLu6FFDyQUp2IGXDSxGTTNp0Cq"
    },
    "analysis_timestamp": "2025-08-25 19:07:29"
  },
  {
    "view_info": {
      "schema": "Billing",
      "name": "vwAccounts",
      "created": "2025-08-25 16:04:00.967000",
      "last_altered": "2025-08-25 16:04:00.967000",
      "check_option": "NO CHECK OPTION",
      "comment": "",
      "definition": "CREATE VIEW [Billing].[vwAccounts]\r\nAS\r\nSELECT A.AccountID,A.AccountNumber,A.OriginalAccountNumber,A.FormattedAccountNumber,A.EnergySource,A.IsManualEntry,A.ProviderID,P.ProviderName,A.GroupID,G.GroupName,A.CreatedDate,A.CreatedBy,A.ModifiedDate,A.ModifiedBy,A.Active\r\nFROM Billing.EC3_Invoice_vwAccounts AS A\r\n LEFT JOIN Billing.EC3_Invoice_vwProviders AS P ON P.ProviderID = A.ProviderID\r\n LEFT JOIN Billing.EC3_Invoice_vwInvoiceAccountGroups AS G ON G.GroupID = A.GroupID;\r\n",
      "is_replicated": false,
      "is_published": false
    },
    "columns": [
      {
        "name": "AccountID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 1,
        "comment": ""
      },
      {
        "name": "AccountNumber",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 15,
        "precision": null,
        "scale": null,
        "ordinal_position": 2,
        "comment": ""
      },
      {
        "name": "OriginalAccountNumber",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 15,
        "precision": null,
        "scale": null,
        "ordinal_position": 3,
        "comment": ""
      },
      {
        "name": "FormattedAccountNumber",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 4,
        "comment": ""
      },
      {
        "name": "EnergySource",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 5,
        "comment": ""
      },
      {
        "name": "IsManualEntry",
        "data_type": "bit",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 6,
        "comment": ""
      },
      {
        "name": "ProviderID",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 7,
        "comment": ""
      },
      {
        "name": "ProviderName",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 8,
        "comment": ""
      },
      {
        "name": "GroupID",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 9,
        "comment": ""
      },
      {
        "name": "GroupName",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 10,
        "comment": ""
      },
      {
        "name": "CreatedDate",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 11,
        "comment": ""
      },
      {
        "name": "CreatedBy",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 12,
        "comment": ""
      },
      {
        "name": "ModifiedDate",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 13,
        "comment": ""
      },
      {
        "name": "ModifiedBy",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 14,
        "comment": ""
      },
      {
        "name": "Active",
        "data_type": "bit",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 15,
        "comment": ""
      }
    ],
    "dependencies": [
      {
        "referenced_schema": "Billing",
        "referenced_object": "EC3_Invoice_vwAccounts",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Billing",
        "referenced_object": "EC3_Invoice_vwInvoiceAccountGroups",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Billing",
        "referenced_object": "EC3_Invoice_vwProviders",
        "referenced_type": "USER_TABLE"
      }
    ],
    "analysis": {
      "view_name": "vwAccounts",
      "explanation": "#### 1. Overview\nThe `Billing.vwAccounts` view is a database object in Microsoft SQL Server that consolidates account-related information from multiple underlying tables or views. It provides a unified representation of account details, including identifiers, account numbers, provider information, group affiliations, and metadata about record creation and modification. The view is constructed using a series of LEFT JOIN operations to integrate data from three different sources: `Billing.EC3_Invoice_vwAccounts`, `Billing.EC3_Invoice_vwProviders`, and `Billing.EC3_Invoice_vwInvoiceAccountGroups`.\n\n#### 2. Complexity Level: Medium\nThe complexity of this view is considered medium due to the following factors:\n- **Structure**: The view involves multiple LEFT JOIN operations, which require careful handling of NULL values and join conditions.\n- **Dependencies**: It relies on three separate views, each of which have its own complexity and dependencies.\n- **SQL Logic**: The SQL logic is straightforward, but the integration of multiple data sources increases the complexity.\n\n#### 3. Data Model Analysis\n- **Primary Source**: `Billing.EC3_Invoice_vwAccounts` serves as the primary source, providing the core account details.\n- **Joins**:\n - **Provider Information**: Joined with `Billing.EC3_Invoice_vwProviders` to retrieve the `ProviderName` based on `ProviderID`.\n - **Group Information**: Joined with `Billing.EC3_Invoice_vwInvoiceAccountGroups` to obtain the `GroupName` using `GroupID`.\n- **Columns**: The view includes a mix of mandatory and optional fields, with `AccountID`, `AccountNumber`, and `OriginalAccountNumber` being non-nullable, ensuring essential account identifiers are always present.\n\n#### 4. Business Context and Use Cases\n- **Purpose**: The view is designed to provide a comprehensive snapshot of account information, useful for billing, reporting, and account management tasks.\n- **Use Cases**:\n - **Billing Operations**: Facilitates the generation of invoices by providing necessary account and provider details.\n - **Reporting**: Supports business intelligence and reporting needs by aggregating account data in a single view.\n - **Data Validation**: Assists in validating account information by cross-referencing provider and group details.\n\n#### 5. Performance Considerations\n- **Join Operations**: The use of LEFT JOINs can impact performance, especially if the underlying views are complex or involve large datasets.\n- **Indexing**: Ensuring that the join columns (`ProviderID`, `GroupID`) are indexed in the underlying tables/views can improve performance.\n- **View Materialization**: Consider materializing the view if it is frequently accessed and performance is a concern, although this may increase storage requirements.\n\n#### 6. Security and Access Control\n- **Access Control**: Ensure that access to the view is restricted to authorized users, as it consolidates sensitive account information.\n- **Row-Level Security**: Implement row-level security if different users require access to different subsets of data.\n- **Audit and Monitoring**: Regularly audit access to the view to ensure compliance with data governance policies.\n\n#### 7. Potential Issues or Recommendations\n- **Data Integrity**: Verify that the join conditions accurately reflect the relationships between the tables to prevent data inconsistencies.\n- **NULL Handling**: Review how NULL values are handled, especially in the context of LEFT JOINs, to ensure that the view returns meaningful results.\n- **View Maintenance**: Regularly review and update the view definition to accommodate changes in the underlying data model or business requirements.\n- **Documentation**: Maintain comprehensive documentation of the view's purpose, structure, and dependencies to facilitate maintenance and onboarding of new team members.",
      "complexity": "Medium",
      "model_used": "gpt-4o-2024-08-06",
      "tokens_used": 1454,
      "api_response_id": "chatcmpl-C8aZeB6dKsdtQOtAbfJX2UQaxaZxw"
    },
    "analysis_timestamp": "2025-08-25 19:07:49"
  },
  {
    "view_info": {
      "schema": "Billing",
      "name": "vwBillingGroupContracts",
      "created": "2025-08-25 16:04:00.920000",
      "last_altered": "2025-08-25 16:04:00.920000",
      "check_option": "NO CHECK OPTION",
      "comment": "",
      "definition": "CREATE VIEW [Billing].[vwBillingGroupContracts]\r\nAS\r\nSELECT BGC.BillingGroupContractID,BGC.FiscalYear,BGC.GroupID,G.GroupName,BGC.ContractID,C.ContractNumber,C.[Name] AS ContractName,C.FiscalYearStart,C.FiscalYearEnd,C.ActualAmount,C.CloseAmount,C.OpenAmount,C.ActualAmount - (C.CloseAmount + C.OpenAmount) AS AvailableAmount,BGC.CreatedDate,BGC.CreatedBy,BGC.ModifiedDate,BGC.ModifiedBy,BGC.Active\r\nFROM Billing.BillingGroupContract AS BGC\r\n\tLEFT JOIN Billing.vwBillingGroups AS G ON G.GroupID = BGC.GroupID\r\n\tLEFT JOIN Billing.[Contract] AS C ON C.ContractID = BGC.ContractID;\r\n",
      "is_replicated": false,
      "is_published": false
    },
    "columns": [
      {
        "name": "BillingGroupContractID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 1,
        "comment": ""
      },
      {
        "name": "FiscalYear",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 2,
        "comment": ""
      },
      {
        "name": "GroupID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 3,
        "comment": ""
      },
      {
        "name": "GroupName",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 4,
        "comment": ""
      },
      {
        "name": "ContractID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 5,
        "comment": ""
      },
      {
        "name": "ContractNumber",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 25,
        "precision": null,
        "scale": null,
        "ordinal_position": 6,
        "comment": ""
      },
      {
        "name": "ContractName",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 100,
        "precision": null,
        "scale": null,
        "ordinal_position": 7,
        "comment": ""
      },
      {
        "name": "FiscalYearStart",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 8,
        "precision": null,
        "scale": null,
        "ordinal_position": 8,
        "comment": ""
      },
      {
        "name": "FiscalYearEnd",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 8,
        "precision": null,
        "scale": null,
        "ordinal_position": 9,
        "comment": ""
      },
      {
        "name": "ActualAmount",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 10,
        "comment": ""
      },
      {
        "name": "CloseAmount",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 11,
        "comment": ""
      },
      {
        "name": "OpenAmount",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 12,
        "comment": ""
      },
      {
        "name": "AvailableAmount",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 20,
        "scale": 2,
        "ordinal_position": 13,
        "comment": ""
      },
      {
        "name": "CreatedDate",
        "data_type": "datetime",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 14,
        "comment": ""
      },
      {
        "name": "CreatedBy",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 15,
        "comment": ""
      },
      {
        "name": "ModifiedDate",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 16,
        "comment": ""
      },
      {
        "name": "ModifiedBy",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 17,
        "comment": ""
      },
      {
        "name": "Active",
        "data_type": "bit",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 18,
        "comment": ""
      }
    ],
    "dependencies": [
      {
        "referenced_schema": "Billing",
        "referenced_object": "BillingGroupContract",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Billing",
        "referenced_object": "Contract",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Billing",
        "referenced_object": "vwBillingGroups",
        "referenced_type": "VIEW"
      }
    ],
    "analysis": {
      "view_name": "vwBillingGroupContracts",
      "explanation": "#### 1. Overview\nThe view `Billing.vwBillingGroupContracts` is designed to provide a consolidated view of billing group contracts by combining data from multiple sources within the database. It aggregates information from the `BillingGroupContract` table, the `Contract` table, and the `vwBillingGroups` view. The view includes details such as contract identifiers, fiscal year information, group and contract names, financial amounts, and metadata about record creation and modification. The view calculates the `AvailableAmount` by subtracting the sum of `CloseAmount` and `OpenAmount` from `ActualAmount`.\n\n#### 2. Complexity Level: Medium\nThe complexity of this view is considered medium due to the following factors:\n- It involves joining three different data sources: two tables and one view.\n- It includes a calculated column (`AvailableAmount`), which adds a layer of complexity.\n- The view does not include any complex SQL logic such as subqueries or aggregations, which keeps the complexity from being high.\n\n#### 3. Data Model Analysis\n- **Billing.BillingGroupContract (USER_TABLE):** This table is the primary source of data for the view, containing the core attributes of billing group contracts such as `BillingGroupContractID`, `FiscalYear`, `GroupID`, `ContractID`, and metadata fields.\n- **Billing.Contract (USER_TABLE):** This table provides additional contract-specific details like `ContractNumber`, `ContractName`, and financial amounts (`ActualAmount`, `CloseAmount`, `OpenAmount`).\n- **Billing.vwBillingGroups (VIEW):** This view is used to retrieve the `GroupName` based on the `GroupID`. It abstracts the complexity of fetching group names, from a more complex underlying structure.\n\n#### 4. Business Context and Use Cases\nThe view is used in scenarios where a comprehensive overview of billing group contracts is required. Potential use cases include:\n- Generating reports for financial analysis and auditing.\n- Providing data for dashboards that track contract performance and financial metrics.\n- Supporting decision-making processes by offering insights into contract availability and fiscal year allocations.\n\n#### 5. Performance Considerations\n- **Joins:** The view uses LEFT JOINs, which can be performance-intensive if the underlying tables/views are large. Indexing on `GroupID` and `ContractID` in the respective tables can help optimize these joins.\n- **Calculated Column:** The calculation of `AvailableAmount` is straightforward but should be monitored for performance impact if the view is queried frequently or on large datasets.\n- **View Dependencies:** The performance of `vwBillingGroups` can affect this view, as it is part of the join operation.\n\n#### 6. Security and Access Control\n- **Access Control:** Ensure that only authorized users have access to this view, as it contains sensitive financial data. Implement role-based access control (RBAC) to manage permissions effectively.\n- **Data Sensitivity:** Consider masking or encrypting sensitive columns if the view is exposed to users who do not require full access to all data fields.\n\n#### 7. Potential Issues or Recommendations\n- **Data Integrity:** Ensure that the underlying tables and views maintain referential integrity, especially since the view relies on joins across multiple sources.\n- **Indexing:** Evaluate and implement appropriate indexing strategies on the `BillingGroupContract`, `Contract`, and any tables/views involved in `vwBillingGroups` to enhance query performance.\n- **View Maintenance:** Regularly review and update the view definition to accommodate changes in business requirements or underlying data structures.\n- **Documentation:** Maintain comprehensive documentation for the view, including its purpose, dependencies, and any business logic encapsulated within it, to aid in future maintenance and troubleshooting efforts.",
      "complexity": "Medium",
      "model_used": "gpt-4o-2024-08-06",
      "tokens_used": 1489,
      "api_response_id": "chatcmpl-C8aZysXImbyfK7RHguYX8dkRsKugb"
    },
    "analysis_timestamp": "2025-08-25 19:08:05"
  },
  {
    "view_info": {
      "schema": "Billing",
      "name": "vwBillingGroups",
      "created": "2025-08-25 16:04:00.737000",
      "last_altered": "2025-08-25 16:04:00.737000",
      "check_option": "NO CHECK OPTION",
      "comment": "",
      "definition": "CREATE VIEW [Billing].[vwBillingGroups]\r\nAS\r\nSELECT G.GroupID,G.GroupName,G.GroupDescription,G.SummaryAccountNumber,CAST(IIF(NULLIF(G.SummaryAccountNumber, '') IS NULL, 0, 1) AS BIT) AS IsSummaryBilling,G.BillingType,G.ProviderID,P.ProviderName,(SELECT COUNT(1) FROM Billing.EC3_Invoice_vwAccounts WHERE GroupID = G.GroupID AND Active = 1) AS AccountCount,G.CreatedDate,G.CreatedBy,G.ModifiedDate,G.ModifiedBy,G.Active\r\nFROM Billing.EC3_Invoice_vwInvoiceAccountGroups AS G\r\n\tLEFT JOIN Billing.EC3_Invoice_vwProviders AS P ON P.ProviderID = G.ProviderID;\r\n",
      "is_replicated": false,
      "is_published": false
    },
    "columns": [
      {
        "name": "GroupID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 1,
        "comment": ""
      },
      {
        "name": "GroupName",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 2,
        "comment": ""
      },
      {
        "name": "GroupDescription",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 75,
        "precision": null,
        "scale": null,
        "ordinal_position": 3,
        "comment": ""
      },
      {
        "name": "SummaryAccountNumber",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 15,
        "precision": null,
        "scale": null,
        "ordinal_position": 4,
        "comment": ""
      },
      {
        "name": "IsSummaryBilling",
        "data_type": "bit",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 5,
        "comment": ""
      },
      {
        "name": "BillingType",
        "data_type": "char",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 1,
        "precision": null,
        "scale": null,
        "ordinal_position": 6,
        "comment": ""
      },
      {
        "name": "ProviderID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 7,
        "comment": ""
      },
      {
        "name": "ProviderName",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 8,
        "comment": ""
      },
      {
        "name": "AccountCount",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 9,
        "comment": ""
      },
      {
        "name": "CreatedDate",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 10,
        "comment": ""
      },
      {
        "name": "CreatedBy",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 11,
        "comment": ""
      },
      {
        "name": "ModifiedDate",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 12,
        "comment": ""
      },
      {
        "name": "ModifiedBy",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 13,
        "comment": ""
      },
      {
        "name": "Active",
        "data_type": "bit",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 14,
        "comment": ""
      }
    ],
    "dependencies": [
      {
        "referenced_schema": "Billing",
        "referenced_object": "EC3_Invoice_vwAccounts",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Billing",
        "referenced_object": "EC3_Invoice_vwInvoiceAccountGroups",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Billing",
        "referenced_object": "EC3_Invoice_vwProviders",
        "referenced_type": "USER_TABLE"
      }
    ],
    "analysis": {
      "view_name": "vwBillingGroups",
      "explanation": "#### 1. Overview\nThe view `Billing.vwBillingGroups` is designed to provide a consolidated view of billing groups within a billing system. It aggregates information from multiple underlying tables/views to present a comprehensive dataset that includes group details, provider information, and account counts. The view is structured to facilitate the retrieval of billing group data, including metadata about the group, its associated provider, and the number of active accounts linked to each group.\n\n#### 2. Complexity Level: Medium\nThe complexity of this view is considered medium due to the following factors:\n- **Join Operations**: The view involves a LEFT JOIN operation between two views, which adds a layer of complexity in terms of ensuring data integrity and performance.\n- **Subquery**: The use of a subquery to calculate `AccountCount` introduces additional complexity, as it requires scanning the `Billing.EC3_Invoice_vwAccounts` table for each group.\n- **Conditional Logic**: The use of the `IIF` function to determine `IsSummaryBilling` adds logical complexity to the view.\n\n#### 3. Data Model Analysis\n- **Primary Table/View**: `Billing.EC3_Invoice_vwInvoiceAccountGroups` serves as the primary source of data, providing the core attributes of each billing group.\n- **Joined Table/View**: `Billing.EC3_Invoice_vwProviders` is joined to enrich the dataset with provider information.\n- **Subquery Dependency**: The subquery references `Billing.EC3_Invoice_vwAccounts` to calculate the number of active accounts per group.\n- **Columns**: The view includes a mix of direct column selections, calculated fields (e.g., `IsSummaryBilling`), and aggregated data (`AccountCount`).\n\n#### 4. Business Context and Use Cases\n- **Billing Management**: This view is used in billing management applications to display and manage billing groups, providing insights into group composition and associated providers.\n- **Reporting**: It can be used in reporting scenarios where stakeholders need to understand the distribution and status of billing groups, including active account counts.\n- **Operational Dashboards**: The view can be integrated into dashboards for real-time monitoring of billing group metrics.\n\n#### 5. Performance Considerations\n- **Join Performance**: The LEFT JOIN operation can impact performance, especially if the `Billing.EC3_Invoice_vwProviders` view is large or lacks proper indexing on `ProviderID`.\n- **Subquery Efficiency**: The subquery for `AccountCount` could be a performance bottleneck if `Billing.EC3_Invoice_vwAccounts` is large and not indexed on `GroupID` and `Active`.\n- **Indexing**: Ensuring that the underlying tables/views have appropriate indexes on join and filter columns (e.g., `ProviderID`, `GroupID`, `Active`) is crucial for optimizing query performance.\n\n#### 6. Security and Access Control\n- **View Permissions**: Access to the view should be controlled through SQL Server's role-based security, granting permissions only to users who require access to billing group data.\n- **Underlying Data Security**: Ensure that the underlying tables/views also have appropriate security measures in place to prevent unauthorized access.\n- **Data Sensitivity**: Consider the sensitivity of the data exposed by the view, such as provider names and account counts, and apply additional security controls if necessary.\n\n#### 7. Potential Issues or Recommendations\n- **Data Integrity**: Ensure that the data in `Billing.EC3_Invoice_vwInvoiceAccountGroups` and `Billing.EC3_Invoice_vwProviders` is consistent and that referential integrity is maintained.\n- **Index Optimization**: Review and optimize indexes on the underlying tables/views to improve join and subquery performance.\n- **View Maintenance**: Regularly review the view definition and its dependencies to ensure they align with evolving business requirements and data model changes.\n- **Scalability**: As data volume grows, consider partitioning strategies or materialized views to enhance performance and scalability.\n- **Documentation**: Maintain comprehensive documentation of the view's purpose, structure, and dependencies to aid in maintenance and onboarding of new team members.",
      "complexity": "Medium",
      "model_used": "gpt-4o-2024-08-06",
      "tokens_used": 1535,
      "api_response_id": "chatcmpl-C8aaEGVWWwtk0G60su2Fdwa5Ot3hS"
    },
    "analysis_timestamp": "2025-08-25 19:08:21"
  },
  {
    "view_info": {
      "schema": "Billing",
      "name": "vwBillingPeriods",
      "created": "2025-08-25 16:04:00.973000",
      "last_altered": "2025-08-25 16:04:00.973000",
      "check_option": "NO CHECK OPTION",
      "comment": "",
      "definition": "CREATE VIEW [Billing].[vwBillingPeriods]\r\nAS\r\nSELECT BillingPeriod,BillingPeriodDescription,Active\r\nFROM Billing.BillingPeriod;\r\n",
      "is_replicated": false,
      "is_published": false
    },
    "columns": [
      {
        "name": "BillingPeriod",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 6,
        "precision": null,
        "scale": null,
        "ordinal_position": 1,
        "comment": ""
      },
      {
        "name": "BillingPeriodDescription",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 100,
        "precision": null,
        "scale": null,
        "ordinal_position": 2,
        "comment": ""
      },
      {
        "name": "Active",
        "data_type": "bit",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 3,
        "comment": ""
      }
    ],
    "dependencies": [
      {
        "referenced_schema": "Billing",
        "referenced_object": "BillingPeriod",
        "referenced_type": "USER_TABLE"
      }
    ],
    "analysis": {
      "view_name": "vwBillingPeriods",
      "explanation": "#### 1. Overview\nThe view `Billing.vwBillingPeriods` is a SQL Server database view that provides a simplified and structured representation of billing periods from the `Billing.BillingPeriod` table. It selects three columns: `BillingPeriod`, `BillingPeriodDescription`, and `Active`. The view is designed to present billing period data in a straightforward manner, for reporting or application consumption purposes. The absence of a check option indicates that there are no constraints on the data modifications through this view.\n\n#### 2. Complexity Level: Low\nThe complexity level of this view is low. It is a direct selection of columns from a single table without any additional logic, joins, or transformations. The view does not include any computed columns, aggregations, or subqueries, which contributes to its simplicity.\n\n#### 3. Data Model Analysis\n- **Underlying Table**: The view depends on the `Billing.BillingPeriod` table. This table is assumed to store information about different billing periods, including a unique identifier (`BillingPeriod`), a description (`BillingPeriodDescription`), and a status indicator (`Active`).\n- **Columns**:\n - `BillingPeriod` (varchar(6), NOT NULL): a code or identifier for the billing period.\n - `BillingPeriodDescription` (varchar(100), NULL): A textual description of the billing period, which can be null.\n - `Active` (bit, NOT NULL): A boolean flag indicating whether the billing period is currently active.\n\n#### 4. Business Context and Use Cases\n- **Business Context**: This view is used in financial or billing systems to manage and display billing periods. It can be used by applications that need to present billing period information to users or by reporting tools that generate billing-related reports.\n- **Use Cases**:\n - Displaying a list of billing periods in a user interface.\n - Filtering active billing periods for processing or reporting.\n - Providing a data source for reports that require billing period information.\n\n#### 5. Performance Considerations\n- **Efficiency**: The view is efficient due to its simplicity and direct mapping to a single table without any complex operations.\n- **Indexing**: Performance can be further optimized by ensuring that the `Billing.BillingPeriod` table has appropriate indexes, especially on the `BillingPeriod` and `Active` columns if they are frequently used in WHERE clauses.\n- **Scalability**: Given its simplicity, the view should scale well with the size of the `Billing.BillingPeriod` table, assuming the table itself is properly indexed and maintained.\n\n#### 6. Security and Access Control\n- **Access Control**: Security should be managed at the database level by granting appropriate permissions to users or roles that need access to this view. Since the view does not include sensitive data transformations, standard access controls should suffice.\n- **Data Integrity**: The absence of a check option means that data integrity is not enforced through the view. Any updates or inserts through the view should be carefully managed to ensure data consistency.\n\n#### 7. Potential Issues or Recommendations\n- **Nullability**: Consider whether `BillingPeriodDescription` should allow nulls. If descriptions are mandatory, the underlying table definition should be updated to reflect this.\n- **Documentation**: Ensure that the view is well-documented, including its purpose and any business rules it supports, to aid future maintenance and understanding.\n- **Indexing**: Review and optimize indexes on the `Billing.BillingPeriod` table to ensure efficient query performance, especially if the view is used in high-frequency queries.\n- **Check Option**: Evaluate whether a check option is necessary to enforce data integrity when updates are performed through the view.",
      "complexity": "Low",
      "model_used": "gpt-4o-2024-08-06",
      "tokens_used": 1152,
      "api_response_id": "chatcmpl-C8aaUhwo4wqjsQhmq19YHBQNfqSm1"
    },
    "analysis_timestamp": "2025-08-25 19:08:36"
  },
  {
    "view_info": {
      "schema": "Billing",
      "name": "vwBillingPeriodsByBillingType",
      "created": "2025-08-25 16:04:00.983000",
      "last_altered": "2025-08-25 16:04:00.983000",
      "check_option": "NO CHECK OPTION",
      "comment": "",
      "definition": "CREATE VIEW [Billing].[vwBillingPeriodsByBillingType]\r\nAS\r\nSELECT IBP.BillingType,IBP.BillingPeriod,BP.BillingPeriodDescription,IBP.IsCurrentProcessingPeriod,IBP.PublishedBillingPeriod,IBP.FiscalYear,FY.FiscalYearStart,FY.FiscalYearEnd,BP.Active\r\nFROM Billing.EC3_Invoice_vwBillingPeriods AS IBP\r\n\tLEFT JOIN Billing.BillingPeriod AS BP ON BP.BillingPeriod = IBP.BillingPeriod\r\n\tLEFT JOIN Billing.FiscalYear AS FY ON FY.FiscalYear = IBP.FiscalYear;\r\n",
      "is_replicated": false,
      "is_published": false
    },
    "columns": [
      {
        "name": "BillingType",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 1,
        "precision": null,
        "scale": null,
        "ordinal_position": 1,
        "comment": ""
      },
      {
        "name": "BillingPeriod",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 6,
        "precision": null,
        "scale": null,
        "ordinal_position": 2,
        "comment": ""
      },
      {
        "name": "BillingPeriodDescription",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 100,
        "precision": null,
        "scale": null,
        "ordinal_position": 3,
        "comment": ""
      },
      {
        "name": "IsCurrentProcessingPeriod",
        "data_type": "bit",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 4,
        "comment": ""
      },
      {
        "name": "PublishedBillingPeriod",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 6,
        "precision": null,
        "scale": null,
        "ordinal_position": 5,
        "comment": ""
      },
      {
        "name": "FiscalYear",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 6,
        "comment": ""
      },
      {
        "name": "FiscalYearStart",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 8,
        "precision": null,
        "scale": null,
        "ordinal_position": 7,
        "comment": ""
      },
      {
        "name": "FiscalYearEnd",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 8,
        "precision": null,
        "scale": null,
        "ordinal_position": 8,
        "comment": ""
      },
      {
        "name": "Active",
        "data_type": "bit",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 9,
        "comment": ""
      }
    ],
    "dependencies": [
      {
        "referenced_schema": "Billing",
        "referenced_object": "BillingPeriod",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Billing",
        "referenced_object": "EC3_Invoice_vwBillingPeriods",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Billing",
        "referenced_object": "FiscalYear",
        "referenced_type": "USER_TABLE"
      }
    ],
    "analysis": {
      "view_name": "vwBillingPeriodsByBillingType",
      "explanation": "#### 1. Overview\nThe view `Billing.vwBillingPeriodsByBillingType` is designed to provide a consolidated view of billing periods categorized by billing type. It aggregates data from three underlying tables: `BillingPeriod`, `EC3_Invoice_vwBillingPeriods`, and `FiscalYear`. The view combines billing period information with fiscal year details and indicates whether a billing period is the current processing period or has been published. This view is used to facilitate reporting and analysis of billing cycles within a fiscal context.\n\n#### 2. Complexity Level: Medium\nThe complexity of this view is considered medium due to the following factors:\n- It involves multiple joins across three tables.\n- It includes a mix of nullable and non-nullable columns, which requires careful handling in queries.\n- The view does not include any complex calculations or subqueries, which keeps the complexity from being high.\n\n#### 3. Data Model Analysis\n- **Billing.EC3_Invoice_vwBillingPeriods**: This table/view is the primary source of billing period data, including the billing type, current processing period status, published period, and fiscal year.\n- **Billing.BillingPeriod**: This table provides additional descriptive information about each billing period, such as the description and active status.\n- **Billing.FiscalYear**: This table supplies fiscal year boundaries, which are crucial for understanding the temporal context of billing periods.\n\nThe view uses left joins, indicating that not all billing periods have corresponding entries in the `BillingPeriod` or `FiscalYear` tables, allowing for flexibility in data representation.\n\n#### 4. Business Context and Use Cases\n- **Reporting**: The view is used in financial reporting to track and analyze billing periods by type and fiscal year.\n- **Billing Cycle Management**: It can assist in managing billing cycles by identifying current and published billing periods.\n- **Audit and Compliance**: The view can be used to ensure that billing periods align with fiscal year boundaries and to verify the active status of billing periods.\n\n#### 5. Performance Considerations\n- **Join Operations**: The use of left joins can impact performance, especially if the tables involved are large. Indexing on join columns (`BillingPeriod` and `FiscalYear`) can help mitigate this.\n- **Data Volume**: The performance will depend on the volume of data in the underlying tables. Regular maintenance, such as indexing and statistics updates, will be crucial.\n- **View Complexity**: While the view is not overly complex, the inclusion of nullable columns may require additional handling in downstream queries, potentially affecting performance.\n\n#### 6. Security and Access Control\n- **Access Control**: Ensure that access to the view is restricted to authorized users, as it contain sensitive financial information.\n- **Row-Level Security**: Consider implementing row-level security if different users should see different subsets of the data based on their roles.\n- **Data Masking**: If the view is exposed to users who should not see certain details, consider using data masking techniques.\n\n#### 7. Potential Issues or Recommendations\n- **Data Integrity**: Ensure that the data in `BillingPeriod` and `FiscalYear` is consistently maintained to avoid discrepancies in the view.\n- **Indexing**: Evaluate and implement appropriate indexing strategies on the join columns to enhance performance.\n- **Null Handling**: Consider how null values in columns like `BillingPeriodDescription`, `FiscalYearStart`, and `FiscalYearEnd` are handled in downstream applications to prevent errors.\n- **Documentation**: Maintain comprehensive documentation for the view, including its purpose, structure, and any business rules it enforces, to aid in maintenance and onboarding of new team members.",
      "complexity": "Medium",
      "model_used": "gpt-4o-2024-08-06",
      "tokens_used": 1352,
      "api_response_id": "chatcmpl-C8aajCnqkKbZtOTja8i9SwzkFvCff"
    },
    "analysis_timestamp": "2025-08-25 19:08:48"
  },
  {
    "view_info": {
      "schema": "Billing",
      "name": "vwContractLines",
      "created": "2025-08-25 16:04:00.987000",
      "last_altered": "2025-08-25 16:04:00.987000",
      "check_option": "NO CHECK OPTION",
      "comment": "",
      "definition": "CREATE VIEW [Billing].[vwContractLines]\r\nAS\r\nSELECT CL.ContractLineID,CL.FiscalYear,CL.CommodityLine,CL.AccountingLine,CL.BudgetCode,CL.ObjectCode,CL.UoA,CL.ActualAmount,CL.CloseAmount,CL.OpenAmount,CL.ActualAmount - CL.CloseAmount AS AvailableAmount,CL.ContractID,C.ContractNumber,CL.CreatedDate,CL.CreatedBy,CL.ModifiedDate,CL.ModifiedBy,CL.Active\r\nFROM Billing.ContractLine AS CL\r\n\tLEFT JOIN Billing.[Contract] AS C ON C.ContractID = CL.ContractID;\r\n",
      "is_replicated": false,
      "is_published": false
    },
    "columns": [
      {
        "name": "ContractLineID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 1,
        "comment": ""
      },
      {
        "name": "FiscalYear",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 2,
        "comment": ""
      },
      {
        "name": "CommodityLine",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 3,
        "comment": ""
      },
      {
        "name": "AccountingLine",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 4,
        "comment": ""
      },
      {
        "name": "BudgetCode",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 5,
        "comment": ""
      },
      {
        "name": "ObjectCode",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 3,
        "precision": null,
        "scale": null,
        "ordinal_position": 6,
        "comment": ""
      },
      {
        "name": "UoA",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 3,
        "precision": null,
        "scale": null,
        "ordinal_position": 7,
        "comment": ""
      },
      {
        "name": "ActualAmount",
        "data_type": "decimal",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 8,
        "comment": ""
      },
      {
        "name": "CloseAmount",
        "data_type": "decimal",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 9,
        "comment": ""
      },
      {
        "name": "OpenAmount",
        "data_type": "decimal",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 10,
        "comment": ""
      },
      {
        "name": "AvailableAmount",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 19,
        "scale": 2,
        "ordinal_position": 11,
        "comment": ""
      },
      {
        "name": "ContractID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 12,
        "comment": ""
      },
      {
        "name": "ContractNumber",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 25,
        "precision": null,
        "scale": null,
        "ordinal_position": 13,
        "comment": ""
      },
      {
        "name": "CreatedDate",
        "data_type": "datetime",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 14,
        "comment": ""
      },
      {
        "name": "CreatedBy",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 15,
        "comment": ""
      },
      {
        "name": "ModifiedDate",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 16,
        "comment": ""
      },
      {
        "name": "ModifiedBy",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 17,
        "comment": ""
      },
      {
        "name": "Active",
        "data_type": "bit",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 18,
        "comment": ""
      }
    ],
    "dependencies": [
      {
        "referenced_schema": "Billing",
        "referenced_object": "Contract",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Billing",
        "referenced_object": "ContractLine",
        "referenced_type": "USER_TABLE"
      }
    ],
    "analysis": {
      "view_name": "vwContractLines",
      "explanation": "#### 1. Overview\nThe `Billing.vwContractLines` view is designed to provide a comprehensive overview of contract line items within a billing system. It aggregates data from two primary tables: `Billing.ContractLine` and `Billing.Contract`. The view includes detailed financial information such as actual, closed, and open amounts, along with metadata about the contract lines, including fiscal year, budget codes, and user audit information. The view also calculates the `AvailableAmount` as the difference between `ActualAmount` and `CloseAmount`, providing insight into the remaining funds available for each contract line.\n\n#### 2. Complexity Level: Medium\nThe complexity of this view is considered medium due to the following factors:\n- **Structure**: The view involves a straightforward SELECT statement with a LEFT JOIN between two tables.\n- **Dependencies**: It relies on two tables, which adds a layer of dependency but is not overly complex.\n- **SQL Logic**: The SQL logic includes a simple arithmetic operation to calculate `AvailableAmount`, which is not complex but requires understanding of the business logic.\n\n#### 3. Data Model Analysis\n- **Underlying Tables**:\n - `Billing.ContractLine`: This table store detailed information about each contract line, including financial data and metadata.\n - `Billing.Contract`: This table contains overarching contract information, such as the contract number, which is joined to the `ContractLine` table via `ContractID`.\n- **View Columns**: The view selects columns from both tables, with a calculated column (`AvailableAmount`) that provides additional insight into the financial status of each contract line.\n\n#### 4. Business Context and Use Cases\n- **Business Context**: This view is used in financial reporting and analysis within a billing or contract management system. It provides a detailed breakdown of contract lines, which is essential for budget tracking and financial audits.\n- **Use Cases**:\n - Generating reports on contract line financials for fiscal analysis.\n - Monitoring available funds for each contract line to ensure budget compliance.\n - Supporting decision-making processes related to contract management and financial planning.\n\n#### 5. Performance Considerations\n- **Join Operation**: The LEFT JOIN operation between `ContractLine` and `Contract` could impact performance, especially if the tables are large or not properly indexed. Ensuring that `ContractID` is indexed in both tables will help optimize the join.\n- **Calculated Column**: The calculation of `AvailableAmount` is performed on-the-fly, which could affect performance if the view is queried frequently or on large datasets.\n- **Indexing**: Consider indexing columns that are frequently filtered or joined on, such as `ContractID`, to improve query performance.\n\n#### 6. Security and Access Control\n- **Access Control**: Ensure that access to this view is restricted to users who require it for their roles, as it contains sensitive financial information.\n- **Data Sensitivity**: The view includes financial data and user audit information, which should be protected according to organizational data governance policies.\n- **No Check Option**: The absence of a CHECK OPTION means that there is no enforcement of data integrity constraints at the view level, which is acceptable for read-only views but should be considered if updates are allowed through the view.\n\n#### 7. Potential Issues or Recommendations\n- **Data Integrity**: Since the view does not have a CHECK OPTION, ensure that data integrity is maintained at the table level.\n- **Performance Optimization**: Evaluate the need for additional indexes on frequently queried columns to enhance performance.\n- **Documentation**: Provide clear documentation on the business logic behind the `AvailableAmount` calculation to ensure consistent understanding across the team.\n- **Security Review**: Conduct regular security reviews to ensure that access controls are up-to-date and that sensitive data is adequately protected.",
      "complexity": "Medium",
      "model_used": "gpt-4o-2024-08-06",
      "tokens_used": 1473,
      "api_response_id": "chatcmpl-C8aav6nMQmbL9SnESILDhPcIVz6IV"
    },
    "analysis_timestamp": "2025-08-25 19:09:08"
  },
  {
    "view_info": {
      "schema": "Billing",
      "name": "vwContracts",
      "created": "2025-08-25 16:04:00.923000",
      "last_altered": "2025-08-25 16:04:00.923000",
      "check_option": "NO CHECK OPTION",
      "comment": "",
      "definition": "CREATE VIEW [Billing].[vwContracts]\r\nAS\r\nSELECT C.ContractID,C.ContractNumber,C.[Name],C.[Description],C.ProviderID,P.ProviderName,C.FiscalYearStart,C.FiscalYearEnd,C.ActualAmount,C.CloseAmount,C.OpenAmount,C.ActualAmount - (C.CloseAmount + C.OpenAmount) AS AvailableAmount,C.CreatedDate,C.CreatedBy,C.ModifiedDate,C.ModifiedBy,C.Active,C.CapacityAmount\r\nFROM Billing.[Contract] AS C\r\n\tLEFT JOIN Billing.vwProviders AS P ON P.ProviderID = C.ProviderID;\r\n",
      "is_replicated": false,
      "is_published": false
    },
    "columns": [
      {
        "name": "ContractID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 1,
        "comment": ""
      },
      {
        "name": "ContractNumber",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 25,
        "precision": null,
        "scale": null,
        "ordinal_position": 2,
        "comment": ""
      },
      {
        "name": "Name",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 100,
        "precision": null,
        "scale": null,
        "ordinal_position": 3,
        "comment": ""
      },
      {
        "name": "Description",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 500,
        "precision": null,
        "scale": null,
        "ordinal_position": 4,
        "comment": ""
      },
      {
        "name": "ProviderID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 5,
        "comment": ""
      },
      {
        "name": "ProviderName",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 6,
        "comment": ""
      },
      {
        "name": "FiscalYearStart",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 8,
        "precision": null,
        "scale": null,
        "ordinal_position": 7,
        "comment": ""
      },
      {
        "name": "FiscalYearEnd",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 8,
        "precision": null,
        "scale": null,
        "ordinal_position": 8,
        "comment": ""
      },
      {
        "name": "ActualAmount",
        "data_type": "decimal",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 9,
        "comment": ""
      },
      {
        "name": "CloseAmount",
        "data_type": "decimal",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 10,
        "comment": ""
      },
      {
        "name": "OpenAmount",
        "data_type": "decimal",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 11,
        "comment": ""
      },
      {
        "name": "AvailableAmount",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 20,
        "scale": 2,
        "ordinal_position": 12,
        "comment": ""
      },
      {
        "name": "CreatedDate",
        "data_type": "datetime",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 13,
        "comment": ""
      },
      {
        "name": "CreatedBy",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 14,
        "comment": ""
      },
      {
        "name": "ModifiedDate",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 15,
        "comment": ""
      },
      {
        "name": "ModifiedBy",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 16,
        "comment": ""
      },
      {
        "name": "Active",
        "data_type": "bit",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 17,
        "comment": ""
      },
      {
        "name": "CapacityAmount",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 18,
        "comment": ""
      }
    ],
    "dependencies": [
      {
        "referenced_schema": "Billing",
        "referenced_object": "Contract",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Billing",
        "referenced_object": "vwProviders",
        "referenced_type": "VIEW"
      }
    ],
    "analysis": {
      "view_name": "vwContracts",
      "explanation": "#### 1. Overview\nThe `Billing.vwContracts` view is designed to provide a consolidated view of contract-related information from the `Billing.Contract` table and the `Billing.vwProviders` view. It combines contract details with provider names, calculates the available amount for each contract, and includes metadata about the creation and modification of the records. The view is structured to facilitate easy access to comprehensive contract data, which is essential for billing and financial analysis.\n\n#### 2. Complexity Level: Medium\nThe complexity of this view is considered medium due to the following factors:\n- **Structure**: The view involves a straightforward SELECT statement with a LEFT JOIN operation, which is relatively simple but requires understanding of the join logic.\n- **Dependencies**: It depends on one table (`Billing.Contract`) and one view (`Billing.vwProviders`), which adds a layer of complexity in terms of dependency management.\n- **SQL Logic**: The view includes a calculated column (`AvailableAmount`), which requires understanding of basic arithmetic operations within SQL.\n\n#### 3. Data Model Analysis\n- **Underlying Tables/Views**:\n - `Billing.Contract`: This table is the primary source of contract data, including financial figures and metadata.\n - `Billing.vwProviders`: This view provides provider names, which are joined to the contract data via `ProviderID`.\n- **Columns**: The view includes a mix of direct columns from the `Contract` table and a derived column (`AvailableAmount`), which is calculated as `ActualAmount - (CloseAmount + OpenAmount)`.\n- **Join Logic**: A LEFT JOIN is used to include all contracts, even if there is no matching provider in `vwProviders`, ensuring that all contract data is represented.\n\n#### 4. Business Context and Use Cases\n- **Purpose**: The view is used for financial reporting, contract management, and billing processes. It provides a comprehensive snapshot of contract statuses and financial metrics.\n- **Use Cases**:\n - Generating reports on contract financials, including available amounts.\n - Analyzing contract activity and provider associations.\n - Supporting billing operations by providing necessary contract details.\n\n#### 5. Performance Considerations\n- **Join Operation**: The LEFT JOIN with `vwProviders` could impact performance, especially if `vwProviders` is complex or involves large datasets.\n- **Calculated Column**: The calculation of `AvailableAmount` is performed at runtime, which could affect performance if the dataset is large.\n- **Indexes**: Ensuring that `ProviderID` is indexed in both the `Contract` table and `vwProviders` can improve join performance.\n\n#### 6. Security and Access Control\n- **Access Control**: Ensure that only authorized users have access to this view, as it contains sensitive financial data.\n- **Row-Level Security**: Consider implementing row-level security if different users should see different subsets of data based on their roles.\n- **Data Sensitivity**: Columns like `ActualAmount`, `CloseAmount`, and `OpenAmount` require additional protection due to their financial nature.\n\n#### 7. Potential Issues or Recommendations\n- **Data Integrity**: Ensure that the `vwProviders` view is consistently updated to prevent mismatches in provider information.\n- **Performance Optimization**: Evaluate the execution plan to identify potential bottlenecks, especially in the join operation. Consider materializing the view if performance is a concern and the data does not change frequently.\n- **Column Naming**: Ensure that column names are consistent and descriptive to improve readability and maintainability.\n- **Documentation**: Maintain thorough documentation of the view's purpose, logic, and dependencies to aid future maintenance and development efforts.",
      "complexity": "Medium",
      "model_used": "gpt-4o-2024-08-06",
      "tokens_used": 1436,
      "api_response_id": "chatcmpl-C8abFebJNJUsV78sqhzlLgeFVP5Bv"
    },
    "analysis_timestamp": "2025-08-25 19:09:22"
  },
  {
    "view_info": {
      "schema": "Billing",
      "name": "vwFiscalYears",
      "created": "2025-08-25 16:04:00.990000",
      "last_altered": "2025-08-25 16:04:00.990000",
      "check_option": "NO CHECK OPTION",
      "comment": "",
      "definition": "CREATE VIEW [Billing].[vwFiscalYears]\r\nAS\r\nSELECT FiscalYear,FiscalYearDescription,FiscalYearStart,FiscalYearEnd,Active\r\nFROM Billing.FiscalYear;\r\n",
      "is_replicated": false,
      "is_published": false
    },
    "columns": [
      {
        "name": "FiscalYear",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 1,
        "comment": ""
      },
      {
        "name": "FiscalYearDescription",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 100,
        "precision": null,
        "scale": null,
        "ordinal_position": 2,
        "comment": ""
      },
      {
        "name": "FiscalYearStart",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 8,
        "precision": null,
        "scale": null,
        "ordinal_position": 3,
        "comment": ""
      },
      {
        "name": "FiscalYearEnd",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 8,
        "precision": null,
        "scale": null,
        "ordinal_position": 4,
        "comment": ""
      },
      {
        "name": "Active",
        "data_type": "bit",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 5,
        "comment": ""
      }
    ],
    "dependencies": [
      {
        "referenced_schema": "Billing",
        "referenced_object": "FiscalYear",
        "referenced_type": "USER_TABLE"
      }
    ],
    "analysis": {
      "view_name": "vwFiscalYears",
      "explanation": "#### 1. Overview\nThe view `Billing.vwFiscalYears` is a database object in Microsoft SQL Server that provides a simplified and structured representation of fiscal year data from the `Billing.FiscalYear` table. It is designed to present key fiscal year attributes such as the year identifier, description, start and end dates, and an active status flag. This view acts as an abstraction layer, allowing users to query fiscal year information without directly accessing the underlying table.\n\n#### 2. Complexity Level: Low\nThe complexity level of this view is low. The view is a straightforward SELECT statement that retrieves all columns from a single table, `Billing.FiscalYear`, without any additional logic such as joins, aggregations, or subqueries. The absence of complex SQL logic or multiple dependencies contributes to its low complexity.\n\n#### 3. Data Model Analysis\n- **Underlying Table**: The view depends solely on the `Billing.FiscalYear` table. This table is expected to contain columns that match the view's output: `FiscalYear`, `FiscalYearDescription`, `FiscalYearStart`, `FiscalYearEnd`, and `Active`.\n- **Column Data Types**: The view maintains the data types from the underlying table, with `FiscalYear` and `FiscalYearStart`/`FiscalYearEnd` as `varchar`, and `Active` as a `bit`. This suggests that date values are stored as strings, which have implications for data integrity and operations involving date calculations.\n\n#### 4. Business Context and Use Cases\n- **Business Context**: The view is used in financial and accounting contexts where fiscal year information is critical for reporting, budgeting, and financial analysis. It provides a centralized way to access fiscal year data, which is essential for aligning financial activities with organizational timelines.\n- **Use Cases**: Common use cases include generating financial reports, validating transaction dates against fiscal periods, and enabling applications to display fiscal year information in user interfaces.\n\n#### 5. Performance Considerations\n- **Efficiency**: The view is efficient due to its simplicity, as it directly selects data from a single table without additional processing overhead.\n- **Indexing**: Performance can be further optimized by ensuring that the `Billing.FiscalYear` table is appropriately indexed, especially on columns frequently used in WHERE clauses or joins, such as `FiscalYear` or `Active`.\n- **Data Type Considerations**: Storing dates as `varchar` may impact performance when performing date-related operations, as conversions will be necessary.\n\n#### 6. Security and Access Control\n- **Access Control**: The view does not have a CHECK OPTION, meaning there are no restrictions on the data modifications through the view. However, since it is a read-only view (no DML operations defined), this is not a concern unless the view is modified to allow updates.\n- **Permissions**: Access to the view should be controlled through SQL Server's role-based security, granting permissions only to users or roles that require access to fiscal year data.\n\n#### 7. Potential Issues or Recommendations\n- **Data Integrity**: Consider changing the data types of `FiscalYearStart` and `FiscalYearEnd` to a date or datetime type to ensure data integrity and facilitate date operations.\n- **Documentation**: Ensure that the view is well-documented, including its purpose, usage guidelines, and any business rules it adheres to.\n- **Naming Conventions**: Verify that the naming conventions used in the view align with organizational standards for consistency and clarity.\n- **Future Modifications**: If the view is to be expanded with additional logic or dependencies, consider the impact on performance and complexity, and plan for appropriate testing and validation.",
      "complexity": "Low",
      "model_used": "gpt-4o-2024-08-06",
      "tokens_used": 1183,
      "api_response_id": "chatcmpl-C8abTjWq1mCi8eZfE7pxyIqTbl7yA"
    },
    "analysis_timestamp": "2025-08-25 19:09:36"
  },
  {
    "view_info": {
      "schema": "Billing",
      "name": "vwFiscalYearsByBillingGroupContracts",
      "created": "2025-08-25 16:04:00.993000",
      "last_altered": "2025-08-25 16:04:00.993000",
      "check_option": "NO CHECK OPTION",
      "comment": "",
      "definition": "CREATE VIEW [Billing].[vwFiscalYearsByBillingGroupContracts]\r\nAS\r\nSELECT FiscalYear,FiscalYearDescription,FiscalYearStart,FiscalYearEnd,Active\r\nFROM Billing.FiscalYear\r\nWHERE FiscalYear IN (SELECT DISTINCT FiscalYear FROM Billing.BillingGroupContract);\r\n",
      "is_replicated": false,
      "is_published": false
    },
    "columns": [
      {
        "name": "FiscalYear",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 1,
        "comment": ""
      },
      {
        "name": "FiscalYearDescription",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 100,
        "precision": null,
        "scale": null,
        "ordinal_position": 2,
        "comment": ""
      },
      {
        "name": "FiscalYearStart",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 8,
        "precision": null,
        "scale": null,
        "ordinal_position": 3,
        "comment": ""
      },
      {
        "name": "FiscalYearEnd",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 8,
        "precision": null,
        "scale": null,
        "ordinal_position": 4,
        "comment": ""
      },
      {
        "name": "Active",
        "data_type": "bit",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 5,
        "comment": ""
      }
    ],
    "dependencies": [
      {
        "referenced_schema": "Billing",
        "referenced_object": "BillingGroupContract",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Billing",
        "referenced_object": "FiscalYear",
        "referenced_type": "USER_TABLE"
      }
    ],
    "analysis": {
      "view_name": "vwFiscalYearsByBillingGroupContracts",
      "explanation": "#### 1. Overview\nThe view `Billing.vwFiscalYearsByBillingGroupContracts` is designed to provide a filtered list of fiscal years that are associated with billing group contracts. It selects fiscal year details from the `Billing.FiscalYear` table, but only includes those fiscal years that are referenced in the `Billing.BillingGroupContract` table. This view is useful for scenarios where only active fiscal years tied to existing contracts are relevant, ensuring that the data presented is both current and applicable to ongoing business operations.\n\n#### 2. Complexity Level: Low\nThe complexity of this view is low. It involves a straightforward selection of columns from a single table (`Billing.FiscalYear`) with a simple filtering condition based on a subquery that retrieves distinct fiscal years from another table (`Billing.BillingGroupContract`). There are no joins, aggregations, or complex calculations involved.\n\n#### 3. Data Model Analysis\n- **Billing.FiscalYear (USER_TABLE):** This table contains details about fiscal years, including their identifiers, descriptions, start and end dates, and an active status flag.\n- **Billing.BillingGroupContract (USER_TABLE):** This table store information about billing group contracts, including a reference to fiscal years. The presence of fiscal years in this table indicates active or relevant contracts for those periods.\n\nThe view effectively links these two tables by using a subquery to filter fiscal years that are actively referenced in contracts, ensuring that only pertinent fiscal year data is retrieved.\n\n#### 4. Business Context and Use Cases\nThis view is particularly useful for financial reporting and analysis within the context of billing operations. It can be used to:\n- Generate reports that focus on fiscal years with active billing contracts.\n- Support decision-making processes by providing a filtered view of fiscal periods relevant to current contracts.\n- Assist in auditing and compliance checks by ensuring that only fiscal years tied to contracts are considered.\n\n#### 5. Performance Considerations\n- **Efficiency:** The view uses a subquery to filter fiscal years, which is efficient given the simplicity of the query. The use of `SELECT DISTINCT` ensures that only unique fiscal years are considered, minimizing redundancy.\n- **Indexing:** Performance can be enhanced by ensuring that the `FiscalYear` column in both tables is indexed, which would speed up the subquery execution and the filtering process.\n- **Scalability:** As the data volume grows, the performance impact of the subquery should be monitored. If the `BillingGroupContract` table becomes large, consider optimizing the subquery or using indexed views if necessary.\n\n#### 6. Security and Access Control\n- **Access Control:** Ensure that only authorized users have access to this view, as it contain sensitive financial information. Implement role-based access controls to restrict view access to relevant personnel.\n- **Data Sensitivity:** Since the view exposes fiscal year data tied to contracts, consider encrypting sensitive columns if applicable, especially if the data includes financial or proprietary information.\n\n#### 7. Potential Issues or Recommendations\n- **Data Integrity:** Ensure that the `FiscalYear` column in both tables is consistently formatted and validated to prevent mismatches or errors in the subquery.\n- **NULL Handling:** The view does not explicitly handle NULL values in the `FiscalYearDescription` column. Consider adding logic to manage or replace NULLs if this column is critical for downstream processes.\n- **Documentation:** Maintain clear documentation for the view, including its purpose, dependencies, and any business rules applied. This will aid in maintenance and future enhancements.\n- **Optimization:** If performance becomes an issue, consider materializing the view or using indexed views to improve query response times, especially if the underlying tables are frequently queried together.\n\nBy addressing these considerations, the view can be maintained as an efficient and reliable component of the database architecture, supporting the organization's billing and financial operations effectively.",
      "complexity": "Low",
      "model_used": "gpt-4o-2024-08-06",
      "tokens_used": 1248,
      "api_response_id": "chatcmpl-C8abhkAroPzme7aiRiHJrDZG1FFqX"
    },
    "analysis_timestamp": "2025-08-25 19:09:51"
  },
  {
    "view_info": {
      "schema": "Billing",
      "name": "vwProviders",
      "created": "2025-08-25 16:04:00.870000",
      "last_altered": "2025-08-25 16:04:00.870000",
      "check_option": "NO CHECK OPTION",
      "comment": "",
      "definition": "CREATE VIEW [Billing].[vwProviders]\r\nAS\r\nSELECT P.ProviderID,P.ProviderName,P.ProviderDescription,P.FMSIdNumber,(SELECT COUNT(1) FROM Billing.EC3_Invoice_vwInvoiceAccountGroups WHERE ProviderID = P.ProviderID AND Active = 1) AS GroupCount,P.CreatedDate,P.CreatedBy,P.ModifiedDate,P.ModifiedBy,P.Active\r\nFROM Billing.EC3_Invoice_vwProviders AS P;\r\n",
      "is_replicated": false,
      "is_published": false
    },
    "columns": [
      {
        "name": "ProviderID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 1,
        "comment": ""
      },
      {
        "name": "ProviderName",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 2,
        "comment": ""
      },
      {
        "name": "ProviderDescription",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 75,
        "precision": null,
        "scale": null,
        "ordinal_position": 3,
        "comment": ""
      },
      {
        "name": "FMSIdNumber",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 11,
        "precision": null,
        "scale": null,
        "ordinal_position": 4,
        "comment": ""
      },
      {
        "name": "GroupCount",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 5,
        "comment": ""
      },
      {
        "name": "CreatedDate",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 6,
        "comment": ""
      },
      {
        "name": "CreatedBy",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 7,
        "comment": ""
      },
      {
        "name": "ModifiedDate",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 8,
        "comment": ""
      },
      {
        "name": "ModifiedBy",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 9,
        "comment": ""
      },
      {
        "name": "Active",
        "data_type": "bit",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 10,
        "comment": ""
      }
    ],
    "dependencies": [
      {
        "referenced_schema": "Billing",
        "referenced_object": "EC3_Invoice_vwInvoiceAccountGroups",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Billing",
        "referenced_object": "EC3_Invoice_vwProviders",
        "referenced_type": "USER_TABLE"
      }
    ],
    "analysis": {
      "view_name": "vwProviders",
      "explanation": "#### 1. Overview\nThe `Billing.vwProviders` view is designed to present a consolidated view of provider information within a billing system. It aggregates data from the `Billing.EC3_Invoice_vwProviders` table and includes a calculated field `GroupCount`, which counts the number of active invoice account groups associated with each provider. This view is used to facilitate reporting and analysis of provider-related data, offering insights into provider details and their associated active groups.\n\n#### 2. Complexity Level: Medium\n- **Structure**: The view is relatively straightforward, with a direct selection of columns from a single underlying table/view and a subquery for calculating `GroupCount`.\n- **Dependencies**: It depends on two underlying tables/views, which adds a layer of complexity due to the need to ensure data integrity and consistency across these objects.\n- **SQL Logic**: The use of a subquery to calculate `GroupCount` introduces moderate complexity, as it involves an additional query execution for each row in the main result set.\n\n#### 3. Data Model Analysis\n- **Underlying Tables/Views**:\n - `Billing.EC3_Invoice_vwProviders`: This is the primary source of provider data, containing fields such as `ProviderID`, `ProviderName`, and others.\n - `Billing.EC3_Invoice_vwInvoiceAccountGroups`: This table/view is used in the subquery to calculate the `GroupCount`, filtering by `ProviderID` and `Active` status.\n- **Data Relationships**: The view assumes a one-to-many relationship between providers and invoice account groups, where each provider can have multiple associated groups.\n\n#### 4. Business Context and Use Cases\n- **Business Context**: This view is used in the context of billing and invoicing systems where understanding provider details and their active group associations is crucial.\n- **Use Cases**:\n - Generating reports that list providers along with their active group counts.\n - Supporting dashboards that display provider activity and engagement metrics.\n - Facilitating audits and compliance checks by providing a snapshot of provider data and their active associations.\n\n#### 5. Performance Considerations\n- **Subquery Execution**: The subquery used to calculate `GroupCount` can impact performance, especially if the `Billing.EC3_Invoice_vwInvoiceAccountGroups` table/view is large or lacks proper indexing on `ProviderID` and `Active`.\n- **Indexing**: Ensuring that both `ProviderID` and `Active` columns are indexed in the `Billing.EC3_Invoice_vwInvoiceAccountGroups` table/view can significantly improve performance.\n- **Scalability**: As the number of providers and associated groups grows, the performance impact of the subquery may become more pronounced, necessitating optimization strategies.\n\n#### 6. Security and Access Control\n- **View Security**: Access to the view should be controlled to ensure that only authorized users can view provider data. This can be managed through SQL Server's role-based security.\n- **Underlying Data Security**: Security policies should also be applied to the underlying tables/views to prevent unauthorized access to sensitive data.\n- **Data Sensitivity**: Consideration should be given to the sensitivity of the data, such as `FMSIdNumber`, which require additional protection measures.\n\n#### 7. Potential Issues or Recommendations\n- **Subquery Optimization**: Consider using a join with a GROUP BY clause instead of a subquery to calculate `GroupCount`, which can improve performance by reducing the number of query executions.\n- **Indexing**: Ensure that appropriate indexes are in place on the `Billing.EC3_Invoice_vwInvoiceAccountGroups` table/view to support efficient filtering and counting operations.\n- **Data Validation**: Implement data validation checks to ensure that the `ProviderID` and `Active` fields contain valid and consistent data across the related tables/views.\n- **View Maintenance**: Regularly review and update the view definition to accommodate changes in business requirements or underlying data structures.",
      "complexity": "Medium",
      "model_used": "gpt-4o-2024-08-06",
      "tokens_used": 1374,
      "api_response_id": "chatcmpl-C8abxbphgKaIT6W5VIXEgygrPDtBI"
    },
    "analysis_timestamp": "2025-08-25 19:10:04"
  },
  {
    "view_info": {
      "schema": "Common",
      "name": "vwNotes",
      "created": "2025-08-25 16:04:01",
      "last_altered": "2025-08-25 16:04:01",
      "check_option": "NO CHECK OPTION",
      "comment": "",
      "definition": "CREATE VIEW [Common].[vwNotes]\r\nAS\r\nSELECT NoteID,ParentType,ParentID,[Action],Note,CreatedDate,CreatedBy\r\nFROM Common.Note;\r\n",
      "is_replicated": false,
      "is_published": false
    },
    "columns": [
      {
        "name": "NoteID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 1,
        "comment": ""
      },
      {
        "name": "ParentType",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 25,
        "precision": null,
        "scale": null,
        "ordinal_position": 2,
        "comment": ""
      },
      {
        "name": "ParentID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 3,
        "comment": ""
      },
      {
        "name": "Action",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 25,
        "precision": null,
        "scale": null,
        "ordinal_position": 4,
        "comment": ""
      },
      {
        "name": "Note",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 500,
        "precision": null,
        "scale": null,
        "ordinal_position": 5,
        "comment": ""
      },
      {
        "name": "CreatedDate",
        "data_type": "datetime",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 6,
        "comment": ""
      },
      {
        "name": "CreatedBy",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 7,
        "comment": ""
      }
    ],
    "dependencies": [
      {
        "referenced_schema": "Common",
        "referenced_object": "Note",
        "referenced_type": "USER_TABLE"
      }
    ],
    "analysis": {
      "view_name": "vwNotes",
      "explanation": "#### 1. Overview\nThe view `Common.vwNotes` is a SQL Server database view that provides a structured representation of notes stored in the `Common.Note` table. It selects all columns from the `Common.Note` table, effectively acting as a direct pass-through or alias for the table itself. The view does not include any additional logic, transformations, or filtering, and it does not enforce any constraints through a check option.\n\n#### 2. Complexity Level: Low\nThe complexity level of this view is low. It is a straightforward selection of columns from a single table without any joins, aggregations, or complex SQL logic. The absence of additional logic or transformations makes it simple to understand and maintain.\n\n#### 3. Data Model Analysis\n- **Underlying Table**: The view depends solely on the `Common.Note` table. This table contains columns such as `NoteID`, `ParentType`, `ParentID`, `Action`, `Note`, `CreatedDate`, and `CreatedBy`.\n- **Column Analysis**: Each column in the view directly maps to a column in the `Common.Note` table. The data types and constraints (e.g., `NOT NULL`) are inherited from the table definition.\n- **Dependencies**: There are no additional dependencies beyond the `Common.Note` table, simplifying the data model.\n\n#### 4. Business Context and Use Cases\n- **Purpose**: The view serves as a convenient way to access the `Common.Note` table, for reporting or application development purposes where a consistent interface is needed.\n- **Use Cases**: \n - Providing a stable interface for applications to query notes without directly accessing the underlying table.\n - Facilitating easier refactoring or changes to the underlying table structure without impacting dependent applications or queries.\n - Serving as a base for more complex views or queries that join this view with other data sources.\n\n#### 5. Performance Considerations\n- **Efficiency**: Since the view is a direct pass-through to the `Common.Note` table, it should have minimal performance overhead compared to querying the table directly.\n- **Indexing**: Performance will largely depend on the indexing strategy of the `Common.Note` table. Ensuring appropriate indexes on columns frequently used in WHERE clauses or joins can enhance performance.\n- **Scalability**: As the view does not introduce additional complexity, it should scale well with the underlying table, assuming the table itself is well-optimized.\n\n#### 6. Security and Access Control\n- **Access Control**: The view does not inherently provide any additional security features. Access control should be managed through SQL Server's role-based security, granting or restricting access to the view as needed.\n- **Data Sensitivity**: If the `Common.Note` table contains sensitive information, ensure that access to the view is restricted to authorized users only.\n\n#### 7. Potential Issues or Recommendations\n- **Redundancy**: Since the view is a direct pass-through, it be redundant unless it serves a specific purpose such as abstraction or interface stability.\n- **Documentation**: Ensure that the purpose and intended use of the view are well-documented to avoid confusion about its necessity.\n- **Future Enhancements**: Consider adding logic to the view if there are common filtering or transformation requirements that can be centralized in the view.\n- **Check Option**: Although not necessary for this view, consider using the `WITH CHECK OPTION` if future modifications introduce filtering logic that should be enforced on updates through the view.",
      "complexity": "Low",
      "model_used": "gpt-4o-2024-08-06",
      "tokens_used": 1156,
      "api_response_id": "chatcmpl-C8acOKOpzH3YJUif3nhgse2jpdUe9"
    },
    "analysis_timestamp": "2025-08-25 19:10:29"
  },
  {
    "view_info": {
      "schema": "fms",
      "name": "vwDisbursementAccounting",
      "created": "2025-08-25 16:04:00.793000",
      "last_altered": "2025-08-25 16:04:00.793000",
      "check_option": "NO CHECK OPTION",
      "comment": "",
      "definition": "CREATE VIEW [fms].[vwDisbursementAccounting]\r\nAS\r\nSELECT ([DOC_CD] + ' ' + [DOC_DEPT_CD] + ' ' + [DOC_ID] + ' ' + CONVERT(VARCHAR(20), [DOC_VERS_NO])) AS DisbursementID,([DOC_CD] + ' ' + [DOC_DEPT_CD] + ' ' + [DOC_ID]) AS DisbursementNumber,[DOC_VERS_NO] AS DisbursementVersionNumber,[DOC_CD],[DOC_DEPT_CD],[DOC_ID],[DOC_VERS_NO],[DOC_VEND_LN_NO],[DOC_ACTG_LN_NO],[DEPT_CD],[CHK_DSCR],[ACTG_LN_DSCR],[VEND_INV_NO],[VEND_INV_DT],[VEND_INV_LN_NO],[TRKG_DT],[BFY],[FY_DC],[PER_DC],[INTR_INELIG_FL],[INTR_CALC_BYP_FL],[SVC_FRM_DT],[SVC_TO_DT],[REPL_FL],[RFED_DOC_CD],[RFED_DOC_DEPT_CD],[RFED_DOC_ID],[RFED_DOC_VERS_NO],([RFED_DOC_CD] + ' ' + [RFED_DOC_DEPT_CD] + ' ' + [RFED_DOC_ID]) AS RFEDNumber,[RFED_DOC_VERS_NO] AS RFEDVersionNumber,[RFED_VEND_LN_NO],[RFED_COMM_LN_NO],[RFED_ACTG_LN_NO],[RF_TYP],[RQPORF_DOC_CD],[RQPORF_DOC_DEPT],[RQPORF_DOC_ID],([RQPORF_DOC_CD] + ' ' + [RQPORF_DOC_DEPT] + ' ' + [RQPORF_DOC_ID]) AS ContractNumber,[RQPORF_VEND_LN_NO],[RQPORF_COMM_LN_NO],[RQPORF_ACTG_LN_NO],[LN_AM],[DISC_LN_AM],[PNLTY_LN_AM],[INTR_LN_AM],[BKUP_WHLD_LN_AM],[INCT_LN_AM],[DFLT_INT_FEE_AM],[SUPP_INT_FEE_AM],[RTG_LN_AM],[FRGHT_AM],[USETAX_AM],[TAX_AM],[PRCU_ID],[PRCU_TYP_ID],[PRCU_TYP_NM],[ImportDate]\r\nFROM fms.DisbursementAccounting;\r\n",
      "is_replicated": false,
      "is_published": false
    },
    "columns": [
      {
        "name": "DisbursementID",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 55,
        "precision": null,
        "scale": null,
        "ordinal_position": 1,
        "comment": ""
      },
      {
        "name": "DisbursementNumber",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 34,
        "precision": null,
        "scale": null,
        "ordinal_position": 2,
        "comment": ""
      },
      {
        "name": "DisbursementVersionNumber",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 3,
        "comment": ""
      },
      {
        "name": "DOC_CD",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 8,
        "precision": null,
        "scale": null,
        "ordinal_position": 4,
        "comment": ""
      },
      {
        "name": "DOC_DEPT_CD",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 5,
        "comment": ""
      },
      {
        "name": "DOC_ID",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 6,
        "comment": ""
      },
      {
        "name": "DOC_VERS_NO",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 7,
        "comment": ""
      },
      {
        "name": "DOC_VEND_LN_NO",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 8,
        "comment": ""
      },
      {
        "name": "DOC_ACTG_LN_NO",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 9,
        "comment": ""
      },
      {
        "name": "DEPT_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 10,
        "comment": ""
      },
      {
        "name": "CHK_DSCR",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 250,
        "precision": null,
        "scale": null,
        "ordinal_position": 11,
        "comment": ""
      },
      {
        "name": "ACTG_LN_DSCR",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 100,
        "precision": null,
        "scale": null,
        "ordinal_position": 12,
        "comment": ""
      },
      {
        "name": "VEND_INV_NO",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 30,
        "precision": null,
        "scale": null,
        "ordinal_position": 13,
        "comment": ""
      },
      {
        "name": "VEND_INV_DT",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 14,
        "comment": ""
      },
      {
        "name": "VEND_INV_LN_NO",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 15,
        "comment": ""
      },
      {
        "name": "TRKG_DT",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 16,
        "comment": ""
      },
      {
        "name": "BFY",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 17,
        "comment": ""
      },
      {
        "name": "FY_DC",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 18,
        "comment": ""
      },
      {
        "name": "PER_DC",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 19,
        "comment": ""
      },
      {
        "name": "INTR_INELIG_FL",
        "data_type": "bit",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 20,
        "comment": ""
      },
      {
        "name": "INTR_CALC_BYP_FL",
        "data_type": "bit",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 21,
        "comment": ""
      },
      {
        "name": "SVC_FRM_DT",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 22,
        "comment": ""
      },
      {
        "name": "SVC_TO_DT",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 23,
        "comment": ""
      },
      {
        "name": "REPL_FL",
        "data_type": "bit",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 24,
        "comment": ""
      },
      {
        "name": "RFED_DOC_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 8,
        "precision": null,
        "scale": null,
        "ordinal_position": 25,
        "comment": ""
      },
      {
        "name": "RFED_DOC_DEPT_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 26,
        "comment": ""
      },
      {
        "name": "RFED_DOC_ID",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 27,
        "comment": ""
      },
      {
        "name": "RFED_DOC_VERS_NO",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 28,
        "comment": ""
      },
      {
        "name": "RFEDNumber",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 34,
        "precision": null,
        "scale": null,
        "ordinal_position": 29,
        "comment": ""
      },
      {
        "name": "RFEDVersionNumber",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 30,
        "comment": ""
      },
      {
        "name": "RFED_VEND_LN_NO",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 31,
        "comment": ""
      },
      {
        "name": "RFED_COMM_LN_NO",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 32,
        "comment": ""
      },
      {
        "name": "RFED_ACTG_LN_NO",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 33,
        "comment": ""
      },
      {
        "name": "RF_TYP",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 3,
        "precision": null,
        "scale": null,
        "ordinal_position": 34,
        "comment": ""
      },
      {
        "name": "RQPORF_DOC_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 8,
        "precision": null,
        "scale": null,
        "ordinal_position": 35,
        "comment": ""
      },
      {
        "name": "RQPORF_DOC_DEPT",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 36,
        "comment": ""
      },
      {
        "name": "RQPORF_DOC_ID",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 37,
        "comment": ""
      },
      {
        "name": "ContractNumber",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 34,
        "precision": null,
        "scale": null,
        "ordinal_position": 38,
        "comment": ""
      },
      {
        "name": "RQPORF_VEND_LN_NO",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 39,
        "comment": ""
      },
      {
        "name": "RQPORF_COMM_LN_NO",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 40,
        "comment": ""
      },
      {
        "name": "RQPORF_ACTG_LN_NO",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 41,
        "comment": ""
      },
      {
        "name": "LN_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 22,
        "scale": 2,
        "ordinal_position": 42,
        "comment": ""
      },
      {
        "name": "DISC_LN_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 22,
        "scale": 2,
        "ordinal_position": 43,
        "comment": ""
      },
      {
        "name": "PNLTY_LN_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 22,
        "scale": 2,
        "ordinal_position": 44,
        "comment": ""
      },
      {
        "name": "INTR_LN_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 22,
        "scale": 2,
        "ordinal_position": 45,
        "comment": ""
      },
      {
        "name": "BKUP_WHLD_LN_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 22,
        "scale": 2,
        "ordinal_position": 46,
        "comment": ""
      },
      {
        "name": "INCT_LN_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 22,
        "scale": 2,
        "ordinal_position": 47,
        "comment": ""
      },
      {
        "name": "DFLT_INT_FEE_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 22,
        "scale": 2,
        "ordinal_position": 48,
        "comment": ""
      },
      {
        "name": "SUPP_INT_FEE_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 22,
        "scale": 2,
        "ordinal_position": 49,
        "comment": ""
      },
      {
        "name": "RTG_LN_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 22,
        "scale": 2,
        "ordinal_position": 50,
        "comment": ""
      },
      {
        "name": "FRGHT_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 22,
        "scale": 2,
        "ordinal_position": 51,
        "comment": ""
      },
      {
        "name": "USETAX_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 22,
        "scale": 2,
        "ordinal_position": 52,
        "comment": ""
      },
      {
        "name": "TAX_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 22,
        "scale": 2,
        "ordinal_position": 53,
        "comment": ""
      },
      {
        "name": "PRCU_ID",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 54,
        "comment": ""
      },
      {
        "name": "PRCU_TYP_ID",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 10,
        "precision": null,
        "scale": null,
        "ordinal_position": 55,
        "comment": ""
      },
      {
        "name": "PRCU_TYP_NM",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 30,
        "precision": null,
        "scale": null,
        "ordinal_position": 56,
        "comment": ""
      },
      {
        "name": "ImportDate",
        "data_type": "datetime",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 57,
        "comment": ""
      }
    ],
    "dependencies": [
      {
        "referenced_schema": "fms",
        "referenced_object": "DisbursementAccounting",
        "referenced_type": "USER_TABLE"
      }
    ],
    "analysis": {
      "view_name": "vwDisbursementAccounting",
      "explanation": "#### 1. Overview\nThe view `fms.vwDisbursementAccounting` is designed to provide a structured representation of disbursement accounting data. It aggregates and formats data from the `fms.DisbursementAccounting` table, creating composite keys and identifiers such as `DisbursementID`, `DisbursementNumber`, `RFEDNumber`, and `ContractNumber` by concatenating various document-related fields. This view is used to facilitate reporting and analysis by providing a more human-readable format of the underlying data, which is essential for financial and accounting operations.\n\n#### 2. Complexity Level: Medium\nThe complexity of this view is considered medium due to the following factors:\n- **Structure**: The view involves simple concatenation operations to create composite identifiers, which are straightforward but require careful handling of string operations.\n- **Dependencies**: It depends on a single table, `fms.DisbursementAccounting`, which simplifies its dependency graph.\n- **SQL Logic**: The SQL logic is relatively simple, involving basic SELECT statements and string concatenations without any complex joins or subqueries.\n\n#### 3. Data Model Analysis\n- **Underlying Table**: The view is based on the `fms.DisbursementAccounting` table. This table contains detailed records of disbursement transactions, including document codes, department codes, vendor line numbers, accounting line numbers, and various financial amounts.\n- **Columns**: The view selects a wide range of columns, indicating that the underlying table is comprehensive in capturing disbursement-related data. The inclusion of financial amounts and document identifiers suggests a focus on transaction tracking and financial reporting.\n\n#### 4. Business Context and Use Cases\n- **Financial Reporting**: The view is used in financial reporting to provide a consolidated view of disbursement transactions. The formatted identifiers make it easier to reference and analyze specific transactions.\n- **Audit and Compliance**: By providing detailed transaction data, the view supports audit and compliance activities, ensuring that all disbursement transactions are properly documented and traceable.\n- **Operational Analysis**: The view can be used by financial analysts to monitor disbursement trends, identify discrepancies, and support decision-making processes.\n\n#### 5. Performance Considerations\n- **Efficiency**: The view is efficient in terms of performance since it relies on a single table without any joins or complex calculations. However, the performance can be impacted by the size of the `fms.DisbursementAccounting` table.\n- **Indexing**: To optimize performance, especially for large datasets, indexing on frequently queried columns such as `DOC_CD`, `DOC_DEPT_CD`, and `DOC_ID` could be beneficial.\n- **String Operations**: The concatenation operations are relatively lightweight but could become a performance bottleneck if the view is queried extensively or if the underlying table is very large.\n\n#### 6. Security and Access Control\n- **Access Control**: Access to the view should be restricted to authorized users, particularly those involved in financial operations and reporting. This ensures that sensitive financial data is protected.\n- **Data Sensitivity**: Given the financial nature of the data, it is crucial to implement role-based access control and ensure that users have the appropriate permissions to view or manipulate the data.\n\n#### 7. Potential Issues or Recommendations\n- **Data Integrity**: Ensure that the concatenated fields used to create composite identifiers do not contain null values, as this leads to incomplete or misleading identifiers.\n- **Documentation**: Provide clear documentation for the view, explaining the purpose of each column and the logic behind the concatenated identifiers. This will aid in maintenance and usage by other developers or analysts.\n- **Performance Monitoring**: Regularly monitor the performance of the view, especially if the underlying table grows significantly. Consider optimizing the underlying table structure or indexing strategy if performance issues arise.\n- **Error Handling**: Implement error handling or validation checks to ensure that the concatenated strings do not exceed the maximum length of the varchar fields, which leads to data truncation.",
      "complexity": "Medium",
      "model_used": "gpt-4o-2024-08-06",
      "tokens_used": 2503,
      "api_response_id": "chatcmpl-C8acYyT8D5yeyXydVqxDnP5jORNCS"
    },
    "analysis_timestamp": "2025-08-25 19:10:45"
  },
  {
    "view_info": {
      "schema": "fms",
      "name": "vwDisbursementHeader",
      "created": "2025-08-25 16:04:00.803000",
      "last_altered": "2025-08-25 16:04:00.803000",
      "check_option": "NO CHECK OPTION",
      "comment": "",
      "definition": "CREATE VIEW [fms].[vwDisbursementHeader]\r\nAS\r\nSELECT ([DOC_CD] + ' ' + [DOC_DEPT_CD] + ' ' + [DOC_ID] + ' ' + CONVERT(VARCHAR(20), [DOC_VERS_NO])) AS DisbursementID,([DOC_CD] + ' ' + [DOC_DEPT_CD] + ' ' + [DOC_ID]) AS DisbursementNumber,[DOC_VERS_NO] AS DisbursementVersionNumber,CASE WHEN DOC_CD = 'AD' THEN 'CHK'\r\n WHEN DOC_CD = 'EFT' THEN 'EFT'\r\n WHEN DOC_CD = 'MD1' THEN 'MAN'\r\n ELSE 'N/A' END AS PaymentType,[DOC_CD],[DOC_DEPT_CD],[DOC_ID],[DOC_VERS_NO],[DOC_NM],[DOC_REC_DT_DC],[DOC_BFY],[DOC_FY_DC],[DOC_PER_DC],[BANK_ACCT_CD],[CHK_EFT_NO],[CHK_EFT_AM],[CHK_EFT_ISS_DT],[CHK_EFT_REC_DT],[DISB_CAT],[CHK_EFT_STA],[IFACE_DISB_ID],[IFACE_DISB_NM],[IFACE_DISB_ROLE],[PYEE_VEND_CD],[PYEE_LGL_NM],[PYEE_ALIAS_NM],[PYEE_AD_ID],[PYEE_AD_LN_1],[PYEE_AD_LN_2],[PYEE_CITY],[PYEE_ST],[PYEE_ZIP],[PYEE_CNTAC_ID],[PYEE_CNTAC_NM],[PYEE_PH_NO],[PYEE_PH_EXT],[PYEE_FAX_PH_NO],[PYEE_FAX_PH_EXT],[PYEE_EMAIL_AD],[DOC_APPL_LAST_DT],[CAN_TYP_CD],[CAN_REAS_CD_DC],[CAN_CMNT_DC],[SCHED_PYMT_DT_DC],[CLR_DT],[LN_AM],[DISC_AM],[PNLTY_AM],[INTR_AM],[BKUP_WHLD_AM],[INCT_AM],[TOT_DFLT_INT_FEE],[TOT_SUPP_INT_FEE],[RTG_AM],[FRGHT_AM],[USETAX_AM],[TAX_AM],[DOC_FUNC_CD],[HLD_TYP_DC],[HLD_RQST_DSCR_DC],[ImportDate]\r\nFROM fms.DisbursementHeader;\r\n",
      "is_replicated": false,
      "is_published": false
    },
    "columns": [
      {
        "name": "DisbursementID",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 55,
        "precision": null,
        "scale": null,
        "ordinal_position": 1,
        "comment": ""
      },
      {
        "name": "DisbursementNumber",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 34,
        "precision": null,
        "scale": null,
        "ordinal_position": 2,
        "comment": ""
      },
      {
        "name": "DisbursementVersionNumber",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 3,
        "comment": ""
      },
      {
        "name": "PaymentType",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 3,
        "precision": null,
        "scale": null,
        "ordinal_position": 4,
        "comment": ""
      },
      {
        "name": "DOC_CD",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 8,
        "precision": null,
        "scale": null,
        "ordinal_position": 5,
        "comment": ""
      },
      {
        "name": "DOC_DEPT_CD",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 6,
        "comment": ""
      },
      {
        "name": "DOC_ID",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 7,
        "comment": ""
      },
      {
        "name": "DOC_VERS_NO",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 8,
        "comment": ""
      },
      {
        "name": "DOC_NM",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 60,
        "precision": null,
        "scale": null,
        "ordinal_position": 9,
        "comment": ""
      },
      {
        "name": "DOC_REC_DT_DC",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 10,
        "comment": ""
      },
      {
        "name": "DOC_BFY",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 11,
        "comment": ""
      },
      {
        "name": "DOC_FY_DC",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 12,
        "comment": ""
      },
      {
        "name": "DOC_PER_DC",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 13,
        "comment": ""
      },
      {
        "name": "BANK_ACCT_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 14,
        "comment": ""
      },
      {
        "name": "CHK_EFT_NO",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 15,
        "precision": null,
        "scale": null,
        "ordinal_position": 15,
        "comment": ""
      },
      {
        "name": "CHK_EFT_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 22,
        "scale": 2,
        "ordinal_position": 16,
        "comment": ""
      },
      {
        "name": "CHK_EFT_ISS_DT",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 17,
        "comment": ""
      },
      {
        "name": "CHK_EFT_REC_DT",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 18,
        "comment": ""
      },
      {
        "name": "DISB_CAT",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 19,
        "comment": ""
      },
      {
        "name": "CHK_EFT_STA",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 3,
        "precision": null,
        "scale": null,
        "ordinal_position": 20,
        "comment": ""
      },
      {
        "name": "IFACE_DISB_ID",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 21,
        "comment": ""
      },
      {
        "name": "IFACE_DISB_NM",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 60,
        "precision": null,
        "scale": null,
        "ordinal_position": 22,
        "comment": ""
      },
      {
        "name": "IFACE_DISB_ROLE",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 10,
        "precision": null,
        "scale": null,
        "ordinal_position": 23,
        "comment": ""
      },
      {
        "name": "PYEE_VEND_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 24,
        "comment": ""
      },
      {
        "name": "PYEE_LGL_NM",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 60,
        "precision": null,
        "scale": null,
        "ordinal_position": 25,
        "comment": ""
      },
      {
        "name": "PYEE_ALIAS_NM",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 60,
        "precision": null,
        "scale": null,
        "ordinal_position": 26,
        "comment": ""
      },
      {
        "name": "PYEE_AD_ID",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 27,
        "comment": ""
      },
      {
        "name": "PYEE_AD_LN_1",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 75,
        "precision": null,
        "scale": null,
        "ordinal_position": 28,
        "comment": ""
      },
      {
        "name": "PYEE_AD_LN_2",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 75,
        "precision": null,
        "scale": null,
        "ordinal_position": 29,
        "comment": ""
      },
      {
        "name": "PYEE_CITY",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 60,
        "precision": null,
        "scale": null,
        "ordinal_position": 30,
        "comment": ""
      },
      {
        "name": "PYEE_ST",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 2,
        "precision": null,
        "scale": null,
        "ordinal_position": 31,
        "comment": ""
      },
      {
        "name": "PYEE_ZIP",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 10,
        "precision": null,
        "scale": null,
        "ordinal_position": 32,
        "comment": ""
      },
      {
        "name": "PYEE_CNTAC_ID",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 33,
        "comment": ""
      },
      {
        "name": "PYEE_CNTAC_NM",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 60,
        "precision": null,
        "scale": null,
        "ordinal_position": 34,
        "comment": ""
      },
      {
        "name": "PYEE_PH_NO",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 30,
        "precision": null,
        "scale": null,
        "ordinal_position": 35,
        "comment": ""
      },
      {
        "name": "PYEE_PH_EXT",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 6,
        "precision": null,
        "scale": null,
        "ordinal_position": 36,
        "comment": ""
      },
      {
        "name": "PYEE_FAX_PH_NO",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 30,
        "precision": null,
        "scale": null,
        "ordinal_position": 37,
        "comment": ""
      },
      {
        "name": "PYEE_FAX_PH_EXT",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 6,
        "precision": null,
        "scale": null,
        "ordinal_position": 38,
        "comment": ""
      },
      {
        "name": "PYEE_EMAIL_AD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 100,
        "precision": null,
        "scale": null,
        "ordinal_position": 39,
        "comment": ""
      },
      {
        "name": "DOC_APPL_LAST_DT",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 40,
        "comment": ""
      },
      {
        "name": "CAN_TYP_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 3,
        "precision": null,
        "scale": null,
        "ordinal_position": 41,
        "comment": ""
      },
      {
        "name": "CAN_REAS_CD_DC",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 3,
        "precision": null,
        "scale": null,
        "ordinal_position": 42,
        "comment": ""
      },
      {
        "name": "CAN_CMNT_DC",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 100,
        "precision": null,
        "scale": null,
        "ordinal_position": 43,
        "comment": ""
      },
      {
        "name": "SCHED_PYMT_DT_DC",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 44,
        "comment": ""
      },
      {
        "name": "CLR_DT",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 45,
        "comment": ""
      },
      {
        "name": "LN_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 22,
        "scale": 2,
        "ordinal_position": 46,
        "comment": ""
      },
      {
        "name": "DISC_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 22,
        "scale": 2,
        "ordinal_position": 47,
        "comment": ""
      },
      {
        "name": "PNLTY_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 22,
        "scale": 2,
        "ordinal_position": 48,
        "comment": ""
      },
      {
        "name": "INTR_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 22,
        "scale": 2,
        "ordinal_position": 49,
        "comment": ""
      },
      {
        "name": "BKUP_WHLD_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 22,
        "scale": 2,
        "ordinal_position": 50,
        "comment": ""
      },
      {
        "name": "INCT_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 22,
        "scale": 2,
        "ordinal_position": 51,
        "comment": ""
      },
      {
        "name": "TOT_DFLT_INT_FEE",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 22,
        "scale": 2,
        "ordinal_position": 52,
        "comment": ""
      },
      {
        "name": "TOT_SUPP_INT_FEE",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 22,
        "scale": 2,
        "ordinal_position": 53,
        "comment": ""
      },
      {
        "name": "RTG_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 22,
        "scale": 2,
        "ordinal_position": 54,
        "comment": ""
      },
      {
        "name": "FRGHT_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 22,
        "scale": 2,
        "ordinal_position": 55,
        "comment": ""
      },
      {
        "name": "USETAX_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 22,
        "scale": 2,
        "ordinal_position": 56,
        "comment": ""
      },
      {
        "name": "TAX_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 22,
        "scale": 2,
        "ordinal_position": 57,
        "comment": ""
      },
      {
        "name": "DOC_FUNC_CD",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 58,
        "comment": ""
      },
      {
        "name": "HLD_TYP_DC",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 6,
        "precision": null,
        "scale": null,
        "ordinal_position": 59,
        "comment": ""
      },
      {
        "name": "HLD_RQST_DSCR_DC",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 120,
        "precision": null,
        "scale": null,
        "ordinal_position": 60,
        "comment": ""
      },
      {
        "name": "ImportDate",
        "data_type": "datetime",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 61,
        "comment": ""
      }
    ],
    "dependencies": [
      {
        "referenced_schema": "fms",
        "referenced_object": "DisbursementHeader",
        "referenced_type": "USER_TABLE"
      }
    ],
    "analysis": {
      "view_name": "vwDisbursementHeader",
      "explanation": "#### 1. Overview\nThe view `fms.vwDisbursementHeader` is designed to provide a consolidated representation of disbursement-related data from the `fms.DisbursementHeader` table. It constructs a unique `DisbursementID` and `DisbursementNumber` by concatenating document-related fields and assigns a `PaymentType` based on the `DOC_CD` field. The view includes a wide array of columns that cover document details, payment information, payee details, and financial amounts, making it a comprehensive source for disbursement data.\n\n#### 2. Complexity Level: Medium\n- **Structure**: The view is straightforward in terms of SQL logic, primarily involving column selection and simple string concatenation.\n- **Dependencies**: It depends on a single table, `fms.DisbursementHeader`, which simplifies its dependency structure.\n- **SQL Logic**: The use of CASE statements for `PaymentType` and string concatenation for `DisbursementID` and `DisbursementNumber` adds a moderate level of complexity.\n\n#### 3. Data Model Analysis\n- **Underlying Table**: The view relies solely on the `fms.DisbursementHeader` table. This table is expected to contain detailed records of disbursements, including document codes, department codes, and various financial and payee-related fields.\n- **Columns**: The view includes a mix of varchar, int, decimal, and datetime data types, reflecting a diverse set of data points related to disbursements.\n- **Key Columns**: `DisbursementID` and `DisbursementNumber` are derived columns that serve as identifiers, while `PaymentType` categorizes the disbursement method.\n\n#### 4. Business Context and Use Cases\n- **Purpose**: The view is used to facilitate reporting and analysis of disbursement activities, providing a unified view of key disbursement attributes.\n- **Use Cases**: \n - Generating reports for financial audits or compliance checks.\n - Supporting financial reconciliation processes by providing detailed disbursement data.\n - Enabling business intelligence tools to visualize disbursement trends and patterns.\n\n#### 5. Performance Considerations\n- **Efficiency**: The view's performance is generally efficient due to its reliance on a single table and absence of complex joins or subqueries.\n- **Indexing**: Performance can be enhanced by ensuring that the underlying table has appropriate indexes, especially on columns used in concatenations and conditions, such as `DOC_CD`, `DOC_DEPT_CD`, and `DOC_ID`.\n- **Scalability**: As the view grows with more data, performance should be monitored, particularly if used in high-frequency reporting or large-scale data extraction.\n\n#### 6. Security and Access Control\n- **Access Control**: Ensure that access to the view is restricted to authorized users, particularly because it contains sensitive financial and payee information.\n- **Data Sensitivity**: Columns like `PYEE_LGL_NM`, `PYEE_AD_ID`, and financial amounts should be protected to prevent unauthorized access or data breaches.\n- **Role-Based Access**: Implement role-based access controls to ensure that users only have access to data necessary for their roles.\n\n#### 7. Potential Issues or Recommendations\n- **Data Integrity**: Ensure that the underlying table maintains data integrity, especially for concatenated fields that form `DisbursementID` and `DisbursementNumber`.\n- **Null Handling**: Consider handling potential null values in concatenated fields to avoid unexpected results in `DisbursementID` and `DisbursementNumber`.\n- **Documentation**: Maintain comprehensive documentation for the view, detailing its purpose, structure, and any business rules applied, such as the logic for `PaymentType`.\n- **Optimization**: Regularly review and optimize the view as business requirements evolve, ensuring it continues to meet performance and data accuracy needs.",
      "complexity": "Medium",
      "model_used": "gpt-4o-2024-08-06",
      "tokens_used": 2536,
      "api_response_id": "chatcmpl-C8acolhieAtcogvVs7T5osEZCpAaP"
    },
    "analysis_timestamp": "2025-08-25 19:10:56"
  },
  {
    "view_info": {
      "schema": "fms",
      "name": "vwDisbursementVendor",
      "created": "2025-08-25 16:04:00.810000",
      "last_altered": "2025-08-25 16:04:00.810000",
      "check_option": "NO CHECK OPTION",
      "comment": "",
      "definition": "CREATE VIEW [fms].[vwDisbursementVendor]\r\nAS\r\nSELECT ([DOC_CD] + ' ' + [DOC_DEPT_CD] + ' ' + [DOC_ID] + ' ' + CONVERT(VARCHAR(20), [DOC_VERS_NO])) AS DisbursementID,([DOC_CD] + ' ' + [DOC_DEPT_CD] + ' ' + [DOC_ID]) AS DisbursementNumber,[DOC_VERS_NO] AS DisbursementVersionNumber,[DOC_CD],[DOC_DEPT_CD],[DOC_ID],[DOC_VERS_NO],[DOC_VEND_LN_NO],[VEND_CUST_CD],[LGL_NM],[ALIAS_NM],[AD_ID],[AD_LN_1],[AD_LN_2],[CITY],[ST],[ZIP],[CTRY],[CNTAC_ID],[PRIN_CNTAC],[VOICE_PH_NO],[VOICE_PH_EXT],[EMAIL_AD],[FAX_PH_NO],[FAX_PH_EXT],[WEB_AD],[ImportDate]\r\nFROM fms.DisbursementVendor;\r\n",
      "is_replicated": false,
      "is_published": false
    },
    "columns": [
      {
        "name": "DisbursementID",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 55,
        "precision": null,
        "scale": null,
        "ordinal_position": 1,
        "comment": ""
      },
      {
        "name": "DisbursementNumber",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 34,
        "precision": null,
        "scale": null,
        "ordinal_position": 2,
        "comment": ""
      },
      {
        "name": "DisbursementVersionNumber",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 3,
        "comment": ""
      },
      {
        "name": "DOC_CD",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 8,
        "precision": null,
        "scale": null,
        "ordinal_position": 4,
        "comment": ""
      },
      {
        "name": "DOC_DEPT_CD",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 5,
        "comment": ""
      },
      {
        "name": "DOC_ID",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 6,
        "comment": ""
      },
      {
        "name": "DOC_VERS_NO",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 7,
        "comment": ""
      },
      {
        "name": "DOC_VEND_LN_NO",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 8,
        "comment": ""
      },
      {
        "name": "VEND_CUST_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 9,
        "comment": ""
      },
      {
        "name": "LGL_NM",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 60,
        "precision": null,
        "scale": null,
        "ordinal_position": 10,
        "comment": ""
      },
      {
        "name": "ALIAS_NM",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 60,
        "precision": null,
        "scale": null,
        "ordinal_position": 11,
        "comment": ""
      },
      {
        "name": "AD_ID",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 12,
        "comment": ""
      },
      {
        "name": "AD_LN_1",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 75,
        "precision": null,
        "scale": null,
        "ordinal_position": 13,
        "comment": ""
      },
      {
        "name": "AD_LN_2",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 75,
        "precision": null,
        "scale": null,
        "ordinal_position": 14,
        "comment": ""
      },
      {
        "name": "CITY",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 60,
        "precision": null,
        "scale": null,
        "ordinal_position": 15,
        "comment": ""
      },
      {
        "name": "ST",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 2,
        "precision": null,
        "scale": null,
        "ordinal_position": 16,
        "comment": ""
      },
      {
        "name": "ZIP",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 10,
        "precision": null,
        "scale": null,
        "ordinal_position": 17,
        "comment": ""
      },
      {
        "name": "CTRY",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 3,
        "precision": null,
        "scale": null,
        "ordinal_position": 18,
        "comment": ""
      },
      {
        "name": "CNTAC_ID",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 5,
        "precision": null,
        "scale": null,
        "ordinal_position": 19,
        "comment": ""
      },
      {
        "name": "PRIN_CNTAC",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 60,
        "precision": null,
        "scale": null,
        "ordinal_position": 20,
        "comment": ""
      },
      {
        "name": "VOICE_PH_NO",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 30,
        "precision": null,
        "scale": null,
        "ordinal_position": 21,
        "comment": ""
      },
      {
        "name": "VOICE_PH_EXT",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 6,
        "precision": null,
        "scale": null,
        "ordinal_position": 22,
        "comment": ""
      },
      {
        "name": "EMAIL_AD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 100,
        "precision": null,
        "scale": null,
        "ordinal_position": 23,
        "comment": ""
      },
      {
        "name": "FAX_PH_NO",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 30,
        "precision": null,
        "scale": null,
        "ordinal_position": 24,
        "comment": ""
      },
      {
        "name": "FAX_PH_EXT",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 6,
        "precision": null,
        "scale": null,
        "ordinal_position": 25,
        "comment": ""
      },
      {
        "name": "WEB_AD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 100,
        "precision": null,
        "scale": null,
        "ordinal_position": 26,
        "comment": ""
      },
      {
        "name": "ImportDate",
        "data_type": "datetime",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 27,
        "comment": ""
      }
    ],
    "dependencies": [
      {
        "referenced_schema": "fms",
        "referenced_object": "DisbursementVendor",
        "referenced_type": "USER_TABLE"
      }
    ],
    "analysis": {
      "view_name": "vwDisbursementVendor",
      "explanation": "#### 1. Overview\nThe view `fms.vwDisbursementVendor` is designed to provide a consolidated view of disbursement-related information from the `fms.DisbursementVendor` table. It constructs a composite `DisbursementID` and `DisbursementNumber` by concatenating document-related fields, which serve as unique identifiers or keys for disbursement records. The view includes a wide range of columns, from document identifiers to vendor contact details, suggesting its role in aggregating and presenting comprehensive disbursement and vendor information.\n\n#### 2. Complexity Level: Low\nThe complexity level of this view is considered low. The view is a straightforward SELECT statement without any joins, subqueries, or complex logic. It primarily involves column selection and string concatenation to create composite identifiers. The view depends on a single table, `fms.DisbursementVendor`, which simplifies its structure and maintenance.\n\n#### 3. Data Model Analysis\n- **Underlying Table**: The view is based on the `fms.DisbursementVendor` table. This table contains detailed records of disbursements and associated vendor information.\n- **Columns**: The view selects all columns from the underlying table, with additional computed columns (`DisbursementID` and `DisbursementNumber`) created through string concatenation.\n- **Data Types**: The columns have a mix of data types, including `varchar` for text fields, `int` for numeric fields, and `datetime` for date fields. The use of `varchar` for identifiers and contact information is typical for such data.\n\n#### 4. Business Context and Use Cases\n- **Purpose**: The view is used to provide a unified view of disbursement transactions and vendor details, facilitating reporting and analysis.\n- **Use Cases**: \n - Generating reports that require both disbursement and vendor information.\n - Serving as a data source for applications or dashboards that display disbursement details.\n - Supporting queries that need to filter or sort by composite identifiers like `DisbursementID` or `DisbursementNumber`.\n\n#### 5. Performance Considerations\n- **Efficiency**: The view is efficient due to its simplicity and reliance on a single table. There are no joins or complex calculations that could degrade performance.\n- **Indexing**: Performance can be further optimized by ensuring that the underlying table has appropriate indexes, especially on columns used in the composite identifiers (`DOC_CD`, `DOC_DEPT_CD`, `DOC_ID`, `DOC_VERS_NO`).\n- **Scalability**: As the view grows with more data, performance should remain stable unless the underlying table becomes very large, in which case indexing and partitioning strategies might be necessary.\n\n#### 6. Security and Access Control\n- **Access Control**: The view does not have a CHECK OPTION, meaning there are no restrictions on data modifications through the view. However, since it is a read-only view, this is not a concern.\n- **Permissions**: Access to the view should be controlled through database roles and permissions, ensuring that only authorized users can query the view.\n- **Data Sensitivity**: Consideration should be given to the sensitivity of the data exposed by the view, such as vendor contact details, and appropriate access restrictions should be applied.\n\n#### 7. Potential Issues or Recommendations\n- **Data Integrity**: Ensure that the underlying table maintains data integrity, especially for fields used in composite identifiers, to prevent issues with duplicate or malformed identifiers.\n- **Documentation**: Provide clear documentation for the view, explaining the purpose of each column and the logic behind the composite identifiers.\n- **Indexing**: Review and optimize indexes on the `fms.DisbursementVendor` table to support efficient querying, particularly for columns involved in filtering or sorting operations.\n- **Security Review**: Conduct regular security reviews to ensure that access to the view is appropriately restricted and that sensitive data is protected.",
      "complexity": "Low",
      "model_used": "gpt-4o-2024-08-06",
      "tokens_used": 1736,
      "api_response_id": "chatcmpl-C8aczTYTeTldCXUq8jXAFp7pQpye7"
    },
    "analysis_timestamp": "2025-08-25 19:11:16"
  },
  {
    "view_info": {
      "schema": "fms",
      "name": "vwPaymentRequestAccounting",
      "created": "2025-08-25 16:04:00.820000",
      "last_altered": "2025-08-25 16:04:00.820000",
      "check_option": "NO CHECK OPTION",
      "comment": "",
      "definition": "CREATE VIEW [fms].[vwPaymentRequestAccounting]\r\nAS\r\nSELECT ([DOC_CD] + ' ' + [DOC_DEPT_CD] + ' ' + [DOC_ID] + ' ' + CONVERT(VARCHAR(20), [DOC_VERS_NO])) AS PaymentRequestID,([DOC_CD] + ' ' + [DOC_DEPT_CD] + ' ' + [DOC_ID]) AS PaymentRequestNumber,[DOC_VERS_NO] AS PaymentRequestVersionNumber,[DOC_CD],[DOC_DEPT_CD],[DOC_ID],[DOC_VERS_NO],[DOC_VEND_LN_NO],[DOC_COMM_LN_NO],[DOC_ACTG_LN_NO],[EVNT_TYP_ID],[ACTG_TMPL_ID],[BANK_ACCT_CD],[ACTG_LN_DSCR],[SUB_TOT_LN_AM],[TAX_LN_AM],[USETAX_LN_AM],[LN_AM],[INTR_INELIG_FL],[PYMT_TYP],[IPR_INTR_AM],[BFY],[FY_DC],[PER_DC],[CHK_DSCR],[SPC_INST_CD],[DISB_CAT],[EXT_REAS_CD],[INV_TRKG_DT],[AFTR_APP_FL],[RFED_DOC_CD],[RFED_DOC_DEPT_CD],[RFED_DOC_ID],([RFED_DOC_CD] + ' ' + [RFED_DOC_DEPT_CD] + ' ' + [RFED_DOC_ID]) AS RFEDNumber,[RFED_VEND_LN_NO],[RFED_COMM_LN_NO],[RFED_ACTG_LN_NO], [RF_TYP],[FN_DOC_CD],[FN_DOC_DEPT_CD],[FN_DOC_ID],([FN_DOC_CD] + ' ' + [FN_DOC_DEPT_CD] + ' ' + [FN_DOC_ID]) AS FNNumber,[FUND_CD],[SFUND_CD],[DEPT_CD],[UNIT_CD],[SUNIT_CD],[APPR_CD],[OBJ_CD],[SOBJ_CD],[RSRC_CD],[SRSRC_CD],[BSA_CD],[SBSA_CD],[OBSA_CD],[OSBSA_CD],[DOBJ_CD],[DRSRC_CD],[LOC_CD],[SLOC_CD],[ACTV_CD],[SACTV_CD],[FUNC_CD],[SFUNC_CD],[RPT_CD],[SRPT_CD],[TASK_CD],[STASK_CD],[TASK_ORD_CD],[MJR_PROG_CD],[PROG_CD],[PHASE_CD],[PPC_CD],[RTG_LN_AM],[DISC_LN_AM],[PNLTY_INTR_LN_AM],[WHLD_LN_AM],[INCT_LN_AM],[USETAX_WHLD],[DFLT_INT_FEE_AM],[SUPP_INT_FEE_AM],[PYMT_LN_AM],[OUT_LN_AM],[RFED_LN_AM],[AL_CLSD_AM],[AL_CLSD_DT],[EXT_PR_DESC],[FA_SHELL_IND],[FA_TYP],[ImportDate]\r\nFROM fms.PaymentRequestAccounting;\r\n",
      "is_replicated": false,
      "is_published": false
    },
    "columns": [
      {
        "name": "PaymentRequestID",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 55,
        "precision": null,
        "scale": null,
        "ordinal_position": 1,
        "comment": ""
      },
      {
        "name": "PaymentRequestNumber",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 34,
        "precision": null,
        "scale": null,
        "ordinal_position": 2,
        "comment": ""
      },
      {
        "name": "PaymentRequestVersionNumber",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 3,
        "comment": ""
      },
      {
        "name": "DOC_CD",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 8,
        "precision": null,
        "scale": null,
        "ordinal_position": 4,
        "comment": ""
      },
      {
        "name": "DOC_DEPT_CD",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 5,
        "comment": ""
      },
      {
        "name": "DOC_ID",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 6,
        "comment": ""
      },
      {
        "name": "DOC_VERS_NO",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 7,
        "comment": ""
      },
      {
        "name": "DOC_VEND_LN_NO",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 8,
        "comment": ""
      },
      {
        "name": "DOC_COMM_LN_NO",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 9,
        "comment": ""
      },
      {
        "name": "DOC_ACTG_LN_NO",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 10,
        "comment": ""
      },
      {
        "name": "EVNT_TYP_ID",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 11,
        "comment": ""
      },
      {
        "name": "ACTG_TMPL_ID",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 6,
        "precision": null,
        "scale": null,
        "ordinal_position": 12,
        "comment": ""
      },
      {
        "name": "BANK_ACCT_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 13,
        "comment": ""
      },
      {
        "name": "ACTG_LN_DSCR",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 100,
        "precision": null,
        "scale": null,
        "ordinal_position": 14,
        "comment": ""
      },
      {
        "name": "SUB_TOT_LN_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 15,
        "comment": ""
      },
      {
        "name": "TAX_LN_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 16,
        "comment": ""
      },
      {
        "name": "USETAX_LN_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 17,
        "comment": ""
      },
      {
        "name": "LN_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 18,
        "comment": ""
      },
      {
        "name": "INTR_INELIG_FL",
        "data_type": "bit",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 19,
        "comment": ""
      },
      {
        "name": "PYMT_TYP",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 20,
        "comment": ""
      },
      {
        "name": "IPR_INTR_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 21,
        "comment": ""
      },
      {
        "name": "BFY",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 22,
        "comment": ""
      },
      {
        "name": "FY_DC",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 23,
        "comment": ""
      },
      {
        "name": "PER_DC",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 24,
        "comment": ""
      },
      {
        "name": "CHK_DSCR",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 250,
        "precision": null,
        "scale": null,
        "ordinal_position": 25,
        "comment": ""
      },
      {
        "name": "SPC_INST_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 26,
        "comment": ""
      },
      {
        "name": "DISB_CAT",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 27,
        "comment": ""
      },
      {
        "name": "EXT_REAS_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 1,
        "precision": null,
        "scale": null,
        "ordinal_position": 28,
        "comment": ""
      },
      {
        "name": "INV_TRKG_DT",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 29,
        "comment": ""
      },
      {
        "name": "AFTR_APP_FL",
        "data_type": "bit",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 30,
        "comment": ""
      },
      {
        "name": "RFED_DOC_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 8,
        "precision": null,
        "scale": null,
        "ordinal_position": 31,
        "comment": ""
      },
      {
        "name": "RFED_DOC_DEPT_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 32,
        "comment": ""
      },
      {
        "name": "RFED_DOC_ID",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 33,
        "comment": ""
      },
      {
        "name": "RFEDNumber",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 34,
        "precision": null,
        "scale": null,
        "ordinal_position": 34,
        "comment": ""
      },
      {
        "name": "RFED_VEND_LN_NO",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 35,
        "comment": ""
      },
      {
        "name": "RFED_COMM_LN_NO",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 36,
        "comment": ""
      },
      {
        "name": "RFED_ACTG_LN_NO",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 37,
        "comment": ""
      },
      {
        "name": "RF_TYP",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 3,
        "precision": null,
        "scale": null,
        "ordinal_position": 38,
        "comment": ""
      },
      {
        "name": "FN_DOC_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 8,
        "precision": null,
        "scale": null,
        "ordinal_position": 39,
        "comment": ""
      },
      {
        "name": "FN_DOC_DEPT_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 40,
        "comment": ""
      },
      {
        "name": "FN_DOC_ID",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 41,
        "comment": ""
      },
      {
        "name": "FNNumber",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 34,
        "precision": null,
        "scale": null,
        "ordinal_position": 42,
        "comment": ""
      },
      {
        "name": "FUND_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 43,
        "comment": ""
      },
      {
        "name": "SFUND_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 44,
        "comment": ""
      },
      {
        "name": "DEPT_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 45,
        "comment": ""
      },
      {
        "name": "UNIT_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 8,
        "precision": null,
        "scale": null,
        "ordinal_position": 46,
        "comment": ""
      },
      {
        "name": "SUNIT_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 47,
        "comment": ""
      },
      {
        "name": "APPR_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 9,
        "precision": null,
        "scale": null,
        "ordinal_position": 48,
        "comment": ""
      },
      {
        "name": "OBJ_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 49,
        "comment": ""
      },
      {
        "name": "SOBJ_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 50,
        "comment": ""
      },
      {
        "name": "RSRC_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 5,
        "precision": null,
        "scale": null,
        "ordinal_position": 51,
        "comment": ""
      },
      {
        "name": "SRSRC_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 5,
        "precision": null,
        "scale": null,
        "ordinal_position": 52,
        "comment": ""
      },
      {
        "name": "BSA_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 53,
        "comment": ""
      },
      {
        "name": "SBSA_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 54,
        "comment": ""
      },
      {
        "name": "OBSA_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 55,
        "comment": ""
      },
      {
        "name": "OSBSA_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 56,
        "comment": ""
      },
      {
        "name": "DOBJ_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 5,
        "precision": null,
        "scale": null,
        "ordinal_position": 57,
        "comment": ""
      },
      {
        "name": "DRSRC_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 58,
        "comment": ""
      },
      {
        "name": "LOC_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 59,
        "comment": ""
      },
      {
        "name": "SLOC_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 60,
        "comment": ""
      },
      {
        "name": "ACTV_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 10,
        "precision": null,
        "scale": null,
        "ordinal_position": 61,
        "comment": ""
      },
      {
        "name": "SACTV_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 62,
        "comment": ""
      },
      {
        "name": "FUNC_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 10,
        "precision": null,
        "scale": null,
        "ordinal_position": 63,
        "comment": ""
      },
      {
        "name": "SFUNC_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 64,
        "comment": ""
      },
      {
        "name": "RPT_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 15,
        "precision": null,
        "scale": null,
        "ordinal_position": 65,
        "comment": ""
      },
      {
        "name": "SRPT_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 66,
        "comment": ""
      },
      {
        "name": "TASK_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 67,
        "comment": ""
      },
      {
        "name": "STASK_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 68,
        "comment": ""
      },
      {
        "name": "TASK_ORD_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 6,
        "precision": null,
        "scale": null,
        "ordinal_position": 69,
        "comment": ""
      },
      {
        "name": "MJR_PROG_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 6,
        "precision": null,
        "scale": null,
        "ordinal_position": 70,
        "comment": ""
      },
      {
        "name": "PROG_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 10,
        "precision": null,
        "scale": null,
        "ordinal_position": 71,
        "comment": ""
      },
      {
        "name": "PHASE_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 6,
        "precision": null,
        "scale": null,
        "ordinal_position": 72,
        "comment": ""
      },
      {
        "name": "PPC_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 6,
        "precision": null,
        "scale": null,
        "ordinal_position": 73,
        "comment": ""
      },
      {
        "name": "RTG_LN_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 74,
        "comment": ""
      },
      {
        "name": "DISC_LN_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 75,
        "comment": ""
      },
      {
        "name": "PNLTY_INTR_LN_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 76,
        "comment": ""
      },
      {
        "name": "WHLD_LN_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 77,
        "comment": ""
      },
      {
        "name": "INCT_LN_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 78,
        "comment": ""
      },
      {
        "name": "USETAX_WHLD",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 79,
        "comment": ""
      },
      {
        "name": "DFLT_INT_FEE_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 80,
        "comment": ""
      },
      {
        "name": "SUPP_INT_FEE_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 81,
        "comment": ""
      },
      {
        "name": "PYMT_LN_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 82,
        "comment": ""
      },
      {
        "name": "OUT_LN_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 83,
        "comment": ""
      },
      {
        "name": "RFED_LN_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 84,
        "comment": ""
      },
      {
        "name": "AL_CLSD_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 85,
        "comment": ""
      },
      {
        "name": "AL_CLSD_DT",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 86,
        "comment": ""
      },
      {
        "name": "EXT_PR_DESC",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 1500,
        "precision": null,
        "scale": null,
        "ordinal_position": 87,
        "comment": ""
      },
      {
        "name": "FA_SHELL_IND",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 3,
        "precision": null,
        "scale": null,
        "ordinal_position": 88,
        "comment": ""
      },
      {
        "name": "FA_TYP",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 1,
        "precision": null,
        "scale": null,
        "ordinal_position": 89,
        "comment": ""
      },
      {
        "name": "ImportDate",
        "data_type": "datetime",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 90,
        "comment": ""
      }
    ],
    "dependencies": [
      {
        "referenced_schema": "fms",
        "referenced_object": "PaymentRequestAccounting",
        "referenced_type": "USER_TABLE"
      }
    ],
    "analysis": {
      "view_name": "vwPaymentRequestAccounting",
      "explanation": "#### 1. Overview\nThe view `fms.vwPaymentRequestAccounting` is designed to provide a structured representation of payment request accounting data. It aggregates and formats data from the underlying table `fms.PaymentRequestAccounting` to present a comprehensive view of payment requests, including document identifiers, accounting line details, and various financial metrics. The view constructs composite identifiers like `PaymentRequestID`, `PaymentRequestNumber`, `RFEDNumber`, and `FNNumber` by concatenating relevant document fields, which aids in uniquely identifying and referencing payment requests and related documents.\n\n#### 2. Complexity Level: Medium\nThe complexity level of this view is considered medium. The view primarily involves straightforward SELECT statements with concatenation operations to create composite identifiers. There are no complex joins, subqueries, or aggregations, which keeps the SQL logic relatively simple. However, the large number of columns and the potential volume of data in the underlying table contribute to its medium complexity.\n\n#### 3. Data Model Analysis\n- **Underlying Table**: The view depends on a single table, `fms.PaymentRequestAccounting`, which suggests a direct mapping of columns from the table to the view.\n- **Columns**: The view includes a wide range of columns, indicating a comprehensive data model that captures various aspects of payment requests, such as document details, accounting line numbers, event types, financial amounts, and metadata like import dates.\n- **Composite Identifiers**: The view constructs composite identifiers using concatenation, which implies a need for unique identification of records across multiple dimensions (e.g., document code, department code, document ID).\n\n#### 4. Business Context and Use Cases\n- **Purpose**: The view is used to facilitate reporting and analysis of payment requests within the financial management system. It provides a consolidated view of payment-related data, which can be used for auditing, reconciliation, and financial reporting.\n- **Use Cases**: \n - Generating reports for financial audits and compliance checks.\n - Supporting financial analysts in tracking and managing payment requests.\n - Enabling integration with other systems that require detailed payment request data.\n\n#### 5. Performance Considerations\n- **Data Volume**: Given the potentially large number of columns and the detailed nature of the data, performance could be impacted by the volume of data in `fms.PaymentRequestAccounting`.\n- **Indexing**: Ensuring that the underlying table is properly indexed on frequently queried columns, such as document identifiers, can help improve query performance.\n- **Composite Identifiers**: The use of concatenation to create composite identifiers may add some overhead, but this is generally minimal compared to more complex operations like joins or aggregations.\n\n#### 6. Security and Access Control\n- **Access Control**: Access to the view should be controlled based on user roles and permissions to ensure that sensitive financial data is only accessible to authorized personnel.\n- **Data Sensitivity**: Given the financial nature of the data, it is important to implement appropriate security measures, such as encryption and auditing, to protect against unauthorized access and data breaches.\n\n#### 7. Potential Issues or Recommendations\n- **Data Integrity**: Ensure that the underlying table maintains data integrity, especially for fields used in composite identifiers, to prevent issues with duplicate or incorrect identifiers.\n- **Column Management**: Regularly review and manage the columns included in the view to ensure they align with current business needs and do not include unnecessary or deprecated fields.\n- **Performance Optimization**: Monitor the performance of the view and consider optimization strategies, such as indexing and query tuning, if performance issues arise.\n- **Documentation**: Maintain comprehensive documentation of the view's purpose, structure, and usage to facilitate understanding and maintenance by database administrators and developers.",
      "complexity": "Medium",
      "model_used": "gpt-4o-2024-08-06",
      "tokens_used": 3001,
      "api_response_id": "chatcmpl-C8adJntWZroJhTQuDuOMSoN7jOn7g"
    },
    "analysis_timestamp": "2025-08-25 19:11:51"
  },
  {
    "view_info": {
      "schema": "fms",
      "name": "vwPaymentRequestCommodity",
      "created": "2025-08-25 16:04:00.833000",
      "last_altered": "2025-08-25 16:04:00.833000",
      "check_option": "NO CHECK OPTION",
      "comment": "",
      "definition": "CREATE VIEW [fms].[vwPaymentRequestCommodity]\r\nAS\r\nSELECT ([DOC_CD] + ' ' + [DOC_DEPT_CD] + ' ' + [DOC_ID] + ' ' + CONVERT(VARCHAR(20), [DOC_VERS_NO])) AS PaymentRequestID,([DOC_CD] + ' ' + [DOC_DEPT_CD] + ' ' + [DOC_ID]) AS PaymentRequestNumber,[DOC_VERS_NO] AS PaymentRequestVersionNumber,[DOC_CD],[DOC_DEPT_CD],[DOC_ID],[DOC_VERS_NO],[DOC_VEND_LN_NO],[DOC_COMM_LN_NO],[CL_DSCR],[COMM_CD],[STK_ITM_SFX],[SUPP_PART_NO],[COMM_DSCR],[DSCR],[LN_TYP],[QTY],[UNIT_MEAS_CD],[UNIT_PRICE],[DISC_UNIT_PRICE],[LST_UNIT_PRICE],[CNTRC_AM],[ITM_AM],[USETAX_AM],[TAX_TOT_AM],[ITM_TOT_AM],[COMM_CLSD_AM],[SVC_FRM_DT],[SVC_TO_DT],[TAX_PRFL_CD],[ACTG_PRFL_ID],[PCARD_REC_ID],[CRDH_ID],[PCARD_EXPR_DT],[ACCT_NO],[SEQ_NO],[RECON_STA],[RECT_DT],[CMNT],[LCK_ORD_FL],[LCK_CTLG_LIST_FL],[ALW_PROMO_PRICE],[RF_DOC_CD],[RF_DOC_DEPT_CD],[RF_DOC_ID],[RF_DOC_VEND_LN_NO],[RF_DOC_COMM_LN_NO],[RF_TYP],([RF_DOC_CD] + ' ' + [RF_DOC_DEPT_CD] + ' ' + [RF_DOC_ID]) AS ContractNumber,[FN_DOC_ID],[FN_DOC_DEPT_CD],[FN_DOC_CD],[IN_DOC_CD],[IN_DOC_DEPT_CD],[IN_DOC_ID],[IN_DOC_VEND_LN_NO],[IN_DOC_COMM_LN_NO],[INV_TRKG_DT],[VEND_INV_NO],[VEND_INV_LN_NO],[VEND_INV_DT],[TRKG_DT],[CHK_DSCR],[AGRMT_DOC_CD],[AGRMT_DOC_DEPT_CD],[AGRMT_DOC_ID],[AGRMT_VEND_LN_NO],[AGRMT_COMM_LN_NO],[UR_DOC_CD],[UR_DOC_DEPT_CD],[UR_DOC_ID],[UR_DOC_COMMGP_NO],[UR_DOC_COMM_LN_NO],[DISC_1_DY],[DISC_1_PC],[DISC_ALW_1_FL],[DISC_2_DY],[DISC_2_PC],[DISC_ALW_2_FL],[DISC_3_DY],[DISC_3_PC],[DISC_ALW_3_FL],[DISC_4_DY],[DISC_4_PC],[DISC_ALW_4_FL],[RTG_LN_AM],[DISC_LN_AM],[PNLTY_INTR_LN_AM],[WHLD_LN_AM],[INCT_LN_AM],[USETAX_WHLD],[PYMT_LN_AM],[OUT_LN_AM],[TAX_TYP_1],[TAX_TYP_2],[TAX_TYP_3],[TAX_TYP_4],[TAX_TYP_5],[TAX_TYP_6],[TAX_TYP_7],[TAX_TYP_8],[TAX_TYP_9],[TAX_TYP_10],[TAX_TYP_PC_1],[TAX_TYP_PC_2],[TAX_TYP_PC_3],[TAX_TYP_PC_4],[TAX_TYP_PC_5],[TAX_TYP_PC_6],[TAX_TYP_PC_7],[TAX_TYP_PC_8],[TAX_TYP_PC_9],[TAX_TYP_PC_10],[TAX_TYP_PC_TOT],[TAX_TYP_AM_1],[TAX_TYP_AM_2],[TAX_TYP_AM_3],[TAX_TYP_AM_4],[TAX_TYP_AM_5],[TAX_TYP_AM_6],[TAX_TYP_AM_7],[TAX_TYP_AM_8],[TAX_TYP_AM_9],[TAX_TYP_AM_10],[TAX_TYP_AM_TOT],[FA_SHELL_IND],[FA_TYP],[SHELL_GEN_DT],[RTG_ADJ_AM],[RTG_ADJ_PC],[RTG_ORG_AM],[RTG_OVRD_FL],[EXT_REAS_CD],[PRCU_ID],[PRCU_TYP_ID],[PRCU_TYP_NM],[ImportDate]\r\nFROM fms.PaymentRequestCommodity;\r\n",
      "is_replicated": false,
      "is_published": false
    },
    "columns": [
      {
        "name": "PaymentRequestID",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 55,
        "precision": null,
        "scale": null,
        "ordinal_position": 1,
        "comment": ""
      },
      {
        "name": "PaymentRequestNumber",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 34,
        "precision": null,
        "scale": null,
        "ordinal_position": 2,
        "comment": ""
      },
      {
        "name": "PaymentRequestVersionNumber",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 3,
        "comment": ""
      },
      {
        "name": "DOC_CD",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 8,
        "precision": null,
        "scale": null,
        "ordinal_position": 4,
        "comment": ""
      },
      {
        "name": "DOC_DEPT_CD",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 5,
        "comment": ""
      },
      {
        "name": "DOC_ID",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 6,
        "comment": ""
      },
      {
        "name": "DOC_VERS_NO",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 7,
        "comment": ""
      },
      {
        "name": "DOC_VEND_LN_NO",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 8,
        "comment": ""
      },
      {
        "name": "DOC_COMM_LN_NO",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 9,
        "comment": ""
      },
      {
        "name": "CL_DSCR",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 60,
        "precision": null,
        "scale": null,
        "ordinal_position": 10,
        "comment": ""
      },
      {
        "name": "COMM_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 14,
        "precision": null,
        "scale": null,
        "ordinal_position": 11,
        "comment": ""
      },
      {
        "name": "STK_ITM_SFX",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 3,
        "precision": null,
        "scale": null,
        "ordinal_position": 12,
        "comment": ""
      },
      {
        "name": "SUPP_PART_NO",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 32,
        "precision": null,
        "scale": null,
        "ordinal_position": 13,
        "comment": ""
      },
      {
        "name": "COMM_DSCR",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 60,
        "precision": null,
        "scale": null,
        "ordinal_position": 14,
        "comment": ""
      },
      {
        "name": "DSCR",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 30,
        "precision": null,
        "scale": null,
        "ordinal_position": 15,
        "comment": ""
      },
      {
        "name": "LN_TYP",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 3,
        "precision": null,
        "scale": null,
        "ordinal_position": 16,
        "comment": ""
      },
      {
        "name": "QTY",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 22,
        "scale": 5,
        "ordinal_position": 17,
        "comment": ""
      },
      {
        "name": "UNIT_MEAS_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 18,
        "comment": ""
      },
      {
        "name": "UNIT_PRICE",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 22,
        "scale": 6,
        "ordinal_position": 19,
        "comment": ""
      },
      {
        "name": "DISC_UNIT_PRICE",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 22,
        "scale": 6,
        "ordinal_position": 20,
        "comment": ""
      },
      {
        "name": "LST_UNIT_PRICE",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 22,
        "scale": 6,
        "ordinal_position": 21,
        "comment": ""
      },
      {
        "name": "CNTRC_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 22,
        "comment": ""
      },
      {
        "name": "ITM_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 23,
        "comment": ""
      },
      {
        "name": "USETAX_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 24,
        "comment": ""
      },
      {
        "name": "TAX_TOT_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 25,
        "comment": ""
      },
      {
        "name": "ITM_TOT_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 26,
        "comment": ""
      },
      {
        "name": "COMM_CLSD_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 27,
        "comment": ""
      },
      {
        "name": "SVC_FRM_DT",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 28,
        "comment": ""
      },
      {
        "name": "SVC_TO_DT",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 29,
        "comment": ""
      },
      {
        "name": "TAX_PRFL_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 10,
        "precision": null,
        "scale": null,
        "ordinal_position": 30,
        "comment": ""
      },
      {
        "name": "ACTG_PRFL_ID",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 6,
        "precision": null,
        "scale": null,
        "ordinal_position": 31,
        "comment": ""
      },
      {
        "name": "PCARD_REC_ID",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 32,
        "comment": ""
      },
      {
        "name": "CRDH_ID",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 16,
        "precision": null,
        "scale": null,
        "ordinal_position": 33,
        "comment": ""
      },
      {
        "name": "PCARD_EXPR_DT",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 34,
        "comment": ""
      },
      {
        "name": "ACCT_NO",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 255,
        "precision": null,
        "scale": null,
        "ordinal_position": 35,
        "comment": ""
      },
      {
        "name": "SEQ_NO",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 36,
        "comment": ""
      },
      {
        "name": "RECON_STA",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 37,
        "comment": ""
      },
      {
        "name": "RECT_DT",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 38,
        "comment": ""
      },
      {
        "name": "CMNT",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 1500,
        "precision": null,
        "scale": null,
        "ordinal_position": 39,
        "comment": ""
      },
      {
        "name": "LCK_ORD_FL",
        "data_type": "bit",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 40,
        "comment": ""
      },
      {
        "name": "LCK_CTLG_LIST_FL",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 3,
        "precision": null,
        "scale": null,
        "ordinal_position": 41,
        "comment": ""
      },
      {
        "name": "ALW_PROMO_PRICE",
        "data_type": "bit",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 42,
        "comment": ""
      },
      {
        "name": "RF_DOC_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 8,
        "precision": null,
        "scale": null,
        "ordinal_position": 43,
        "comment": ""
      },
      {
        "name": "RF_DOC_DEPT_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 44,
        "comment": ""
      },
      {
        "name": "RF_DOC_ID",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 45,
        "comment": ""
      },
      {
        "name": "RF_DOC_VEND_LN_NO",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 46,
        "comment": ""
      },
      {
        "name": "RF_DOC_COMM_LN_NO",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 47,
        "comment": ""
      },
      {
        "name": "RF_TYP",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 3,
        "precision": null,
        "scale": null,
        "ordinal_position": 48,
        "comment": ""
      },
      {
        "name": "ContractNumber",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 34,
        "precision": null,
        "scale": null,
        "ordinal_position": 49,
        "comment": ""
      },
      {
        "name": "FN_DOC_ID",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 50,
        "comment": ""
      },
      {
        "name": "FN_DOC_DEPT_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 51,
        "comment": ""
      },
      {
        "name": "FN_DOC_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 52,
        "comment": ""
      },
      {
        "name": "IN_DOC_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 8,
        "precision": null,
        "scale": null,
        "ordinal_position": 53,
        "comment": ""
      },
      {
        "name": "IN_DOC_DEPT_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 54,
        "comment": ""
      },
      {
        "name": "IN_DOC_ID",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 55,
        "comment": ""
      },
      {
        "name": "IN_DOC_VEND_LN_NO",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 56,
        "comment": ""
      },
      {
        "name": "IN_DOC_COMM_LN_NO",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 57,
        "comment": ""
      },
      {
        "name": "INV_TRKG_DT",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 58,
        "comment": ""
      },
      {
        "name": "VEND_INV_NO",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 30,
        "precision": null,
        "scale": null,
        "ordinal_position": 59,
        "comment": ""
      },
      {
        "name": "VEND_INV_LN_NO",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 60,
        "comment": ""
      },
      {
        "name": "VEND_INV_DT",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 61,
        "comment": ""
      },
      {
        "name": "TRKG_DT",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 62,
        "comment": ""
      },
      {
        "name": "CHK_DSCR",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 250,
        "precision": null,
        "scale": null,
        "ordinal_position": 63,
        "comment": ""
      },
      {
        "name": "AGRMT_DOC_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 8,
        "precision": null,
        "scale": null,
        "ordinal_position": 64,
        "comment": ""
      },
      {
        "name": "AGRMT_DOC_DEPT_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 65,
        "comment": ""
      },
      {
        "name": "AGRMT_DOC_ID",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 66,
        "comment": ""
      },
      {
        "name": "AGRMT_VEND_LN_NO",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 67,
        "comment": ""
      },
      {
        "name": "AGRMT_COMM_LN_NO",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 68,
        "comment": ""
      },
      {
        "name": "UR_DOC_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 8,
        "precision": null,
        "scale": null,
        "ordinal_position": 69,
        "comment": ""
      },
      {
        "name": "UR_DOC_DEPT_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 70,
        "comment": ""
      },
      {
        "name": "UR_DOC_ID",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 71,
        "comment": ""
      },
      {
        "name": "UR_DOC_COMMGP_NO",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 72,
        "comment": ""
      },
      {
        "name": "UR_DOC_COMM_LN_NO",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 73,
        "comment": ""
      },
      {
        "name": "DISC_1_DY",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 74,
        "comment": ""
      },
      {
        "name": "DISC_1_PC",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 13,
        "scale": 4,
        "ordinal_position": 75,
        "comment": ""
      },
      {
        "name": "DISC_ALW_1_FL",
        "data_type": "bit",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 76,
        "comment": ""
      },
      {
        "name": "DISC_2_DY",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 77,
        "comment": ""
      },
      {
        "name": "DISC_2_PC",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 13,
        "scale": 4,
        "ordinal_position": 78,
        "comment": ""
      },
      {
        "name": "DISC_ALW_2_FL",
        "data_type": "bit",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 79,
        "comment": ""
      },
      {
        "name": "DISC_3_DY",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 80,
        "comment": ""
      },
      {
        "name": "DISC_3_PC",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 13,
        "scale": 4,
        "ordinal_position": 81,
        "comment": ""
      },
      {
        "name": "DISC_ALW_3_FL",
        "data_type": "bit",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 82,
        "comment": ""
      },
      {
        "name": "DISC_4_DY",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 83,
        "comment": ""
      },
      {
        "name": "DISC_4_PC",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 13,
        "scale": 4,
        "ordinal_position": 84,
        "comment": ""
      },
      {
        "name": "DISC_ALW_4_FL",
        "data_type": "bit",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 85,
        "comment": ""
      },
      {
        "name": "RTG_LN_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 86,
        "comment": ""
      },
      {
        "name": "DISC_LN_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 87,
        "comment": ""
      },
      {
        "name": "PNLTY_INTR_LN_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 88,
        "comment": ""
      },
      {
        "name": "WHLD_LN_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 89,
        "comment": ""
      },
      {
        "name": "INCT_LN_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 90,
        "comment": ""
      },
      {
        "name": "USETAX_WHLD",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 91,
        "comment": ""
      },
      {
        "name": "PYMT_LN_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 92,
        "comment": ""
      },
      {
        "name": "OUT_LN_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 93,
        "comment": ""
      },
      {
        "name": "TAX_TYP_1",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 94,
        "comment": ""
      },
      {
        "name": "TAX_TYP_2",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 95,
        "comment": ""
      },
      {
        "name": "TAX_TYP_3",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 96,
        "comment": ""
      },
      {
        "name": "TAX_TYP_4",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 97,
        "comment": ""
      },
      {
        "name": "TAX_TYP_5",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 98,
        "comment": ""
      },
      {
        "name": "TAX_TYP_6",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 99,
        "comment": ""
      },
      {
        "name": "TAX_TYP_7",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 100,
        "comment": ""
      },
      {
        "name": "TAX_TYP_8",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 101,
        "comment": ""
      },
      {
        "name": "TAX_TYP_9",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 102,
        "comment": ""
      },
      {
        "name": "TAX_TYP_10",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 103,
        "comment": ""
      },
      {
        "name": "TAX_TYP_PC_1",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 13,
        "scale": 4,
        "ordinal_position": 104,
        "comment": ""
      },
      {
        "name": "TAX_TYP_PC_2",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 13,
        "scale": 4,
        "ordinal_position": 105,
        "comment": ""
      },
      {
        "name": "TAX_TYP_PC_3",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 13,
        "scale": 4,
        "ordinal_position": 106,
        "comment": ""
      },
      {
        "name": "TAX_TYP_PC_4",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 13,
        "scale": 4,
        "ordinal_position": 107,
        "comment": ""
      },
      {
        "name": "TAX_TYP_PC_5",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 13,
        "scale": 4,
        "ordinal_position": 108,
        "comment": ""
      },
      {
        "name": "TAX_TYP_PC_6",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 13,
        "scale": 4,
        "ordinal_position": 109,
        "comment": ""
      },
      {
        "name": "TAX_TYP_PC_7",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 13,
        "scale": 4,
        "ordinal_position": 110,
        "comment": ""
      },
      {
        "name": "TAX_TYP_PC_8",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 13,
        "scale": 4,
        "ordinal_position": 111,
        "comment": ""
      },
      {
        "name": "TAX_TYP_PC_9",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 13,
        "scale": 4,
        "ordinal_position": 112,
        "comment": ""
      },
      {
        "name": "TAX_TYP_PC_10",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 13,
        "scale": 4,
        "ordinal_position": 113,
        "comment": ""
      },
      {
        "name": "TAX_TYP_PC_TOT",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 14,
        "scale": 2,
        "ordinal_position": 114,
        "comment": ""
      },
      {
        "name": "TAX_TYP_AM_1",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 115,
        "comment": ""
      },
      {
        "name": "TAX_TYP_AM_2",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 116,
        "comment": ""
      },
      {
        "name": "TAX_TYP_AM_3",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 117,
        "comment": ""
      },
      {
        "name": "TAX_TYP_AM_4",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 118,
        "comment": ""
      },
      {
        "name": "TAX_TYP_AM_5",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 119,
        "comment": ""
      },
      {
        "name": "TAX_TYP_AM_6",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 120,
        "comment": ""
      },
      {
        "name": "TAX_TYP_AM_7",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 121,
        "comment": ""
      },
      {
        "name": "TAX_TYP_AM_8",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 122,
        "comment": ""
      },
      {
        "name": "TAX_TYP_AM_9",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 123,
        "comment": ""
      },
      {
        "name": "TAX_TYP_AM_10",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 124,
        "comment": ""
      },
      {
        "name": "TAX_TYP_AM_TOT",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 125,
        "comment": ""
      },
      {
        "name": "FA_SHELL_IND",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 3,
        "precision": null,
        "scale": null,
        "ordinal_position": 126,
        "comment": ""
      },
      {
        "name": "FA_TYP",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 1,
        "precision": null,
        "scale": null,
        "ordinal_position": 127,
        "comment": ""
      },
      {
        "name": "SHELL_GEN_DT",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 128,
        "comment": ""
      },
      {
        "name": "RTG_ADJ_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 129,
        "comment": ""
      },
      {
        "name": "RTG_ADJ_PC",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 13,
        "scale": 4,
        "ordinal_position": 130,
        "comment": ""
      },
      {
        "name": "RTG_ORG_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 131,
        "comment": ""
      },
      {
        "name": "RTG_OVRD_FL",
        "data_type": "bit",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 132,
        "comment": ""
      },
      {
        "name": "EXT_REAS_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 1,
        "precision": null,
        "scale": null,
        "ordinal_position": 133,
        "comment": ""
      },
      {
        "name": "PRCU_ID",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 134,
        "comment": ""
      },
      {
        "name": "PRCU_TYP_ID",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 10,
        "precision": null,
        "scale": null,
        "ordinal_position": 135,
        "comment": ""
      },
      {
        "name": "PRCU_TYP_NM",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 30,
        "precision": null,
        "scale": null,
        "ordinal_position": 136,
        "comment": ""
      },
      {
        "name": "ImportDate",
        "data_type": "datetime",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 137,
        "comment": ""
      }
    ],
    "dependencies": [
      {
        "referenced_schema": "fms",
        "referenced_object": "PaymentRequestCommodity",
        "referenced_type": "USER_TABLE"
      }
    ],
    "analysis": {
      "view_name": "vwPaymentRequestCommodity",
      "explanation": "#### 1. Overview\nThe view `fms.vwPaymentRequestCommodity` is designed to provide a comprehensive representation of payment request commodities within a financial management system. It aggregates and formats data from the `fms.PaymentRequestCommodity` table, creating concatenated identifiers for payment requests and contracts. The view includes a wide array of columns that cover document identifiers, commodity details, pricing, tax information, and discount structures, among others. This view is used for reporting, auditing, or integration purposes where a detailed view of payment request commodities is required.\n\n#### 2. Complexity Level: Medium\nThe complexity of this view is considered medium due to the following factors:\n- **Structure**: The view includes a large number of columns (over 100), which increases the complexity of understanding and maintaining the view.\n- **SQL Logic**: The SQL logic involves simple concatenation operations to create identifiers, which is straightforward but requires careful attention to ensure data integrity.\n- **Dependencies**: It relies on a single underlying table (`fms.PaymentRequestCommodity`), which simplifies dependency management but still requires understanding of the table's structure and data.\n\n#### 3. Data Model Analysis\n- **Underlying Table**: The view is based on the `fms.PaymentRequestCommodity` table. This table contains detailed records of payment requests, including document identifiers, commodity line numbers, pricing, and tax information.\n- **Columns**: The view includes columns that are directly selected from the table and some that are derived through concatenation. Key columns include identifiers like `PaymentRequestID`, `PaymentRequestNumber`, and `ContractNumber`, as well as financial details such as `UNIT_PRICE`, `ITM_AM`, and various tax-related fields.\n- **Data Types**: The view uses a variety of data types, including `varchar`, `int`, `decimal`, `datetime`, and `bit`, which are appropriate for the types of data being represented.\n\n#### 4. Business Context and Use Cases\n- **Reporting**: The view is used for generating reports that require detailed information about payment requests and their associated commodities.\n- **Auditing**: It can be used in auditing processes to verify the details of payment requests, including pricing, discounts, and tax calculations.\n- **Integration**: The view serve as a data source for integration with other systems that require detailed payment request information, such as accounting or ERP systems.\n\n#### 5. Performance Considerations\n- **Query Performance**: The view's performance will largely depend on the size of the `fms.PaymentRequestCommodity` table. Given the large number of columns, queries against this view could be resource-intensive.\n- **Indexing**: Ensuring that the underlying table is properly indexed, especially on columns used in joins or filters, can help improve performance.\n- **Concatenation Operations**: The concatenation operations for creating identifiers are not computationally expensive but should be monitored for performance impact if the view is queried frequently.\n\n#### 6. Security and Access Control\n- **Access Control**: Access to the view should be restricted to users who require it for their roles, such as financial analysts or auditors. This can be managed through SQL Server's role-based security.\n- **Data Sensitivity**: Given the financial nature of the data, it is important to ensure that sensitive information is protected and that access is logged and monitored.\n\n#### 7. Potential Issues or Recommendations\n- **Data Integrity**: Ensure that the concatenated identifiers (`PaymentRequestID`, `PaymentRequestNumber`, `ContractNumber`) are unique and meaningful. Consider adding constraints or checks in the underlying table to enforce data integrity.\n- **Documentation**: Given the complexity and number of columns, comprehensive documentation should be maintained to aid in understanding and maintaining the view.\n- **Optimization**: Regularly review the performance of the view and consider optimization strategies such as indexing or materialized views if performance becomes an issue.\n- **Column Usage**: Evaluate the necessity of all columns in the view. If certain columns are rarely used, consider creating a simplified version of the view for specific use cases to reduce complexity and improve performance.",
      "complexity": "Medium",
      "model_used": "gpt-4o-2024-08-06",
      "tokens_used": 4175,
      "api_response_id": "chatcmpl-C8adtUUY1nE4toOBm33FAPr0yYVxa"
    },
    "analysis_timestamp": "2025-08-25 19:12:17"
  },
  {
    "view_info": {
      "schema": "fms",
      "name": "vwPaymentRequestHeader",
      "created": "2025-08-25 16:04:00.860000",
      "last_altered": "2025-08-25 16:04:00.860000",
      "check_option": "NO CHECK OPTION",
      "comment": "",
      "definition": "CREATE VIEW [fms].[vwPaymentRequestHeader]\r\nAS\r\nSELECT ([DOC_CD] + ' ' + [DOC_DEPT_CD] + ' ' + [DOC_ID] + ' ' + CONVERT(VARCHAR(20), [DOC_VERS_NO])) AS PaymentRequestID,([DOC_CD] + ' ' + [DOC_DEPT_CD] + ' ' + [DOC_ID]) AS PaymentRequestNumber,[DOC_VERS_NO] AS PaymentRequestVersionNumber,[DOC_CD],[DOC_DEPT_CD],[DOC_ID],[DOC_VERS_NO],[DOC_NM],[DOC_REC_DT_DC],[DOC_BFY],[DOC_FY_DC],[DOC_PER_DC],[BANK_ACCT_CD],[ACTG_PRFL_ID],[REPL_FL],[PCARD_PYMT_FL],[PCARD_ADMR_ID],[CITED_AUTH],[DOC_DSCR],[DOC_ACTU_AM],[RTG_AM],[DISC_AM],[PNLTY_INTR_AM],[WHLD_AM],[INCT_AM],[USETAX_WHLD],[DFLT_INT_FEE_AM],[SUPP_INT_FEE_AM],[PYMT_AM],[OUT_AM],[DOC_CLSD_AM],[DOC_CLSD_DT],[PYEE_VEND_CD],[PYEE_LGL_NM],[PYEE_ALIAS_NM],[PYEE_AD_ID],[PYEE_AD_LN_1],[PYEE_AD_LN_2],[PYEE_CITY],[PYEE_ST],[PYEE_ZIP],[PYEE_CNTAC_ID],[PYEE_CNTAC_NM],[PYEE_VOICE_PH_NO],[PYEE_VOICE_PH_EXT],[PYEE_FAX_PH_NO],[PYEE_FAX_PH_EXT],[PYEE_EMAIL_AD],[PYEE_AD_TYP],[EXT_PR_DESC],[CNTAC_CD],[DOC_CREA_USID],[DOC_APPL_CREA_DT],[DOC_APPL_LAST_USID],[DOC_APPL_LAST_DT],[DOC_FUNC_CD],[ImportDate]\r\nFROM fms.PaymentRequestHeader;\r\n",
      "is_replicated": false,
      "is_published": false
    },
    "columns": [
      {
        "name": "PaymentRequestID",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 55,
        "precision": null,
        "scale": null,
        "ordinal_position": 1,
        "comment": ""
      },
      {
        "name": "PaymentRequestNumber",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 34,
        "precision": null,
        "scale": null,
        "ordinal_position": 2,
        "comment": ""
      },
      {
        "name": "PaymentRequestVersionNumber",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 3,
        "comment": ""
      },
      {
        "name": "DOC_CD",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 8,
        "precision": null,
        "scale": null,
        "ordinal_position": 4,
        "comment": ""
      },
      {
        "name": "DOC_DEPT_CD",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 5,
        "comment": ""
      },
      {
        "name": "DOC_ID",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 6,
        "comment": ""
      },
      {
        "name": "DOC_VERS_NO",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 7,
        "comment": ""
      },
      {
        "name": "DOC_NM",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 60,
        "precision": null,
        "scale": null,
        "ordinal_position": 8,
        "comment": ""
      },
      {
        "name": "DOC_REC_DT_DC",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 9,
        "comment": ""
      },
      {
        "name": "DOC_BFY",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 10,
        "comment": ""
      },
      {
        "name": "DOC_FY_DC",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 11,
        "comment": ""
      },
      {
        "name": "DOC_PER_DC",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 12,
        "comment": ""
      },
      {
        "name": "BANK_ACCT_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 13,
        "comment": ""
      },
      {
        "name": "ACTG_PRFL_ID",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 6,
        "precision": null,
        "scale": null,
        "ordinal_position": 14,
        "comment": ""
      },
      {
        "name": "REPL_FL",
        "data_type": "bit",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 15,
        "comment": ""
      },
      {
        "name": "PCARD_PYMT_FL",
        "data_type": "bit",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 16,
        "comment": ""
      },
      {
        "name": "PCARD_ADMR_ID",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 16,
        "precision": null,
        "scale": null,
        "ordinal_position": 17,
        "comment": ""
      },
      {
        "name": "CITED_AUTH",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 18,
        "comment": ""
      },
      {
        "name": "DOC_DSCR",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 60,
        "precision": null,
        "scale": null,
        "ordinal_position": 19,
        "comment": ""
      },
      {
        "name": "DOC_ACTU_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 20,
        "comment": ""
      },
      {
        "name": "RTG_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 21,
        "comment": ""
      },
      {
        "name": "DISC_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 22,
        "comment": ""
      },
      {
        "name": "PNLTY_INTR_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 23,
        "comment": ""
      },
      {
        "name": "WHLD_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 24,
        "comment": ""
      },
      {
        "name": "INCT_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 25,
        "comment": ""
      },
      {
        "name": "USETAX_WHLD",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 26,
        "comment": ""
      },
      {
        "name": "DFLT_INT_FEE_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 27,
        "comment": ""
      },
      {
        "name": "SUPP_INT_FEE_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 28,
        "comment": ""
      },
      {
        "name": "PYMT_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 29,
        "comment": ""
      },
      {
        "name": "OUT_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 30,
        "comment": ""
      },
      {
        "name": "DOC_CLSD_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 31,
        "comment": ""
      },
      {
        "name": "DOC_CLSD_DT",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 32,
        "comment": ""
      },
      {
        "name": "PYEE_VEND_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 33,
        "comment": ""
      },
      {
        "name": "PYEE_LGL_NM",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 60,
        "precision": null,
        "scale": null,
        "ordinal_position": 34,
        "comment": ""
      },
      {
        "name": "PYEE_ALIAS_NM",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 500,
        "precision": null,
        "scale": null,
        "ordinal_position": 35,
        "comment": ""
      },
      {
        "name": "PYEE_AD_ID",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 36,
        "comment": ""
      },
      {
        "name": "PYEE_AD_LN_1",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 75,
        "precision": null,
        "scale": null,
        "ordinal_position": 37,
        "comment": ""
      },
      {
        "name": "PYEE_AD_LN_2",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 75,
        "precision": null,
        "scale": null,
        "ordinal_position": 38,
        "comment": ""
      },
      {
        "name": "PYEE_CITY",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 60,
        "precision": null,
        "scale": null,
        "ordinal_position": 39,
        "comment": ""
      },
      {
        "name": "PYEE_ST",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 2,
        "precision": null,
        "scale": null,
        "ordinal_position": 40,
        "comment": ""
      },
      {
        "name": "PYEE_ZIP",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 10,
        "precision": null,
        "scale": null,
        "ordinal_position": 41,
        "comment": ""
      },
      {
        "name": "PYEE_CNTAC_ID",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 19,
        "precision": null,
        "scale": null,
        "ordinal_position": 42,
        "comment": ""
      },
      {
        "name": "PYEE_CNTAC_NM",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 60,
        "precision": null,
        "scale": null,
        "ordinal_position": 43,
        "comment": ""
      },
      {
        "name": "PYEE_VOICE_PH_NO",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 30,
        "precision": null,
        "scale": null,
        "ordinal_position": 44,
        "comment": ""
      },
      {
        "name": "PYEE_VOICE_PH_EXT",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 6,
        "precision": null,
        "scale": null,
        "ordinal_position": 45,
        "comment": ""
      },
      {
        "name": "PYEE_FAX_PH_NO",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 30,
        "precision": null,
        "scale": null,
        "ordinal_position": 46,
        "comment": ""
      },
      {
        "name": "PYEE_FAX_PH_EXT",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 6,
        "precision": null,
        "scale": null,
        "ordinal_position": 47,
        "comment": ""
      },
      {
        "name": "PYEE_EMAIL_AD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 100,
        "precision": null,
        "scale": null,
        "ordinal_position": 48,
        "comment": ""
      },
      {
        "name": "PYEE_AD_TYP",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 2,
        "precision": null,
        "scale": null,
        "ordinal_position": 49,
        "comment": ""
      },
      {
        "name": "EXT_PR_DESC",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 1500,
        "precision": null,
        "scale": null,
        "ordinal_position": 50,
        "comment": ""
      },
      {
        "name": "CNTAC_CD",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 51,
        "comment": ""
      },
      {
        "name": "DOC_CREA_USID",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 52,
        "comment": ""
      },
      {
        "name": "DOC_APPL_CREA_DT",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 53,
        "comment": ""
      },
      {
        "name": "DOC_APPL_LAST_USID",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 54,
        "comment": ""
      },
      {
        "name": "DOC_APPL_LAST_DT",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 55,
        "comment": ""
      },
      {
        "name": "DOC_FUNC_CD",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 56,
        "comment": ""
      },
      {
        "name": "ImportDate",
        "data_type": "datetime",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 57,
        "comment": ""
      }
    ],
    "dependencies": [
      {
        "referenced_schema": "fms",
        "referenced_object": "PaymentRequestHeader",
        "referenced_type": "USER_TABLE"
      }
    ],
    "analysis": {
      "view_name": "vwPaymentRequestHeader",
      "explanation": "#### 1. Overview\nThe view `fms.vwPaymentRequestHeader` is designed to provide a consolidated and formatted representation of payment request data from the `fms.PaymentRequestHeader` table. It constructs a unique `PaymentRequestID` and `PaymentRequestNumber` by concatenating document-related fields, which serve as identifiers for payment requests. The view includes a wide range of columns, capturing both financial details (such as amounts and penalties) and payee information (such as vendor codes and contact details). This view is used for reporting, auditing, or integration purposes where a comprehensive snapshot of payment request data is required.\n\n#### 2. Complexity Level: Medium\nThe complexity of this view is considered medium due to the following factors:\n- **Structure**: The view is straightforward in terms of SQL logic, primarily involving column selection and simple string concatenation for creating identifiers.\n- **Dependencies**: It relies on a single underlying table, `fms.PaymentRequestHeader`, which simplifies its dependency structure.\n- **SQL Logic**: The SQL logic is not complex, as it does not involve joins, subqueries, or advanced SQL functions.\n\n#### 3. Data Model Analysis\n- **Underlying Table**: The view is based on the `fms.PaymentRequestHeader` table, which is assumed to store detailed records of payment requests.\n- **Columns**: The view includes a comprehensive set of columns that cover document identifiers, financial amounts, and payee details. This suggests that the underlying table is designed to capture all necessary information related to payment requests.\n- **Data Types**: The use of `varchar` for most identifiers and descriptions allows for flexibility in data storage, while `decimal` is used for financial amounts to ensure precision.\n\n#### 4. Business Context and Use Cases\n- **Reporting**: The view is used for generating reports that require a detailed view of payment requests, including financial and payee information.\n- **Auditing**: It can be used in auditing processes to verify payment request details and ensure compliance with financial regulations.\n- **Integration**: The view serve as a data source for integration with other systems that require payment request information.\n\n#### 5. Performance Considerations\n- **Efficiency**: Since the view is based on a single table without joins or complex calculations, it is expected to perform efficiently, assuming the underlying table is indexed appropriately.\n- **Indexing**: Indexes on key columns such as `DOC_CD`, `DOC_DEPT_CD`, `DOC_ID`, and `DOC_VERS_NO` could improve performance, especially if these columns are frequently used in WHERE clauses or joins in queries using this view.\n- **Scalability**: As the view does not involve complex operations, it should scale well with the size of the `fms.PaymentRequestHeader` table, provided that the database infrastructure supports the expected data volume.\n\n#### 6. Security and Access Control\n- **Access Control**: Access to the view should be controlled based on user roles and permissions, ensuring that only authorized users can view sensitive financial and payee information.\n- **Data Sensitivity**: Given the inclusion of financial amounts and payee contact details, it is crucial to implement appropriate security measures to protect this data from unauthorized access.\n\n#### 7. Potential Issues or Recommendations\n- **Data Integrity**: Ensure that the concatenated identifiers (`PaymentRequestID` and `PaymentRequestNumber`) are unique and meaningful, as they are constructed from multiple fields.\n- **Null Handling**: Consider handling NULL values in concatenated fields to avoid unexpected results in `PaymentRequestID` and `PaymentRequestNumber`.\n- **Documentation**: Provide clear documentation for the view, including its purpose, column definitions, and any business rules applied in the view logic.\n- **Performance Monitoring**: Regularly monitor the performance of queries using this view to identify any potential bottlenecks, especially as the data volume grows.\n- **Security Review**: Conduct periodic security reviews to ensure that access controls remain appropriate and effective in protecting sensitive data.",
      "complexity": "Medium",
      "model_used": "gpt-4o-2024-08-06",
      "tokens_used": 2410,
      "api_response_id": "chatcmpl-C8aeIlROBZm46gDlyVNczVNmQbc9e"
    },
    "analysis_timestamp": "2025-08-25 19:12:30"
  },
  {
    "view_info": {
      "schema": "fms",
      "name": "vwPaymentRequestVendor",
      "created": "2025-08-25 16:04:00.897000",
      "last_altered": "2025-08-25 16:04:00.897000",
      "check_option": "NO CHECK OPTION",
      "comment": "",
      "definition": "CREATE VIEW [fms].[vwPaymentRequestVendor]\r\nAS\r\nSELECT (DOC_CD + ' ' + DOC_DEPT_CD + ' ' + DOC_ID + ' ' + CONVERT(VARCHAR(20), DOC_VERS_NO)) AS PaymentRequestID,([DOC_CD] + ' ' + [DOC_DEPT_CD] + ' ' + [DOC_ID]) AS PaymentRequestNumber,[DOC_VERS_NO] AS PaymentRequestVersionNumber,[DOC_CD],[DOC_DEPT_CD],[DOC_ID],[DOC_VERS_NO],[DOC_VEND_LN_NO],[VEND_CUST_CD],[LGL_NM],[ALIAS_NM],[AD_ID],[AD_LN_1],[AD_LN_2],[CITY],[ST],[ZIP],[CTRY],[CNTY],[CNTAC_ID],[PRIN_CNTAC],[VOICE_PH_NO],[VOICE_PH_EXT],[EMAIL_AD],[FAX_PH_NO],[FAX_PH_EXT],[WEB_AD],[TIN],[TIN_TYP],[MRCHT_ID],[TAX_PRFL_CD],[SVC_FRM_DT],[SVC_TO_DT],[DFLT_DISB_TYP],[DFLT_DISB_FRMT],[SCHED_PYMT_DT],[DISB_PRTY_CD],[VEND_SNGL_CHK_FL],[PAY_THRD_PTY],[ONL_DISB_RQST_FL],[EFT_STA],[HDLG_CD],[VEND_DISB_CAT],[IN_DOC_CD],[IN_DOC_DEPT_CD],[IN_DOC_ID],[INV_TRKG_DT],[VEND_INV_NO],[VEND_INV_DT],[TRKG_DT],[AGRMT_DOC_CD],[AGRMT_DOC_DEPT_CD],[AGRMT_DOC_ID],[AGRMT_VEND_LN_NO],[DISC_1_DY],[DISC_1_PC],[DISC_ALW_1_FL],[DISC_2_DY],[DISC_2_PC],[DISC_ALW_2_FL],[DISC_3_DY],[DISC_3_PC],[DISC_ALW_3_FL],[DISC_4_DY],[DISC_4_PC],[DISC_ALW_4_FL],[PYMT_LN_AM],[ImportDate]\r\nFROM fms.PaymentRequestVendor;\r\n",
      "is_replicated": false,
      "is_published": false
    },
    "columns": [
      {
        "name": "PaymentRequestID",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 55,
        "precision": null,
        "scale": null,
        "ordinal_position": 1,
        "comment": ""
      },
      {
        "name": "PaymentRequestNumber",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 34,
        "precision": null,
        "scale": null,
        "ordinal_position": 2,
        "comment": ""
      },
      {
        "name": "PaymentRequestVersionNumber",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 3,
        "comment": ""
      },
      {
        "name": "DOC_CD",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 8,
        "precision": null,
        "scale": null,
        "ordinal_position": 4,
        "comment": ""
      },
      {
        "name": "DOC_DEPT_CD",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 5,
        "comment": ""
      },
      {
        "name": "DOC_ID",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 6,
        "comment": ""
      },
      {
        "name": "DOC_VERS_NO",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 7,
        "comment": ""
      },
      {
        "name": "DOC_VEND_LN_NO",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 8,
        "comment": ""
      },
      {
        "name": "VEND_CUST_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 9,
        "comment": ""
      },
      {
        "name": "LGL_NM",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 60,
        "precision": null,
        "scale": null,
        "ordinal_position": 10,
        "comment": ""
      },
      {
        "name": "ALIAS_NM",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 60,
        "precision": null,
        "scale": null,
        "ordinal_position": 11,
        "comment": ""
      },
      {
        "name": "AD_ID",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 12,
        "comment": ""
      },
      {
        "name": "AD_LN_1",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 75,
        "precision": null,
        "scale": null,
        "ordinal_position": 13,
        "comment": ""
      },
      {
        "name": "AD_LN_2",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 75,
        "precision": null,
        "scale": null,
        "ordinal_position": 14,
        "comment": ""
      },
      {
        "name": "CITY",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 60,
        "precision": null,
        "scale": null,
        "ordinal_position": 15,
        "comment": ""
      },
      {
        "name": "ST",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 2,
        "precision": null,
        "scale": null,
        "ordinal_position": 16,
        "comment": ""
      },
      {
        "name": "ZIP",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 10,
        "precision": null,
        "scale": null,
        "ordinal_position": 17,
        "comment": ""
      },
      {
        "name": "CTRY",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 3,
        "precision": null,
        "scale": null,
        "ordinal_position": 18,
        "comment": ""
      },
      {
        "name": "CNTY",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 5,
        "precision": null,
        "scale": null,
        "ordinal_position": 19,
        "comment": ""
      },
      {
        "name": "CNTAC_ID",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 20,
        "comment": ""
      },
      {
        "name": "PRIN_CNTAC",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 60,
        "precision": null,
        "scale": null,
        "ordinal_position": 21,
        "comment": ""
      },
      {
        "name": "VOICE_PH_NO",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 30,
        "precision": null,
        "scale": null,
        "ordinal_position": 22,
        "comment": ""
      },
      {
        "name": "VOICE_PH_EXT",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 6,
        "precision": null,
        "scale": null,
        "ordinal_position": 23,
        "comment": ""
      },
      {
        "name": "EMAIL_AD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 100,
        "precision": null,
        "scale": null,
        "ordinal_position": 24,
        "comment": ""
      },
      {
        "name": "FAX_PH_NO",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 30,
        "precision": null,
        "scale": null,
        "ordinal_position": 25,
        "comment": ""
      },
      {
        "name": "FAX_PH_EXT",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 6,
        "precision": null,
        "scale": null,
        "ordinal_position": 26,
        "comment": ""
      },
      {
        "name": "WEB_AD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 100,
        "precision": null,
        "scale": null,
        "ordinal_position": 27,
        "comment": ""
      },
      {
        "name": "TIN",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 9,
        "precision": null,
        "scale": null,
        "ordinal_position": 28,
        "comment": ""
      },
      {
        "name": "TIN_TYP",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 1,
        "precision": null,
        "scale": null,
        "ordinal_position": 29,
        "comment": ""
      },
      {
        "name": "MRCHT_ID",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 30,
        "comment": ""
      },
      {
        "name": "TAX_PRFL_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 10,
        "precision": null,
        "scale": null,
        "ordinal_position": 31,
        "comment": ""
      },
      {
        "name": "SVC_FRM_DT",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 32,
        "comment": ""
      },
      {
        "name": "SVC_TO_DT",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 33,
        "comment": ""
      },
      {
        "name": "DFLT_DISB_TYP",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 3,
        "precision": null,
        "scale": null,
        "ordinal_position": 34,
        "comment": ""
      },
      {
        "name": "DFLT_DISB_FRMT",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 35,
        "comment": ""
      },
      {
        "name": "SCHED_PYMT_DT",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 36,
        "comment": ""
      },
      {
        "name": "DISB_PRTY_CD",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 37,
        "comment": ""
      },
      {
        "name": "VEND_SNGL_CHK_FL",
        "data_type": "bit",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 38,
        "comment": ""
      },
      {
        "name": "PAY_THRD_PTY",
        "data_type": "bit",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 39,
        "comment": ""
      },
      {
        "name": "ONL_DISB_RQST_FL",
        "data_type": "bit",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 40,
        "comment": ""
      },
      {
        "name": "EFT_STA",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 3,
        "precision": null,
        "scale": null,
        "ordinal_position": 41,
        "comment": ""
      },
      {
        "name": "HDLG_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 2,
        "precision": null,
        "scale": null,
        "ordinal_position": 42,
        "comment": ""
      },
      {
        "name": "VEND_DISB_CAT",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 43,
        "comment": ""
      },
      {
        "name": "IN_DOC_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 8,
        "precision": null,
        "scale": null,
        "ordinal_position": 44,
        "comment": ""
      },
      {
        "name": "IN_DOC_DEPT_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 45,
        "comment": ""
      },
      {
        "name": "IN_DOC_ID",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 46,
        "comment": ""
      },
      {
        "name": "INV_TRKG_DT",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 47,
        "comment": ""
      },
      {
        "name": "VEND_INV_NO",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 30,
        "precision": null,
        "scale": null,
        "ordinal_position": 48,
        "comment": ""
      },
      {
        "name": "VEND_INV_DT",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 49,
        "comment": ""
      },
      {
        "name": "TRKG_DT",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 50,
        "comment": ""
      },
      {
        "name": "AGRMT_DOC_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 8,
        "precision": null,
        "scale": null,
        "ordinal_position": 51,
        "comment": ""
      },
      {
        "name": "AGRMT_DOC_DEPT_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 52,
        "comment": ""
      },
      {
        "name": "AGRMT_DOC_ID",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 53,
        "comment": ""
      },
      {
        "name": "AGRMT_VEND_LN_NO",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 54,
        "comment": ""
      },
      {
        "name": "DISC_1_DY",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 55,
        "comment": ""
      },
      {
        "name": "DISC_1_PC",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 13,
        "scale": 4,
        "ordinal_position": 56,
        "comment": ""
      },
      {
        "name": "DISC_ALW_1_FL",
        "data_type": "bit",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 57,
        "comment": ""
      },
      {
        "name": "DISC_2_DY",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 58,
        "comment": ""
      },
      {
        "name": "DISC_2_PC",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 13,
        "scale": 4,
        "ordinal_position": 59,
        "comment": ""
      },
      {
        "name": "DISC_ALW_2_FL",
        "data_type": "bit",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 60,
        "comment": ""
      },
      {
        "name": "DISC_3_DY",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 61,
        "comment": ""
      },
      {
        "name": "DISC_3_PC",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 13,
        "scale": 4,
        "ordinal_position": 62,
        "comment": ""
      },
      {
        "name": "DISC_ALW_3_FL",
        "data_type": "bit",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 63,
        "comment": ""
      },
      {
        "name": "DISC_4_DY",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 64,
        "comment": ""
      },
      {
        "name": "DISC_4_PC",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 13,
        "scale": 4,
        "ordinal_position": 65,
        "comment": ""
      },
      {
        "name": "DISC_ALW_4_FL",
        "data_type": "bit",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 66,
        "comment": ""
      },
      {
        "name": "PYMT_LN_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 67,
        "comment": ""
      },
      {
        "name": "ImportDate",
        "data_type": "datetime",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 68,
        "comment": ""
      }
    ],
    "dependencies": [
      {
        "referenced_schema": "fms",
        "referenced_object": "PaymentRequestVendor",
        "referenced_type": "USER_TABLE"
      }
    ],
    "analysis": {
      "view_name": "vwPaymentRequestVendor",
      "explanation": "#### 1. Overview\nThe view `fms.vwPaymentRequestVendor` is designed to provide a consolidated view of payment request information related to vendors. It aggregates and formats data from the `fms.PaymentRequestVendor` table, creating a more accessible and readable format for users who need to analyze or report on vendor payment requests. The view constructs composite identifiers such as `PaymentRequestID` and `PaymentRequestNumber` by concatenating various document-related fields, which can be useful for uniquely identifying and referencing specific payment requests.\n\n#### 2. Complexity Level: Medium\nThe complexity of this view is considered medium due to the following factors:\n- **Structure**: The view includes a straightforward SELECT statement with no complex joins or subqueries, but it does involve concatenation and conversion operations to create composite identifiers.\n- **Dependencies**: It relies on a single underlying table, `fms.PaymentRequestVendor`, which simplifies its dependency chain.\n- **SQL Logic**: The logic is relatively simple, focusing on data selection and formatting rather than complex transformations or calculations.\n\n#### 3. Data Model Analysis\n- **Underlying Table**: The view is based on the `fms.PaymentRequestVendor` table, which contains detailed records of payment requests associated with vendors.\n- **Columns**: The view exposes a wide range of columns, including identifiers, vendor details, contact information, and payment terms. This suggests that the underlying table is comprehensive and designed to capture all relevant aspects of a vendor payment request.\n- **Composite Identifiers**: The creation of `PaymentRequestID` and `PaymentRequestNumber` indicates a need for unique identifiers that combine multiple fields, which be used for tracking or reporting purposes.\n\n#### 4. Business Context and Use Cases\n- **Purpose**: The view is used for reporting and analysis of vendor payment requests, providing a streamlined way to access and interpret complex data.\n- **Use Cases**: Potential use cases include generating reports for financial audits, tracking payment request statuses, and supporting vendor management processes. It also be used by accounts payable teams to verify payment details and ensure compliance with financial policies.\n\n#### 5. Performance Considerations\n- **Efficiency**: The view is efficient in terms of performance since it does not involve joins or complex calculations. However, the concatenation and conversion operations could introduce minor overhead, especially if the underlying table is large.\n- **Indexing**: Performance can be improved by ensuring that the underlying table is properly indexed, particularly on fields used in the composite identifiers (`DOC_CD`, `DOC_DEPT_CD`, `DOC_ID`, `DOC_VERS_NO`).\n- **Scalability**: As the view is based on a single table, its performance will scale with the size of the `fms.PaymentRequestVendor` table. Regular maintenance and optimization of this table are crucial.\n\n#### 6. Security and Access Control\n- **Access Control**: Access to the view should be restricted to authorized users who require visibility into vendor payment requests. This can be managed through SQL Server's role-based security features.\n- **Data Sensitivity**: The view includes sensitive information such as TIN (Tax Identification Number) and contact details, which necessitates careful handling to comply with data protection regulations. Encryption and masking techniques should be considered for sensitive fields.\n\n#### 7. Potential Issues or Recommendations\n- **Data Integrity**: Ensure that the concatenated fields used in composite identifiers are consistently populated and validated to prevent issues with data integrity.\n- **Field Lengths**: Review the length of concatenated fields to ensure they do not exceed the maximum allowable length for the `varchar` data type, which leads to truncation.\n- **Documentation**: Provide comprehensive documentation for the view, including its purpose, structure, and any business rules applied, to facilitate understanding and maintenance.\n- **Optimization**: Consider adding computed columns or indexed views if performance becomes an issue, particularly for frequently queried fields.\n- **Security Review**: Conduct regular security reviews to ensure compliance with data protection standards and to address any potential vulnerabilities related to sensitive information.",
      "complexity": "Medium",
      "model_used": "gpt-4o-2024-08-06",
      "tokens_used": 2586,
      "api_response_id": "chatcmpl-C8aeVu4ApJUaqPvvR5G6GJ3yP72Hl"
    },
    "analysis_timestamp": "2025-08-25 19:12:50"
  },
  {
    "view_info": {
      "schema": "Invoice",
      "name": "vwActiveInvoiceGroupContracts",
      "created": "2025-08-25 16:04:00.750000",
      "last_altered": "2025-08-25 16:04:00.750000",
      "check_option": "NO CHECK OPTION",
      "comment": "",
      "definition": "\r\n\r\nCREATE VIEW [Invoice].[vwActiveInvoiceGroupContracts]\r\nAS\r\n SELECT IGC.InvoiceGroupContractID, IGC.InvoiceID, I.InvoiceNumber, IGC.BillingGroupContractID, BGC.FiscalYear, BGC.GroupID, BG.GroupName, BG.IsSummaryBilling, BG.BillingType, BGC.ContractID, C.ContractNumber, C.ActualAmount, C.CloseAmount, C.OpenAmount, C.ActualAmount - (C.CloseAmount + C.OpenAmount) AS AvailableAmount, CONVERT(DECIMAL(18, 2), ISNULL(IGCA.AmountBilled, 0.00)) AS AmountBilled, CONVERT(DECIMAL(18, 2), ISNULL(IGCA.AmountPaid, 0.00)) AS AmountPaid, IGC.CreatedDate, IGC.CreatedBy, IGC.ModifiedDate, IGC.ModifiedBy\r\n FROM [Invoice].[InvoiceGroupContract] IGC\r\n LEFT JOIN [Invoice].[Invoice] I ON I.InvoiceID = IGC.InvoiceID\r\n LEFT JOIN [Billing].[BillingGroupContract] BGC ON BGC.BillingGroupContractID = IGC.BillingGroupContractID\r\n LEFT JOIN [Billing].[vwBillingGroups] BG ON BG.GroupID = BGC.GroupID\r\n LEFT JOIN [Billing].[Contract] C ON C.ContractID = BGC.ContractID\r\n LEFT JOIN [Invoice].[vwInvoiceGroupContractAmountsFromBilling] IGCA ON IGCA.InvoiceGroupContractID = IGC.InvoiceGroupContractID\r\n WHERE I.Active = 1;\r\n",
      "is_replicated": false,
      "is_published": false
    },
    "columns": [
      {
        "name": "InvoiceGroupContractID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 1,
        "comment": ""
      },
      {
        "name": "InvoiceID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 2,
        "comment": ""
      },
      {
        "name": "InvoiceNumber",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 25,
        "precision": null,
        "scale": null,
        "ordinal_position": 3,
        "comment": ""
      },
      {
        "name": "BillingGroupContractID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 4,
        "comment": ""
      },
      {
        "name": "FiscalYear",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 5,
        "comment": ""
      },
      {
        "name": "GroupID",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 6,
        "comment": ""
      },
      {
        "name": "GroupName",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 7,
        "comment": ""
      },
      {
        "name": "IsSummaryBilling",
        "data_type": "bit",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 8,
        "comment": ""
      },
      {
        "name": "BillingType",
        "data_type": "char",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 1,
        "precision": null,
        "scale": null,
        "ordinal_position": 9,
        "comment": ""
      },
      {
        "name": "ContractID",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 10,
        "comment": ""
      },
      {
        "name": "ContractNumber",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 25,
        "precision": null,
        "scale": null,
        "ordinal_position": 11,
        "comment": ""
      },
      {
        "name": "ActualAmount",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 12,
        "comment": ""
      },
      {
        "name": "CloseAmount",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 13,
        "comment": ""
      },
      {
        "name": "OpenAmount",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 14,
        "comment": ""
      },
      {
        "name": "AvailableAmount",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 20,
        "scale": 2,
        "ordinal_position": 15,
        "comment": ""
      },
      {
        "name": "AmountBilled",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 16,
        "comment": ""
      },
      {
        "name": "AmountPaid",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 17,
        "comment": ""
      },
      {
        "name": "CreatedDate",
        "data_type": "datetime",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 18,
        "comment": ""
      },
      {
        "name": "CreatedBy",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 19,
        "comment": ""
      },
      {
        "name": "ModifiedDate",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 20,
        "comment": ""
      },
      {
        "name": "ModifiedBy",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 21,
        "comment": ""
      }
    ],
    "dependencies": [
      {
        "referenced_schema": "Billing",
        "referenced_object": "BillingGroupContract",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Billing",
        "referenced_object": "Contract",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Billing",
        "referenced_object": "vwBillingGroups",
        "referenced_type": "VIEW"
      },
      {
        "referenced_schema": "Invoice",
        "referenced_object": "Invoice",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Invoice",
        "referenced_object": "InvoiceGroupContract",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Invoice",
        "referenced_object": "vwInvoiceGroupContractAmountsFromBilling",
        "referenced_type": "VIEW"
      }
    ],
    "analysis": {
      "view_name": "vwActiveInvoiceGroupContracts",
      "explanation": "#### 1. Overview\n\nThe view `Invoice.vwActiveInvoiceGroupContracts` is designed to provide a comprehensive overview of active invoice group contracts. It aggregates data from multiple tables and views related to invoices, billing group contracts, and contract amounts. The view includes details such as invoice numbers, billing group information, contract details, and financial metrics like amounts billed and paid. The primary purpose of this view is to facilitate reporting and analysis of active invoice group contracts, focusing on financial and contractual data.\n\n#### 2. Complexity Level: Medium\n\nThe complexity of this view is considered medium due to the following factors:\n- **Structure**: The view involves multiple joins across different tables and views, which increases the complexity of the SQL logic.\n- **Dependencies**: It relies on five different objects, including both tables and views, which adds to the complexity in terms of understanding and maintaining the view.\n- **SQL Logic**: The use of calculations (e.g., `AvailableAmount`) and conversions (e.g., `AmountBilled`, `AmountPaid`) adds additional layers of complexity.\n\n#### 3. Data Model Analysis\n\n- **Tables and Views**:\n - `Invoice.InvoiceGroupContract`: Central table for invoice group contracts.\n - `Invoice.Invoice`: Provides invoice details, filtered for active invoices.\n - `Billing.BillingGroupContract`: Contains billing group contract information.\n - `Billing.vwBillingGroups`: A view providing group details like name and billing type.\n - `Billing.Contract`: Holds contract-specific financial data.\n - `Invoice.vwInvoiceGroupContractAmountsFromBilling`: A view that aggregates billing amounts related to invoice group contracts.\n\n- **Relationships**:\n - The view establishes relationships primarily through foreign keys, such as `InvoiceID`, `BillingGroupContractID`, and `ContractID`, ensuring data integrity and coherence across the joined tables and views.\n\n#### 4. Business Context and Use Cases\n\n- **Business Context**: This view is used in financial and contract management scenarios where stakeholders need to monitor and analyze active invoice group contracts. It provides a consolidated view of financial metrics and contract details, essential for decision-making and financial reporting.\n \n- **Use Cases**:\n - Generating reports on active invoice group contracts for financial analysis.\n - Monitoring contract performance and financial health by comparing billed and paid amounts.\n - Supporting billing and invoicing processes by providing detailed contract and invoice data.\n\n#### 5. Performance Considerations\n\n- **Joins**: The view uses multiple LEFT JOINs, which can impact performance, especially if the underlying tables are large or not properly indexed.\n- **Calculations and Conversions**: The use of calculated fields and data type conversions can add overhead, potentially affecting query performance.\n- **Indexes**: Ensuring that the joined columns (e.g., `InvoiceID`, `BillingGroupContractID`, `ContractID`) are indexed can significantly improve performance.\n\n#### 6. Security and Access Control\n\n- **Access Control**: Ensure that access to this view is restricted to authorized users only, as it contains sensitive financial and contractual information.\n- **Row-Level Security**: Consider implementing row-level security if different users should see different subsets of the data based on their roles or permissions.\n- **Data Masking**: If necessary, apply data masking techniques to protect sensitive information, such as contract numbers or financial amounts.\n\n#### 7. Potential Issues or Recommendations\n\n- **Indexing**: Review and optimize indexes on the underlying tables to improve query performance, especially for columns used in joins and where clauses.\n- **View Maintenance**: Regularly review and update the view definition to accommodate changes in business requirements or underlying data structures.\n- **Data Integrity**: Ensure that the data in the underlying tables is accurate and up-to-date to maintain the reliability of the view.\n- **Documentation**: Maintain comprehensive documentation for the view, including its purpose, structure, and dependencies, to aid in maintenance and onboarding of new team members.",
      "complexity": "Medium",
      "model_used": "gpt-4o-2024-08-06",
      "tokens_used": 1765,
      "api_response_id": "chatcmpl-C8aepMKXr2inDXMx3D7lEZZEDfh6f"
    },
    "analysis_timestamp": "2025-08-25 19:13:09"
  },
  {
    "view_info": {
      "schema": "Invoice",
      "name": "vwDisbursements",
      "created": "2025-08-25 16:04:00.900000",
      "last_altered": "2025-08-25 16:04:00.900000",
      "check_option": "NO CHECK OPTION",
      "comment": "",
      "definition": "CREATE VIEW [Invoice].[vwDisbursements]\r\nAS\r\nSELECT DISTINCT CONVERT(VARCHAR(50), A.ContractNumber) AS ContractNumber,H.DisbursementID,A.DisbursementNumber,A.DisbursementVersionNumber,CONVERT(VARCHAR(50), A.InvoiceNumber) AS InvoiceNumber,H.PaymentType,H.BANK_ACCT_CD,H.CHK_EFT_STA,H.CHK_EFT_NO,H.CHK_EFT_AM,H.CHK_EFT_ISS_DT,H.CHK_EFT_REC_DT,H.DISB_CAT,H.CLR_DT\r\nFROM fms.vwDisbursementHeader AS H\r\nINNER JOIN (SELECT DISTINCT DBACCT.VEND_INV_NO AS InvoiceNumber,DBACCT.ContractNumber,DBACCT.DisbursementNumber,MAX(DBACCT.DisbursementVersionNumber) AS DisbursementVersionNumber\r\n\tFROM fms.vwDisbursementAccounting AS DBACCT\r\n\tGROUP BY DBACCT.VEND_INV_NO, DBACCT.ContractNumber, DBACCT.DisbursementNumber) AS A\r\n ON (A.DisbursementNumber + ' ' + CONVERT(VARCHAR(20), A.DisbursementVersionNumber)) = H.DisbursementID;\r\n",
      "is_replicated": false,
      "is_published": false
    },
    "columns": [
      {
        "name": "ContractNumber",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 50,
        "precision": null,
        "scale": null,
        "ordinal_position": 1,
        "comment": ""
      },
      {
        "name": "DisbursementID",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 55,
        "precision": null,
        "scale": null,
        "ordinal_position": 2,
        "comment": ""
      },
      {
        "name": "DisbursementNumber",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 34,
        "precision": null,
        "scale": null,
        "ordinal_position": 3,
        "comment": ""
      },
      {
        "name": "DisbursementVersionNumber",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 4,
        "comment": ""
      },
      {
        "name": "InvoiceNumber",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 50,
        "precision": null,
        "scale": null,
        "ordinal_position": 5,
        "comment": ""
      },
      {
        "name": "PaymentType",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 3,
        "precision": null,
        "scale": null,
        "ordinal_position": 6,
        "comment": ""
      },
      {
        "name": "BANK_ACCT_CD",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 7,
        "comment": ""
      },
      {
        "name": "CHK_EFT_STA",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 3,
        "precision": null,
        "scale": null,
        "ordinal_position": 8,
        "comment": ""
      },
      {
        "name": "CHK_EFT_NO",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 15,
        "precision": null,
        "scale": null,
        "ordinal_position": 9,
        "comment": ""
      },
      {
        "name": "CHK_EFT_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 22,
        "scale": 2,
        "ordinal_position": 10,
        "comment": ""
      },
      {
        "name": "CHK_EFT_ISS_DT",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 11,
        "comment": ""
      },
      {
        "name": "CHK_EFT_REC_DT",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 12,
        "comment": ""
      },
      {
        "name": "DISB_CAT",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 13,
        "comment": ""
      },
      {
        "name": "CLR_DT",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 14,
        "comment": ""
      }
    ],
    "dependencies": [
      {
        "referenced_schema": "fms",
        "referenced_object": "vwDisbursementAccounting",
        "referenced_type": "VIEW"
      },
      {
        "referenced_schema": "fms",
        "referenced_object": "vwDisbursementHeader",
        "referenced_type": "VIEW"
      }
    ],
    "analysis": {
      "view_name": "vwDisbursements",
      "explanation": "#### 1. Overview\nThe view `Invoice.vwDisbursements` is designed to provide a consolidated view of disbursement-related data by joining two underlying views: `fms.vwDisbursementHeader` and `fms.vwDisbursementAccounting`. It extracts and combines information such as contract numbers, disbursement identifiers, invoice numbers, payment types, and various check/electronic funds transfer (EFT) details. The view uses a `DISTINCT` clause to ensure unique records and performs an aggregation to select the maximum version number of disbursements.\n\n#### 2. Complexity Level: Medium\nThe complexity of this view is considered medium due to the following factors:\n- It involves a join between two views, which adds a layer of abstraction and complexity.\n- The use of subqueries and aggregation functions (e.g., `MAX`) increases the complexity.\n- The view employs type conversions and string concatenation for joining conditions, which can complicate understanding and maintenance.\n\n#### 3. Data Model Analysis\n- **Dependencies**: The view relies on two other views, `fms.vwDisbursementHeader` and `fms.vwDisbursementAccounting`. These views must be well-defined and optimized, as their performance directly impacts `Invoice.vwDisbursements`.\n- **Columns**: The view selects a mix of financial and administrative data, such as contract numbers, disbursement numbers, and payment details. The use of `varchar` for numeric identifiers suggests flexibility in handling various formats.\n- **Join Logic**: The join condition concatenates `DisbursementNumber` and `DisbursementVersionNumber` to match `DisbursementID`, which implies a composite key structure in the underlying data.\n\n#### 4. Business Context and Use Cases\n- **Purpose**: This view serves financial reporting and auditing purposes, providing a comprehensive snapshot of disbursement transactions.\n- **Use Cases**: It can be used by financial analysts to track disbursement activities, by auditors to verify transaction integrity, and by operational teams to reconcile payments with invoices.\n\n#### 5. Performance Considerations\n- **Distinct and Aggregation**: The use of `DISTINCT` and `MAX` can be resource-intensive, especially if the underlying views return large datasets.\n- **Join Efficiency**: The join condition involves string concatenation, which may slow down query execution. Indexing strategies on the underlying views should be evaluated to optimize performance.\n- **View Stacking**: Since this view depends on other views, any inefficiencies in the base views will propagate, potentially leading to performance bottlenecks.\n\n#### 6. Security and Access Control\n- **Access Control**: Ensure that access to this view is restricted to authorized users, as it contains sensitive financial information.\n- **Data Sensitivity**: Consider implementing row-level security if different users require access to different subsets of data.\n- **Audit and Logging**: Monitor access to this view to detect unauthorized access attempts or unusual query patterns.\n\n#### 7. Potential Issues or Recommendations\n- **Type Conversions**: Review the necessity of type conversions, as they can introduce performance overhead and potential data integrity issues.\n- **Indexing**: Evaluate and implement appropriate indexing on the underlying views to enhance join performance.\n- **View Maintenance**: Regularly review and update the view definition to align with changes in business requirements or underlying data structures.\n- **Documentation**: Maintain comprehensive documentation for this view, detailing its purpose, logic, and dependencies to aid future maintenance and troubleshooting efforts.",
      "complexity": "Medium",
      "model_used": "gpt-4o-2024-08-06",
      "tokens_used": 1536,
      "api_response_id": "chatcmpl-C8af9yo5RGc1tSc3xlfEfOFKLdVIr"
    },
    "analysis_timestamp": "2025-08-25 19:13:19"
  },
  {
    "view_info": {
      "schema": "Invoice",
      "name": "vwInvoiceAccountBillings",
      "created": "2025-08-25 16:04:00.927000",
      "last_altered": "2025-08-25 16:04:00.927000",
      "check_option": "NO CHECK OPTION",
      "comment": "",
      "definition": "CREATE VIEW [Invoice].[vwInvoiceAccountBillings]\r\nAS\r\nSELECT IAB.InvoiceBillingID,IAB.InvoiceGroupContractID,IAB.InvoiceID,I.InvoiceNumber,IAB.GroupID,IGC.GroupName,IAB.ContractID,IGC.ContractNumber,IGC.FiscalYear,IAB.BillingID,IAB.AccountID,IAB.AccountNumber,IAB.FormattedAccountNumber,CASE WHEN I.ProviderID = 2 AND LEN(IAB.AccountNumber) = 15 AND IAB.AccountNumber LIKE '%0000' THEN SUBSTRING(IAB.AccountNumber, 2, 10)\r\n WHEN I.ProviderID = 7 AND LEN(IAB.AccountNumber) = 15 AND IAB.AccountNumber LIKE '%0000' THEN SUBSTRING(IAB.AccountNumber, 0, 12)\r\n WHEN I.ProviderID = 9 AND LEN(IAB.AccountNumber) = 15 AND IAB.AccountNumber LIKE '%0000' THEN SUBSTRING(IAB.AccountNumber, 0, 12)\r\n ELSE IAB.AccountNumber END AS FormattedAccountNumberForEFT,IAB.BillingPeriod,IAB.BillingPeriodDays,IAB.BillingPeriodDaysPriorFY,IAB.BillingPeriodDaysCurrentFY,IAB.FromDate,IAB.ToDate,Billing.UDF_IsSplitFYInvoice(IAB.InvoiceID) AS SplitFY,IAB.IsManualEntry,IAB.IsEstimated,IAB.AmountBilled,IAB.AmountPaid,IAB.AmountPaidPriorFY,IAB.AmountPaidCurrentFY,IAB.EnergyUnit,TRIM(ISNULL(CONVERT(VARCHAR(32), IAB.EnergyUsage), '') + ' ' + ISNULL(IAB.EnergyUnit, '')) AS EnergyUsage,CASE WHEN IAB.EnergyUsagePriorFY > 0 THEN TRIM(ISNULL(CONVERT(VARCHAR(32), IAB.EnergyUsagePriorFY), '') + ' ' + ISNULL(IAB.EnergyUnit, ''))\r\n ELSE '' END AS EnergyUsagePriorFY,CASE WHEN IAB.EnergyUsageCurrentFY > 0 THEN TRIM(ISNULL(CONVERT(VARCHAR(32), IAB.EnergyUsageCurrentFY), '') + ' ' + ISNULL(IAB.EnergyUnit, ''))\r\n ELSE '' END AS EnergyUsageCurrentFY,TRIM(ISNULL(CONVERT(VARCHAR(32), IAB.DemandUsage), '') + ' ' + REPLACE(ISNULL(IAB.EnergyUnit, ''), 'KWH', 'KW')) AS DemandUsage,CASE WHEN IAB.DemandUsagePriorFY > 0 THEN TRIM(ISNULL(CONVERT(VARCHAR(32), IAB.DemandUsagePriorFY), '') + ' ' + REPLACE(ISNULL(IAB.EnergyUnit, ''), 'KWH', 'KW'))\r\n ELSE '' END AS DemandUsagePriorFY,CASE WHEN IAB.DemandUsageCurrentFY > 0 THEN TRIM(ISNULL(CONVERT(VARCHAR(32), IAB.DemandUsageCurrentFY), '') + ' ' + REPLACE(ISNULL(IAB.EnergyUnit, ''), 'KWH', 'KW'))\r\n ELSE '' END AS DemandUsageCurrentFY,IAB.DateBilled,IAB.DateDue,IAB.CreatedBy,IAB.CreatedDate,IAB.ModifiedBy,IAB.ModifiedDate,IAB.Active,IAB.AmountBilled - CAST(IAB.AmountBilled * IAB.BillingPeriodDaysCurrentFY/IIF(IAB.BillingPeriodDays=0, 1, IAB.BillingPeriodDays) AS DECIMAL(18,2)) AS AmountBilledPriorFY,CAST(IAB.AmountBilled * IAB.BillingPeriodDaysCurrentFY/IIF(IAB.BillingPeriodDays=0, 1, IAB.BillingPeriodDays) AS DECIMAL(18,2)) AS AmountBilledCurrentFY,I.ProviderID\r\nFROM Invoice.InvoiceAccountBilling AS IAB\r\n LEFT JOIN Invoice.Invoice AS I ON I.InvoiceID = IAB.InvoiceID\r\n LEFT JOIN Invoice.vwInvoiceGroupContracts AS IGC ON IGC.InvoiceGroupContractID = IAB.InvoiceGroupContractID;\r\n",
      "is_replicated": false,
      "is_published": false
    },
    "columns": [
      {
        "name": "InvoiceBillingID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 1,
        "comment": ""
      },
      {
        "name": "InvoiceGroupContractID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 2,
        "comment": ""
      },
      {
        "name": "InvoiceID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 3,
        "comment": ""
      },
      {
        "name": "InvoiceNumber",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 25,
        "precision": null,
        "scale": null,
        "ordinal_position": 4,
        "comment": ""
      },
      {
        "name": "GroupID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 5,
        "comment": ""
      },
      {
        "name": "GroupName",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 6,
        "comment": ""
      },
      {
        "name": "ContractID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 7,
        "comment": ""
      },
      {
        "name": "ContractNumber",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 25,
        "precision": null,
        "scale": null,
        "ordinal_position": 8,
        "comment": ""
      },
      {
        "name": "FiscalYear",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 9,
        "comment": ""
      },
      {
        "name": "BillingID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 10,
        "comment": ""
      },
      {
        "name": "AccountID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 11,
        "comment": ""
      },
      {
        "name": "AccountNumber",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 15,
        "precision": null,
        "scale": null,
        "ordinal_position": 12,
        "comment": ""
      },
      {
        "name": "FormattedAccountNumber",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 25,
        "precision": null,
        "scale": null,
        "ordinal_position": 13,
        "comment": ""
      },
      {
        "name": "FormattedAccountNumberForEFT",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 15,
        "precision": null,
        "scale": null,
        "ordinal_position": 14,
        "comment": ""
      },
      {
        "name": "BillingPeriod",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 6,
        "precision": null,
        "scale": null,
        "ordinal_position": 15,
        "comment": ""
      },
      {
        "name": "BillingPeriodDays",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 16,
        "comment": ""
      },
      {
        "name": "BillingPeriodDaysPriorFY",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 17,
        "comment": ""
      },
      {
        "name": "BillingPeriodDaysCurrentFY",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 18,
        "comment": ""
      },
      {
        "name": "FromDate",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 19,
        "comment": ""
      },
      {
        "name": "ToDate",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 20,
        "comment": ""
      },
      {
        "name": "SplitFY",
        "data_type": "bit",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 21,
        "comment": ""
      },
      {
        "name": "IsManualEntry",
        "data_type": "bit",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 22,
        "comment": ""
      },
      {
        "name": "IsEstimated",
        "data_type": "bit",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 23,
        "comment": ""
      },
      {
        "name": "AmountBilled",
        "data_type": "decimal",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 24,
        "comment": ""
      },
      {
        "name": "AmountPaid",
        "data_type": "decimal",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 25,
        "comment": ""
      },
      {
        "name": "AmountPaidPriorFY",
        "data_type": "decimal",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 26,
        "comment": ""
      },
      {
        "name": "AmountPaidCurrentFY",
        "data_type": "decimal",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 27,
        "comment": ""
      },
      {
        "name": "EnergyUnit",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 6,
        "precision": null,
        "scale": null,
        "ordinal_position": 28,
        "comment": ""
      },
      {
        "name": "EnergyUsage",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 39,
        "precision": null,
        "scale": null,
        "ordinal_position": 29,
        "comment": ""
      },
      {
        "name": "EnergyUsagePriorFY",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 39,
        "precision": null,
        "scale": null,
        "ordinal_position": 30,
        "comment": ""
      },
      {
        "name": "EnergyUsageCurrentFY",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 39,
        "precision": null,
        "scale": null,
        "ordinal_position": 31,
        "comment": ""
      },
      {
        "name": "DemandUsage",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 8000,
        "precision": null,
        "scale": null,
        "ordinal_position": 32,
        "comment": ""
      },
      {
        "name": "DemandUsagePriorFY",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 8000,
        "precision": null,
        "scale": null,
        "ordinal_position": 33,
        "comment": ""
      },
      {
        "name": "DemandUsageCurrentFY",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 8000,
        "precision": null,
        "scale": null,
        "ordinal_position": 34,
        "comment": ""
      },
      {
        "name": "DateBilled",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 35,
        "comment": ""
      },
      {
        "name": "DateDue",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 36,
        "comment": ""
      },
      {
        "name": "CreatedBy",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 37,
        "comment": ""
      },
      {
        "name": "CreatedDate",
        "data_type": "datetime",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 38,
        "comment": ""
      },
      {
        "name": "ModifiedBy",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 39,
        "comment": ""
      },
      {
        "name": "ModifiedDate",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 40,
        "comment": ""
      },
      {
        "name": "Active",
        "data_type": "bit",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 41,
        "comment": ""
      },
      {
        "name": "AmountBilledPriorFY",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 19,
        "scale": 2,
        "ordinal_position": 42,
        "comment": ""
      },
      {
        "name": "AmountBilledCurrentFY",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 43,
        "comment": ""
      },
      {
        "name": "ProviderID",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 44,
        "comment": ""
      }
    ],
    "dependencies": [
      {
        "referenced_schema": "Billing",
        "referenced_object": "UDF_IsSplitFYInvoice",
        "referenced_type": "SQL_SCALAR_FUNCTION"
      },
      {
        "referenced_schema": "Invoice",
        "referenced_object": "Invoice",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Invoice",
        "referenced_object": "InvoiceAccountBilling",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Invoice",
        "referenced_object": "vwInvoiceGroupContracts",
        "referenced_type": "VIEW"
      }
    ],
    "analysis": {
      "view_name": "vwInvoiceAccountBillings",
      "explanation": "#### 1. Overview\nThe view `Invoice.vwInvoiceAccountBillings` is designed to aggregate and present billing information related to invoices, contracts, and accounts. It combines data from multiple sources, including invoices, account billings, and group contracts, to provide a comprehensive view of billing details. The view includes calculated fields for formatted account numbers, energy usage, demand usage, and fiscal year-specific billing amounts. It also utilizes a scalar function to determine if an invoice spans multiple fiscal years.\n\n#### 2. Complexity Level: Medium\nThe complexity of this view is considered medium due to the following factors:\n- It involves multiple joins across tables and views.\n- It includes several calculated fields with conditional logic and string manipulation.\n- It references a scalar function, which adds a layer of complexity in terms of performance and logic.\n- The view handles potential null values and uses conditional logic to format and calculate fields.\n\n#### 3. Data Model Analysis\n- **Tables and Views**: The view depends on the `Invoice.InvoiceAccountBilling`, `Invoice.Invoice`, and `Invoice.vwInvoiceGroupContracts`. It also references the scalar function `Billing.UDF_IsSplitFYInvoice`.\n- **Columns**: The view selects a wide range of columns, including identifiers, names, dates, and financial figures. It also includes calculated fields for fiscal year-specific amounts and formatted account numbers.\n- **Joins**: The view uses LEFT JOINs to combine data from the `Invoice` and `vwInvoiceGroupContracts` views, ensuring that all records from `InvoiceAccountBilling` are included, even if there are no matching records in the other tables.\n\n#### 4. Business Context and Use Cases\n- **Purpose**: This view is used to generate reports or dashboards that provide insights into billing activities, invoice statuses, and financial performance across fiscal years.\n- **Use Cases**: It can be used by financial analysts to track billing and payment activities, by accountants to reconcile accounts, and by managers to monitor contract performance and compliance.\n\n#### 5. Performance Considerations\n- **Joins and Function Calls**: The use of multiple LEFT JOINs and a scalar function can impact performance, especially if the underlying tables are large or if the function is computationally expensive.\n- **Calculated Fields**: The view includes several calculated fields, which may increase processing time, particularly if these calculations are complex or involve large datasets.\n- **Indexes**: Ensuring that the joined columns are indexed can help improve performance by reducing the time required for join operations.\n\n#### 6. Security and Access Control\n- **Access Control**: Access to this view should be restricted to users who require billing and financial information. Implementing role-based access control helps ensure that only authorized personnel can view or query this data.\n- **Data Sensitivity**: The view contains sensitive financial information, so it is crucial to enforce encryption and secure access protocols to protect data integrity and confidentiality.\n\n#### 7. Potential Issues or Recommendations\n- **Function Performance**: Evaluate the performance of the `Billing.UDF_IsSplitFYInvoice` function, as scalar functions can be a bottleneck in SQL Server. Consider rewriting it as an inline table-valued function if performance issues are identified.\n- **Null Handling**: Ensure that null handling in calculated fields is robust to prevent unexpected results or errors.\n- **Index Optimization**: Review and optimize indexes on the underlying tables to improve join performance.\n- **Data Type Consistency**: Verify that data types are consistent across joins and calculations to avoid implicit conversions that can degrade performance.\n- **Documentation**: Maintain comprehensive documentation for the view, including its purpose, logic, and any dependencies, to facilitate maintenance and updates.",
      "complexity": "Medium",
      "model_used": "gpt-4o-2024-08-06",
      "tokens_used": 2548,
      "api_response_id": "chatcmpl-C8afIMsuZL8c8pUD56XKiuXGwoXl2"
    },
    "analysis_timestamp": "2025-08-25 19:13:35"
  },
  {
    "view_info": {
      "schema": "Invoice",
      "name": "vwInvoiceAgencyHasChargebacks",
      "created": "2025-08-25 16:04:00.847000",
      "last_altered": "2025-08-25 16:04:00.847000",
      "check_option": "NO CHECK OPTION",
      "comment": "",
      "definition": "CREATE VIEW [Invoice].[vwInvoiceAgencyHasChargebacks]\r\nAS\r\nSELECT DISTINCT I.InvoiceID,I.InvoiceNumber,AD.AgencyCodeOEC,U.BudgetGroupDEM,CASE WHEN AD.AgencyCodeOEC IS NULL THEN NULL ELSE SUM(IAB.AmountPaidPriorFY) END AS AgencyChargeback\r\nFROM Invoice.Invoice AS I\r\n\tINNER JOIN Invoice.InvoiceAccountBilling AS IAB ON IAB.InvoiceID = I.InvoiceID\r\n\tLEFT JOIN Billing.EC3_Billing_Account AS A ON A.AccountSeqid = IAB.AccountID\r\n\tLEFT JOIN Billing.EC3_Billing_AgencyDivision AS AD ON AD.AgencyDivisionSeqid = A.AgencyAccount\r\n\tLEFT JOIN Billing.EC3_Billing_UtilityTariffRateInformation AS U ON U.UtilityTariffRateInformationSeqid = A.UtilityTariffRateInformationSeqid\r\nWHERE I.StatusID >= 6 AND I.Active = 1 AND IAB.AmountPaidPriorFY <> 0\r\nGROUP BY I.InvoiceID, I.InvoiceNumber, AD.AgencyCodeOEC, U.BudgetGroupDEM;\r\n",
      "is_replicated": false,
      "is_published": false
    },
    "columns": [
      {
        "name": "InvoiceID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 1,
        "comment": ""
      },
      {
        "name": "InvoiceNumber",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 25,
        "precision": null,
        "scale": null,
        "ordinal_position": 2,
        "comment": ""
      },
      {
        "name": "AgencyCodeOEC",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 6,
        "precision": null,
        "scale": null,
        "ordinal_position": 3,
        "comment": ""
      },
      {
        "name": "BudgetGroupDEM",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 4,
        "comment": ""
      },
      {
        "name": "AgencyChargeback",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 38,
        "scale": 2,
        "ordinal_position": 5,
        "comment": ""
      }
    ],
    "dependencies": [
      {
        "referenced_schema": "Billing",
        "referenced_object": "EC3_Billing_Account",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Billing",
        "referenced_object": "EC3_Billing_AgencyDivision",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Billing",
        "referenced_object": "EC3_Billing_UtilityTariffRateInformation",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Invoice",
        "referenced_object": "Invoice",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Invoice",
        "referenced_object": "InvoiceAccountBilling",
        "referenced_type": "USER_TABLE"
      }
    ],
    "analysis": {
      "view_name": "vwInvoiceAgencyHasChargebacks",
      "explanation": "#### 1. Overview\nThe view `Invoice.vwInvoiceAgencyHasChargebacks` is designed to provide a consolidated view of invoices that have associated chargebacks for agencies. It aggregates data from multiple tables to present a summary of invoices, including the invoice ID, invoice number, agency code, budget group, and the calculated agency chargeback amount. The view filters invoices that are active, have a status ID of 6 or higher, and have a non-zero amount paid in the prior fiscal year. The `AgencyChargeback` is computed conditionally, summing the `AmountPaidPriorFY` only when an agency code is present.\n\n#### 2. Complexity Level: Medium\nThe complexity of this view is considered medium due to the following factors:\n- It involves multiple joins, including both inner and left joins, across five tables.\n- It includes a conditional aggregation using a `CASE` statement.\n- The view uses a `DISTINCT` clause to ensure unique results, which can add complexity in terms of performance.\n- The view includes a `GROUP BY` clause to aggregate data, which requires careful consideration of the columns involved.\n\n#### 3. Data Model Analysis\nThe view depends on the following tables:\n- **Invoice.Invoice**: Central to the view, providing invoice identifiers and status.\n- **Invoice.InvoiceAccountBilling**: Provides billing details linked to invoices, specifically the `AmountPaidPriorFY`.\n- **Billing.EC3_Billing_Account**: Connects invoices to accounts, facilitating the join to agency divisions.\n- **Billing.EC3_Billing_AgencyDivision**: Supplies agency-specific information, such as the agency code.\n- **Billing.EC3_Billing_UtilityTariffRateInformation**: Provides budget group information, related to utility tariffs.\n\nThe view effectively combines these tables to provide a comprehensive picture of agency chargebacks related to invoices.\n\n#### 4. Business Context and Use Cases\nThis view is used in financial reporting and analysis, particularly for:\n- Identifying invoices with chargebacks for specific agencies.\n- Analyzing financial performance and liabilities associated with agency transactions.\n- Supporting decision-making processes in budgeting and financial planning by providing insights into past fiscal year payments.\n- Facilitating audits and compliance checks by providing a clear view of agency-related financial activities.\n\n#### 5. Performance Considerations\n- **Joins and Aggregations**: The use of multiple joins and aggregations can impact performance, especially if the underlying tables are large.\n- **DISTINCT Clause**: This can be resource-intensive, as it requires sorting and deduplication of results.\n- **Conditional Aggregation**: The `CASE` statement within the aggregation can add computational overhead.\n- **Indexes**: Ensuring that appropriate indexes exist on join columns and filter predicates (e.g., `InvoiceID`, `StatusID`, `Active`, `AmountPaidPriorFY`) can help mitigate performance issues.\n\n#### 6. Security and Access Control\n- **Data Sensitivity**: The view exposes financial data, which be sensitive. Proper access controls should be in place to ensure only authorized users can access this view.\n- **Role-Based Access**: Implement role-based access control to restrict view access to users who require it for their roles, such as financial analysts or auditors.\n- **Auditing**: Consider logging access to this view to monitor usage and detect any unauthorized access attempts.\n\n#### 7. Potential Issues or Recommendations\n- **Index Optimization**: Review and optimize indexes on the underlying tables to improve join and filter performance.\n- **View Maintenance**: Regularly review the view definition to ensure it aligns with any changes in business logic or data model updates.\n- **Scalability**: As data volume grows, consider partitioning strategies or materialized views to enhance performance.\n- **Documentation**: Maintain comprehensive documentation of the view's purpose, logic, and dependencies to aid in maintenance and onboarding of new team members.\n- **Error Handling**: Ensure that any potential null values or data inconsistencies are handled gracefully within the view logic.",
      "complexity": "Medium",
      "model_used": "gpt-4o-2024-08-06",
      "tokens_used": 1501,
      "api_response_id": "chatcmpl-C8afZnt5aTZOu6YUyXiXQ6dcaqHz8"
    },
    "analysis_timestamp": "2025-08-25 19:13:53"
  },
  {
    "view_info": {
      "schema": "Invoice",
      "name": "vwInvoiceAmounts",
      "created": "2025-08-25 16:04:00.913000",
      "last_altered": "2025-08-25 16:04:00.913000",
      "check_option": "NO CHECK OPTION",
      "comment": "",
      "definition": "CREATE VIEW [Invoice].[vwInvoiceAmounts]\r\nAS\r\n\tSELECT InvoiceID, ISNULL(SUM(AmountBilled), 0.00) AS AmountBilled, ISNULL(SUM(AmountPaid), 0.00) AS AmountPaid\r\n\tFROM [Invoice].[InvoiceAccountBilling]\r\n\tGROUP BY InvoiceID;\r\n\r\n",
      "is_replicated": false,
      "is_published": false
    },
    "columns": [
      {
        "name": "InvoiceID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 1,
        "comment": ""
      },
      {
        "name": "AmountBilled",
        "data_type": "decimal",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 38,
        "scale": 2,
        "ordinal_position": 2,
        "comment": ""
      },
      {
        "name": "AmountPaid",
        "data_type": "decimal",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 38,
        "scale": 2,
        "ordinal_position": 3,
        "comment": ""
      }
    ],
    "dependencies": [
      {
        "referenced_schema": "Invoice",
        "referenced_object": "InvoiceAccountBilling",
        "referenced_type": "USER_TABLE"
      }
    ],
    "analysis": {
      "view_name": "vwInvoiceAmounts",
      "explanation": "#### 1. Overview\nThe view `Invoice.vwInvoiceAmounts` is designed to aggregate financial data related to invoices from the `Invoice.InvoiceAccountBilling` table. It provides a summarized view of the total amounts billed and paid for each invoice, identified by `InvoiceID`. The use of `ISNULL` ensures that even if there are no amounts billed or paid, the view will return a default value of 0.00 for those fields. This view is useful for reporting and analysis purposes, allowing users to quickly assess the financial status of invoices.\n\n#### 2. Complexity Level: Low\nThe complexity of this view is considered low. It involves a straightforward aggregation operation using `SUM` and a `GROUP BY` clause. The view references a single table and does not involve any joins, subqueries, or complex logic. The use of `ISNULL` is a simple mechanism to handle potential null values.\n\n#### 3. Data Model Analysis\n- **Underlying Table**: The view depends on the `Invoice.InvoiceAccountBilling` table. This table contains detailed billing records for invoices, including individual transactions or line items that contribute to the total amounts billed and paid.\n- **Columns**: The view selects three columns: `InvoiceID`, `AmountBilled`, and `AmountPaid`. The `InvoiceID` is used to group the data, while `AmountBilled` and `AmountPaid` are aggregated using the `SUM` function.\n- **Data Types**: The use of `decimal(38,2)` for financial amounts ensures high precision, which is crucial for financial calculations.\n\n#### 4. Business Context and Use Cases\n- **Financial Reporting**: This view is used in financial reports to provide a summary of invoice amounts. It can be used by accounting departments to track outstanding invoices and payments.\n- **Dashboard Integration**: It can be integrated into business intelligence dashboards to provide real-time insights into billing and payment statuses.\n- **Audit and Compliance**: The view can assist in auditing processes by providing a clear summary of financial transactions related to invoices.\n\n#### 5. Performance Considerations\n- **Aggregation**: The use of `SUM` and `GROUP BY` can impact performance, especially if the `InvoiceAccountBilling` table is large. Indexing on `InvoiceID` can help improve performance by speeding up the grouping operation.\n- **ISNULL Function**: The use of `ISNULL` is efficient for handling null values but should be monitored if the underlying data changes significantly.\n- **No Filtering**: The view does not include any filtering conditions, which means it will process all records in the `InvoiceAccountBilling` table. Consider adding filters if only a subset of data is needed for specific use cases.\n\n#### 6. Security and Access Control\n- **Access Control**: Ensure that only authorized users have access to this view, as it contains sensitive financial information. Implement role-based access control to restrict access based on user roles.\n- **Data Sensitivity**: Since the view deals with financial data, consider encrypting sensitive information at the database level and ensure compliance with data protection regulations.\n\n#### 7. Potential Issues or Recommendations\n- **Indexing**: If performance becomes an issue, consider adding an index on the `InvoiceID` column in the `InvoiceAccountBilling` table to optimize the aggregation process.\n- **Data Integrity**: Regularly validate the data in the `InvoiceAccountBilling` table to ensure accuracy and consistency, as this directly impacts the view's output.\n- **View Maintenance**: Monitor the view's performance and update it as necessary if the underlying table structure changes or if new business requirements emerge.\n- **Documentation**: Maintain clear documentation for the view, including its purpose, structure, and any dependencies, to facilitate maintenance and onboarding of new team members.",
      "complexity": "Low",
      "model_used": "gpt-4o-2024-08-06",
      "tokens_used": 1213,
      "api_response_id": "chatcmpl-C8afq4zoYxKOqnERAYeYDpy0Oftqo"
    },
    "analysis_timestamp": "2025-08-25 19:14:04"
  },
  {
    "view_info": {
      "schema": "Invoice",
      "name": "vwInvoiceBillingAmounts",
      "created": "2025-08-25 16:04:00.930000",
      "last_altered": "2025-08-25 16:04:00.930000",
      "check_option": "NO CHECK OPTION",
      "comment": "",
      "definition": "CREATE VIEW [Invoice].[vwInvoiceBillingAmounts]\r\nAS\r\n SELECT IAB.InvoiceBillingID, IAB.InvoiceGroupContractID, IAB.InvoiceID, IGC.InvoiceNumber, IAB.GroupID, IGC.GroupName, IAB.ContractID, IGC.ContractNumber, IAB.AccountID, IAB.AccountNumber, IAB.FormattedAccountNumber, IAB.BillingID, IAB.BillingPeriod, IAB.BillingPeriodDays, IAB.FromDate, IAB.ToDate, IAB.AmountBilled, IAB.AmountPaid, IAB.EnergyUsage, IAB.DemandUsage, IAB.DateBilled, IAB.DateDue, IAB.IsEstimated, IAB.IsManualEntry, IAB.CreatedDate, IAB.CreatedBy, IAB.ModifiedDate, IAB.ModifiedBy, IAB.Active\r\n FROM [Invoice].[InvoiceAccountBilling] IAB\r\n LEFT JOIN [Invoice].[vwInvoiceGroupContracts] IGC ON IGC.InvoiceGroupContractID = IAB.InvoiceGroupContractID;\r\n",
      "is_replicated": false,
      "is_published": false
    },
    "columns": [
      {
        "name": "InvoiceBillingID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 1,
        "comment": ""
      },
      {
        "name": "InvoiceGroupContractID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 2,
        "comment": ""
      },
      {
        "name": "InvoiceID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 3,
        "comment": ""
      },
      {
        "name": "InvoiceNumber",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 25,
        "precision": null,
        "scale": null,
        "ordinal_position": 4,
        "comment": ""
      },
      {
        "name": "GroupID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 5,
        "comment": ""
      },
      {
        "name": "GroupName",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 6,
        "comment": ""
      },
      {
        "name": "ContractID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 7,
        "comment": ""
      },
      {
        "name": "ContractNumber",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 25,
        "precision": null,
        "scale": null,
        "ordinal_position": 8,
        "comment": ""
      },
      {
        "name": "AccountID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 9,
        "comment": ""
      },
      {
        "name": "AccountNumber",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 15,
        "precision": null,
        "scale": null,
        "ordinal_position": 10,
        "comment": ""
      },
      {
        "name": "FormattedAccountNumber",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 25,
        "precision": null,
        "scale": null,
        "ordinal_position": 11,
        "comment": ""
      },
      {
        "name": "BillingID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 12,
        "comment": ""
      },
      {
        "name": "BillingPeriod",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 6,
        "precision": null,
        "scale": null,
        "ordinal_position": 13,
        "comment": ""
      },
      {
        "name": "BillingPeriodDays",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 14,
        "comment": ""
      },
      {
        "name": "FromDate",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 15,
        "comment": ""
      },
      {
        "name": "ToDate",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 16,
        "comment": ""
      },
      {
        "name": "AmountBilled",
        "data_type": "decimal",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 17,
        "comment": ""
      },
      {
        "name": "AmountPaid",
        "data_type": "decimal",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 18,
        "comment": ""
      },
      {
        "name": "EnergyUsage",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 19,
        "comment": ""
      },
      {
        "name": "DemandUsage",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 20,
        "comment": ""
      },
      {
        "name": "DateBilled",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 21,
        "comment": ""
      },
      {
        "name": "DateDue",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 22,
        "comment": ""
      },
      {
        "name": "IsEstimated",
        "data_type": "bit",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 23,
        "comment": ""
      },
      {
        "name": "IsManualEntry",
        "data_type": "bit",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 24,
        "comment": ""
      },
      {
        "name": "CreatedDate",
        "data_type": "datetime",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 25,
        "comment": ""
      },
      {
        "name": "CreatedBy",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 26,
        "comment": ""
      },
      {
        "name": "ModifiedDate",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 27,
        "comment": ""
      },
      {
        "name": "ModifiedBy",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 28,
        "comment": ""
      },
      {
        "name": "Active",
        "data_type": "bit",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 29,
        "comment": ""
      }
    ],
    "dependencies": [
      {
        "referenced_schema": "Invoice",
        "referenced_object": "InvoiceAccountBilling",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Invoice",
        "referenced_object": "vwInvoiceGroupContracts",
        "referenced_type": "VIEW"
      }
    ],
    "analysis": {
      "view_name": "vwInvoiceBillingAmounts",
      "explanation": "#### 1. Overview\nThe view `Invoice.vwInvoiceBillingAmounts` is designed to consolidate billing information related to invoices, contracts, and accounts. It combines data from the `InvoiceAccountBilling` table and the `vwInvoiceGroupContracts` view to provide a comprehensive dataset that includes billing amounts, usage metrics, and invoice details. This view is used for reporting and analysis purposes, providing a unified view of billing data across different dimensions such as contracts and accounts.\n\n#### 2. Complexity Level: Medium\nThe complexity of this view is considered medium due to the following factors:\n- It involves a join between a table and another view, which adds a layer of complexity in terms of understanding the data flow and dependencies.\n- The view includes a wide range of columns, some of which are derived from the joined view, requiring careful consideration of data integrity and consistency.\n- The SQL logic itself is straightforward, involving a single LEFT JOIN operation, but the dependency on another view increases the complexity of maintenance and understanding.\n\n#### 3. Data Model Analysis\n- **Primary Table**: `Invoice.InvoiceAccountBilling` is the main table providing most of the columns in the view. It contains detailed billing information such as `AmountBilled`, `AmountPaid`, and usage metrics.\n- **Referenced View**: `Invoice.vwInvoiceGroupContracts` is joined to enrich the data with invoice numbers and group names. This view aggregates or filters data from one or more underlying tables related to invoice groups and contracts.\n- **Join Condition**: The LEFT JOIN is based on `InvoiceGroupContractID`, ensuring that all records from `InvoiceAccountBilling` are included, even if there is no matching record in `vwInvoiceGroupContracts`.\n\n#### 4. Business Context and Use Cases\n- **Reporting**: This view is suitable for generating reports that require detailed billing information along with contract and group details.\n- **Financial Analysis**: Analysts can use this view to track billing amounts, payments, and usage metrics over time, aiding in financial forecasting and budgeting.\n- **Audit and Compliance**: The view provides a comprehensive dataset that can be used for auditing purposes, ensuring that billing and payment records are accurate and complete.\n\n#### 5. Performance Considerations\n- **Join Operation**: The LEFT JOIN operation can impact performance, especially if `vwInvoiceGroupContracts` is complex or involves large datasets. Indexing on `InvoiceGroupContractID` in both the table and the view can help optimize performance.\n- **View Dependencies**: Since the view depends on another view, any performance issues in `vwInvoiceGroupContracts` will cascade to this view. It's important to ensure that the underlying view is optimized.\n- **Data Volume**: The performance will also depend on the volume of data in `InvoiceAccountBilling`. Regular maintenance such as indexing and partitioning may be necessary to handle large datasets efficiently.\n\n#### 6. Security and Access Control\n- **Access Control**: Ensure that access to this view is restricted to authorized users only, as it contains sensitive financial data. Implement role-based access control to manage permissions effectively.\n- **Data Sensitivity**: Columns such as `AmountBilled`, `AmountPaid`, and `AccountNumber` contain sensitive information. Consider masking or encrypting sensitive data if necessary.\n- **Audit Logging**: Implement logging to track access to this view, which helps in identifying unauthorized access or data breaches.\n\n#### 7. Potential Issues or Recommendations\n- **Data Consistency**: Ensure that the data in `InvoiceAccountBilling` and `vwInvoiceGroupContracts` is consistent and up-to-date. Any discrepancies leads to inaccurate reporting.\n- **View Maintenance**: Regularly review and update the view definition to accommodate changes in business requirements or underlying data structures.\n- **Indexing**: Consider adding indexes on frequently queried columns such as `InvoiceGroupContractID` to improve query performance.\n- **Documentation**: Maintain thorough documentation of the view's purpose, structure, and dependencies to aid in future maintenance and troubleshooting efforts.",
      "complexity": "Medium",
      "model_used": "gpt-4o-2024-08-06",
      "tokens_used": 1704,
      "api_response_id": "chatcmpl-C8ag1OWhfqf70JB1nmUdZgop0KNq5"
    },
    "analysis_timestamp": "2025-08-25 19:14:23"
  },
  {
    "view_info": {
      "schema": "Invoice",
      "name": "vwInvoiceContractLineAllocations",
      "created": "2025-08-25 16:04:01.013000",
      "last_altered": "2025-08-25 16:04:01.013000",
      "check_option": "NO CHECK OPTION",
      "comment": "",
      "definition": "CREATE VIEW [Invoice].[vwInvoiceContractLineAllocations]\r\nAS\r\n\tSELECT ICLA.InvoiceContractLineAllocationID, ICLA.AllocationFiscalYear, ICLA.AllocationAmount, ICLA.InvoiceContractLineID, ICL.InvoiceID, I.InvoiceNumber, ICL.ContractID, C.ContractNumber, ICL.FiscalYear, ICL.CommodityLine, ICL.AccountingLine, ICL.BudgetCode, ICL.ObjectCode, ICL.UoA, ICL.AmountPaid, ICLA.Comments, ICLA.CreatedBy, ICLA.CreatedDate, ICLA.ModifiedBy, ICLA.ModifiedDate, ICLA.Active\r\n\tFROM [Invoice].[InvoiceContractLineAllocation] ICLA\r\n\tLEFT JOIN [Invoice].[InvoiceContractLine] ICL ON ICL.InvoiceContractLineID = ICLA.InvoiceContractLineID\r\n\tLEFT JOIN [Invoice].[Invoice] I ON I.InvoiceID = ICL.InvoiceID\r\n\tLEFT JOIN [Billing].[Contract] C ON C.ContractID = ICL.ContractID;\r\n",
      "is_replicated": false,
      "is_published": false
    },
    "columns": [
      {
        "name": "InvoiceContractLineAllocationID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 1,
        "comment": ""
      },
      {
        "name": "AllocationFiscalYear",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 2,
        "comment": ""
      },
      {
        "name": "AllocationAmount",
        "data_type": "decimal",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 3,
        "comment": ""
      },
      {
        "name": "InvoiceContractLineID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 4,
        "comment": ""
      },
      {
        "name": "InvoiceID",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 5,
        "comment": ""
      },
      {
        "name": "InvoiceNumber",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 25,
        "precision": null,
        "scale": null,
        "ordinal_position": 6,
        "comment": ""
      },
      {
        "name": "ContractID",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 7,
        "comment": ""
      },
      {
        "name": "ContractNumber",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 25,
        "precision": null,
        "scale": null,
        "ordinal_position": 8,
        "comment": ""
      },
      {
        "name": "FiscalYear",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 9,
        "comment": ""
      },
      {
        "name": "CommodityLine",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 10,
        "comment": ""
      },
      {
        "name": "AccountingLine",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 11,
        "comment": ""
      },
      {
        "name": "BudgetCode",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 12,
        "comment": ""
      },
      {
        "name": "ObjectCode",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 3,
        "precision": null,
        "scale": null,
        "ordinal_position": 13,
        "comment": ""
      },
      {
        "name": "UoA",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 3,
        "precision": null,
        "scale": null,
        "ordinal_position": 14,
        "comment": ""
      },
      {
        "name": "AmountPaid",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 15,
        "comment": ""
      },
      {
        "name": "Comments",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 500,
        "precision": null,
        "scale": null,
        "ordinal_position": 16,
        "comment": ""
      },
      {
        "name": "CreatedBy",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 17,
        "comment": ""
      },
      {
        "name": "CreatedDate",
        "data_type": "datetime",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 18,
        "comment": ""
      },
      {
        "name": "ModifiedBy",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 19,
        "comment": ""
      },
      {
        "name": "ModifiedDate",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 20,
        "comment": ""
      },
      {
        "name": "Active",
        "data_type": "bit",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 21,
        "comment": ""
      }
    ],
    "dependencies": [
      {
        "referenced_schema": "Billing",
        "referenced_object": "Contract",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Invoice",
        "referenced_object": "Invoice",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Invoice",
        "referenced_object": "InvoiceContractLine",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Invoice",
        "referenced_object": "InvoiceContractLineAllocation",
        "referenced_type": "USER_TABLE"
      }
    ],
    "analysis": {
      "view_name": "vwInvoiceContractLineAllocations",
      "explanation": "#### 1. Overview\nThe view `Invoice.vwInvoiceContractLineAllocations` is designed to provide a comprehensive overview of invoice contract line allocations. It aggregates data from multiple tables to present a unified dataset that includes allocation details, invoice information, contract details, and metadata about the creation and modification of records. The view is constructed using a series of LEFT JOIN operations across four tables: `InvoiceContractLineAllocation`, `InvoiceContractLine`, `Invoice`, and `Contract`. This structure allows users to access detailed allocation information alongside related invoice and contract data.\n\n#### 2. Complexity Level: Medium\nThe complexity of this view is considered medium due to the following factors:\n- **Structure**: The view involves multiple LEFT JOIN operations, which increases complexity compared to a simple SELECT statement from a single table.\n- **Dependencies**: It relies on four different tables, which adds to the complexity in terms of understanding the relationships and ensuring data integrity.\n- **SQL Logic**: The SQL logic is straightforward, with no complex calculations or subqueries, but the multiple joins require careful consideration of data relationships.\n\n#### 3. Data Model Analysis\n- **Tables Involved**:\n - `InvoiceContractLineAllocation`: Contains allocation-specific details such as fiscal year, amount, and metadata.\n - `InvoiceContractLine`: Links allocations to specific invoice lines and contracts, providing fiscal year and accounting details.\n - `Invoice`: Provides invoice-specific information like invoice number.\n - `Contract`: Supplies contract-specific details such as contract number.\n- **Relationships**:\n - `InvoiceContractLineAllocation` is linked to `InvoiceContractLine` via `InvoiceContractLineID`.\n - `InvoiceContractLine` is linked to `Invoice` via `InvoiceID` and to `Contract` via `ContractID`.\n- **Data Integrity**: The use of LEFT JOINs ensures that all allocations are included, even if some related invoice or contract data is missing.\n\n#### 4. Business Context and Use Cases\n- **Purpose**: This view is used for reporting and analysis purposes, providing a consolidated view of financial allocations related to invoices and contracts.\n- **Use Cases**:\n - Financial reporting: Generating reports on allocation amounts by fiscal year.\n - Auditing: Reviewing allocation details alongside invoice and contract information.\n - Budgeting: Analyzing allocation trends and amounts for budget planning.\n\n#### 5. Performance Considerations\n- **Join Operations**: The use of multiple LEFT JOINs can impact performance, especially if the underlying tables are large. Indexing on join columns (`InvoiceContractLineID`, `InvoiceID`, `ContractID`) can help mitigate this.\n- **Data Volume**: The performance will also depend on the volume of data in the underlying tables. Regular maintenance and optimization of these tables are crucial.\n- **Query Execution**: The view does not include any filtering or aggregation, which means it will return all records, potentially leading to large result sets. Consider adding WHERE clauses or indexes to improve performance for specific queries.\n\n#### 6. Security and Access Control\n- **Access Control**: Ensure that only authorized users have access to this view, as it contains sensitive financial information.\n- **Row-Level Security**: Consider implementing row-level security if different users should see different subsets of data based on their roles or permissions.\n- **Data Sensitivity**: Columns like `Comments` and `AmountPaid` contain sensitive information, requiring careful consideration of who can access this view.\n\n#### 7. Potential Issues or Recommendations\n- **Data Consistency**: Ensure that the data in the underlying tables is consistent and that referential integrity is maintained, especially given the use of LEFT JOINs.\n- **Indexing**: Evaluate and implement appropriate indexing strategies on the join columns to enhance performance.\n- **View Maintenance**: Regularly review and update the view definition to accommodate changes in business requirements or underlying table structures.\n- **Documentation**: Maintain comprehensive documentation for the view, including its purpose, structure, and any business rules it enforces, to aid in future maintenance and understanding by new team members.",
      "complexity": "Medium",
      "model_used": "gpt-4o-2024-08-06",
      "tokens_used": 1647,
      "api_response_id": "chatcmpl-C8agK7PAqVCAat6cLjXXgxoOhmzde"
    },
    "analysis_timestamp": "2025-08-25 19:14:40"
  },
  {
    "view_info": {
      "schema": "Invoice",
      "name": "vwInvoiceContractLines",
      "created": "2025-08-25 16:04:01.020000",
      "last_altered": "2025-08-25 16:04:01.020000",
      "check_option": "NO CHECK OPTION",
      "comment": "",
      "definition": "\r\n\r\n\r\n\r\n\r\n\r\nCREATE VIEW [Invoice].[vwInvoiceContractLines]\r\nAS\r\n\tSELECT ICL.InvoiceContractLineID, ICL.InvoiceID, I.InvoiceNumber, ICL.ContractID, C.ContractNumber, ICL.ContractLineID, ICL.FiscalYear, ICL.CommodityLine, ICL.AccountingLine, ICL.BudgetCode, ICL.ObjectCode, ICL.UoA, ICL.AmountPaid, IIF (I.StatusID>=4, Invoice.UDF_GetOriginalAmt(NULL, ICL.contractLineID, ICL.FiscalYear, ICL.InvoiceID), CL.ActualAmount) AS ActualAmount, CL.CloseAmount, CASE WHEN CL.FiscalYear>=2019 AND I.StatusID<4 THEN \r\n CL.ActualAmount - Billing.UDF_GetContractLineAmountPaid(CL.ContractLineID, GETDATE()) \r\n WHEN CL.FiscalYear>=2019 AND I.StatusID>=4 THEN\r\n Invoice.UDF_GetOriginalAmt(NULL, ICL.contractLineID, ICL.FiscalYear, ICL.InvoiceID) - Billing.UDF_GetContractLineAmountPaid(CL.ContractLineID, I.InvoiceDate)\r\n WHEN CL.FiscalYear<2019 AND I.StatusID>=4 THEN\r\n Invoice.UDF_GetOriginalAmt(NULL, ICL.contractLineID, ICL.FiscalYear, ICL.InvoiceID) - CL.CloseAmount\r\n ELSE \r\n CL.ActualAmount - CL.CloseAmount\r\n END\tAS OpenAmount\r\n --, CL.OpenAmount commented by Xin on 09/23/2019 for multi-year invoice, (CL.ActualAmount - (CL.CloseAmount + CL.OpenAmount)) AS AvailableAmount, ICL.CreatedDate, ICL.CreatedBy, ICL.ModifiedDate, ICL.ModifiedBy, ICL.Active\r\n\tFROM [Invoice].[InvoiceContractLine] ICL\r\n\tLEFT JOIN [Billing].[ContractLine] CL ON CL.ContractLineID = ICL.ContractLineID\r\n\tLEFT JOIN [Invoice].[Invoice] I ON I.InvoiceID = ICL.InvoiceID\r\n\tLEFT JOIN [Billing].[Contract] C ON C.ContractID = ICL.ContractID;\r\n",
      "is_replicated": false,
      "is_published": false
    },
    "columns": [
      {
        "name": "InvoiceContractLineID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 1,
        "comment": ""
      },
      {
        "name": "InvoiceID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 2,
        "comment": ""
      },
      {
        "name": "InvoiceNumber",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 25,
        "precision": null,
        "scale": null,
        "ordinal_position": 3,
        "comment": ""
      },
      {
        "name": "ContractID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 4,
        "comment": ""
      },
      {
        "name": "ContractNumber",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 25,
        "precision": null,
        "scale": null,
        "ordinal_position": 5,
        "comment": ""
      },
      {
        "name": "ContractLineID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 6,
        "comment": ""
      },
      {
        "name": "FiscalYear",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 7,
        "comment": ""
      },
      {
        "name": "CommodityLine",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 8,
        "comment": ""
      },
      {
        "name": "AccountingLine",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 9,
        "comment": ""
      },
      {
        "name": "BudgetCode",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 10,
        "comment": ""
      },
      {
        "name": "ObjectCode",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 3,
        "precision": null,
        "scale": null,
        "ordinal_position": 11,
        "comment": ""
      },
      {
        "name": "UoA",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 3,
        "precision": null,
        "scale": null,
        "ordinal_position": 12,
        "comment": ""
      },
      {
        "name": "AmountPaid",
        "data_type": "decimal",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 13,
        "comment": ""
      },
      {
        "name": "ActualAmount",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 14,
        "comment": ""
      },
      {
        "name": "CloseAmount",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 15,
        "comment": ""
      },
      {
        "name": "OpenAmount",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 19,
        "scale": 2,
        "ordinal_position": 16,
        "comment": ""
      },
      {
        "name": "AvailableAmount",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 20,
        "scale": 2,
        "ordinal_position": 17,
        "comment": ""
      },
      {
        "name": "CreatedDate",
        "data_type": "datetime",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 18,
        "comment": ""
      },
      {
        "name": "CreatedBy",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 19,
        "comment": ""
      },
      {
        "name": "ModifiedDate",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 20,
        "comment": ""
      },
      {
        "name": "ModifiedBy",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 21,
        "comment": ""
      },
      {
        "name": "Active",
        "data_type": "bit",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 22,
        "comment": ""
      }
    ],
    "dependencies": [
      {
        "referenced_schema": "Billing",
        "referenced_object": "Contract",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Billing",
        "referenced_object": "ContractLine",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Billing",
        "referenced_object": "UDF_GetContractLineAmountPaid",
        "referenced_type": "SQL_SCALAR_FUNCTION"
      },
      {
        "referenced_schema": "Invoice",
        "referenced_object": "Invoice",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Invoice",
        "referenced_object": "InvoiceContractLine",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Invoice",
        "referenced_object": "UDF_GetOriginalAmt",
        "referenced_type": "SQL_SCALAR_FUNCTION"
      }
    ],
    "analysis": {
      "view_name": "vwInvoiceContractLines",
      "explanation": "#### 1. Overview\n\nThe view `Invoice.vwInvoiceContractLines` is designed to provide a comprehensive representation of invoice contract lines by aggregating and transforming data from multiple related tables and functions. It combines information from invoice contract lines, contracts, and invoices, and performs calculations to derive financial metrics such as `ActualAmount`, `OpenAmount`, and `AvailableAmount`. The view is used to facilitate reporting and analysis of financial transactions related to contracts and invoices, providing insights into amounts paid, outstanding balances, and available funds.\n\n#### 2. Complexity Level: Medium\n\nThe complexity of this view is considered medium due to the following factors:\n- It involves multiple joins across different tables (`InvoiceContractLine`, `ContractLine`, `Invoice`, and `Contract`).\n- It utilizes conditional logic and scalar functions to compute derived columns (`ActualAmount`, `OpenAmount`).\n- The view includes both simple and complex calculations, such as those involving conditional logic based on fiscal year and invoice status.\n\n#### 3. Data Model Analysis\n\n**Underlying Tables/Views:**\n- `Invoice.InvoiceContractLine`: Contains details of each invoice contract line, including identifiers and financial data.\n- `Billing.ContractLine`: Provides contract line-specific information, including amounts and fiscal year.\n- `Invoice.Invoice`: Stores invoice-related data, including invoice numbers and status.\n- `Billing.Contract`: Contains contract-specific information, such as contract numbers.\n\n**Dependencies:**\n- `Billing.UDF_GetContractLineAmountPaid`: A scalar function used to calculate the amount paid for a contract line.\n- `Invoice.UDF_GetOriginalAmt`: A scalar function used to determine the original amount for a contract line.\n\nThe view relies on these tables and functions to aggregate and transform data, providing a unified view of invoice contract lines.\n\n#### 4. Business Context and Use Cases\n\nThis view is used in financial reporting and analysis contexts, where stakeholders need to:\n- Monitor and report on the financial status of contracts and invoices.\n- Analyze the amounts paid, outstanding balances, and available funds for contract lines.\n- Support decision-making processes related to contract management and financial planning.\n\nPotential use cases include generating reports for financial audits, tracking contract performance, and managing budget allocations.\n\n#### 5. Performance Considerations\n\n- **Joins and Functions:** The view involves multiple LEFT JOIN operations and calls to scalar functions, which can impact performance, especially with large datasets.\n- **Conditional Logic:** The use of conditional logic in calculating `ActualAmount` and `OpenAmount` may add computational overhead.\n- **Indexes:** Ensuring that appropriate indexes exist on the joined columns (`ContractLineID`, `InvoiceID`, `ContractID`) can help optimize query performance.\n\n#### 6. Security and Access Control\n\n- **Access Control:** Ensure that only authorized users have access to this view, as it contains sensitive financial information.\n- **Row-Level Security:** Consider implementing row-level security if different users should have access to different subsets of data based on their roles or permissions.\n- **Data Masking:** If necessary, apply data masking techniques to protect sensitive information, such as invoice numbers or financial amounts.\n\n#### 7. Potential Issues or Recommendations\n\n- **Function Performance:** Scalar functions can be performance bottlenecks. Consider evaluating the performance of `UDF_GetContractLineAmountPaid` and `UDF_GetOriginalAmt` and optimizing them if necessary.\n- **Commented Code:** The commented-out `OpenAmount` column suggests historical changes. Ensure that the current logic aligns with business requirements and consider removing obsolete code.\n- **Data Type Consistency:** Ensure that data types are consistent across tables and functions to prevent potential conversion issues.\n- **Documentation:** Maintain comprehensive documentation for the view, including its purpose, logic, and any business rules it implements, to facilitate maintenance and understanding by future developers and analysts.",
      "complexity": "Medium",
      "model_used": "gpt-4o-2024-08-06",
      "tokens_used": 1887,
      "api_response_id": "chatcmpl-C8agbJiDYIfXR8yJmopNc41tY3p8O"
    },
    "analysis_timestamp": "2025-08-25 19:14:53"
  },
  {
    "view_info": {
      "schema": "Invoice",
      "name": "vwInvoiceContractLinesSplitFY",
      "created": "2025-08-25 16:04:01.043000",
      "last_altered": "2025-08-25 16:04:01.043000",
      "check_option": "NO CHECK OPTION",
      "comment": "",
      "definition": "\r\n\r\n\r\n\r\n\r\n\r\nCREATE VIEW [Invoice].[vwInvoiceContractLinesSplitFY]\r\nAS\r\n\tSELECT ICL.InvoiceContractLineID, ICL.InvoiceID, I.InvoiceNumber, ICL.ContractID, C.ContractNumber, ICL.ContractLineID, ICL.FiscalYear, ICL.CommodityLine, ICL.AccountingLine, ICL.BudgetCode, ICL.ObjectCode, ICL.UoA, ICL.AmountPaid, IIF (I.StatusID>=4, Invoice.UDF_GetOriginalAmt(NULL, ICL.contractLineID, ICL.FiscalYear, ICL.InvoiceID), CL.ActualAmount) AS ActualAmount\r\n --, CL.ActualAmount, CL.CloseAmount, CASE WHEN CL.FiscalYear>=2019 AND I.StatusID<4 THEN \r\n CL.ActualAmount - Billing.UDF_GetContractLineAmountPaid(CL.ContractLineID, GETDATE()) \r\n WHEN CL.FiscalYear>=2019 AND I.StatusID>=4 THEN\r\n Invoice.UDF_GetOriginalAmt(NULL, ICL.contractLineID, ICL.FiscalYear, ICL.InvoiceID) - Billing.UDF_GetContractLineAmountPaid(CL.ContractLineID, I.InvoiceDate)\r\n WHEN CL.FiscalYear<2019 AND I.StatusID>=4 THEN\r\n Invoice.UDF_GetOriginalAmt(NULL, ICL.contractLineID, ICL.FiscalYear, ICL.InvoiceID) - CL.CloseAmount\r\n ELSE \r\n CL.ActualAmount - CL.CloseAmount\r\n END\tAS OpenAmount\r\n \r\n --, IIF(I.StatusID>=4, [Invoice].[UDF_GetOriginalAmt](ICL.ContractID, ICL.ContractLineID, ICL.FiscalYear, ICL.InvoiceID)-ICL.AmountPaid, CL.OpenAmount) AS OpenAmount\r\n --, CL.OpenAmount commented by Xin on 09/23/2019 for multi-year invoice, (CL.ActualAmount - (CL.CloseAmount + CL.OpenAmount)) AS AvailableAmount, ICL.CreatedDate, ICL.CreatedBy, ICL.ModifiedDate, ICL.ModifiedBy, ICL.Active, SUM(IIF(ICLA.AllocationFiscalYear<Billing.UDF_GetFiscalYear(I.CreatedDate), ICLA.AllocationAmount, 0)) OVER (PARTITION BY ICL.InvoiceContractLineID) AS PriorFYAmountPaid, SUM(IIF(ICLA.AllocationFiscalYear=Billing.UDF_GetFiscalYear(I.CreatedDate), ICLA.AllocationAmount, 0)) OVER (PARTITION BY ICL.InvoiceContractLineID) AS CurrentFYAmountPaid, billing.UDF_GetFiscalYear(I.CreatedDate) AS CurrentFY\r\n\r\n\tFROM [Invoice].[InvoiceContractLine] ICL \r\n\tJOIN [Billing].[ContractLine] CL ON CL.ContractLineID = ICL.ContractLineID\r\n\tJOIN [Invoice].[Invoice] I ON I.InvoiceID = ICL.InvoiceID\r\n\tJOIN [Billing].[Contract] C ON C.ContractID = ICL.ContractID\r\n\tJOIN [Invoice].[InvoiceContractLineAllocation] ICLA ON ICL.InvoiceContractLineID=ICLA.InvoiceContractLineID;\r\n\r\n",
      "is_replicated": false,
      "is_published": false
    },
    "columns": [
      {
        "name": "InvoiceContractLineID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 1,
        "comment": ""
      },
      {
        "name": "InvoiceID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 2,
        "comment": ""
      },
      {
        "name": "InvoiceNumber",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 25,
        "precision": null,
        "scale": null,
        "ordinal_position": 3,
        "comment": ""
      },
      {
        "name": "ContractID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 4,
        "comment": ""
      },
      {
        "name": "ContractNumber",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 25,
        "precision": null,
        "scale": null,
        "ordinal_position": 5,
        "comment": ""
      },
      {
        "name": "ContractLineID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 6,
        "comment": ""
      },
      {
        "name": "FiscalYear",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 7,
        "comment": ""
      },
      {
        "name": "CommodityLine",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 8,
        "comment": ""
      },
      {
        "name": "AccountingLine",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 9,
        "comment": ""
      },
      {
        "name": "BudgetCode",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 10,
        "comment": ""
      },
      {
        "name": "ObjectCode",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 3,
        "precision": null,
        "scale": null,
        "ordinal_position": 11,
        "comment": ""
      },
      {
        "name": "UoA",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 3,
        "precision": null,
        "scale": null,
        "ordinal_position": 12,
        "comment": ""
      },
      {
        "name": "AmountPaid",
        "data_type": "decimal",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 13,
        "comment": ""
      },
      {
        "name": "ActualAmount",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 14,
        "comment": ""
      },
      {
        "name": "CloseAmount",
        "data_type": "decimal",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 15,
        "comment": ""
      },
      {
        "name": "OpenAmount",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 19,
        "scale": 2,
        "ordinal_position": 16,
        "comment": ""
      },
      {
        "name": "AvailableAmount",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 20,
        "scale": 2,
        "ordinal_position": 17,
        "comment": ""
      },
      {
        "name": "CreatedDate",
        "data_type": "datetime",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 18,
        "comment": ""
      },
      {
        "name": "CreatedBy",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 19,
        "comment": ""
      },
      {
        "name": "ModifiedDate",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 20,
        "comment": ""
      },
      {
        "name": "ModifiedBy",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 21,
        "comment": ""
      },
      {
        "name": "Active",
        "data_type": "bit",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 22,
        "comment": ""
      },
      {
        "name": "PriorFYAmountPaid",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 38,
        "scale": 2,
        "ordinal_position": 23,
        "comment": ""
      },
      {
        "name": "CurrentFYAmountPaid",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 38,
        "scale": 2,
        "ordinal_position": 24,
        "comment": ""
      },
      {
        "name": "CurrentFY",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 25,
        "comment": ""
      }
    ],
    "dependencies": [
      {
        "referenced_schema": "Billing",
        "referenced_object": "Contract",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Billing",
        "referenced_object": "ContractLine",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Billing",
        "referenced_object": "UDF_GetContractLineAmountPaid",
        "referenced_type": "SQL_SCALAR_FUNCTION"
      },
      {
        "referenced_schema": "Billing",
        "referenced_object": "UDF_GetFiscalYear",
        "referenced_type": "SQL_SCALAR_FUNCTION"
      },
      {
        "referenced_schema": "Invoice",
        "referenced_object": "Invoice",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Invoice",
        "referenced_object": "InvoiceContractLine",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Invoice",
        "referenced_object": "InvoiceContractLineAllocation",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Invoice",
        "referenced_object": "UDF_GetOriginalAmt",
        "referenced_type": "SQL_SCALAR_FUNCTION"
      }
    ],
    "analysis": {
      "view_name": "vwInvoiceContractLinesSplitFY",
      "explanation": "#### 1. Overview\nThe view `Invoice.vwInvoiceContractLinesSplitFY` is designed to provide a detailed breakdown of invoice contract lines, specifically focusing on fiscal year splits. It aggregates and calculates financial data related to invoices, contracts, and their respective lines, incorporating fiscal year considerations. The view pulls data from multiple tables and utilizes scalar functions to compute specific financial metrics such as `ActualAmount`, `OpenAmount`, `AvailableAmount`, and fiscal year-related payments. This view is used for financial reporting and analysis, particularly in contexts where fiscal year accounting is critical.\n\n#### 2. Complexity Level: Medium\nThe complexity of this view is considered medium due to the following factors:\n- **Structure**: The view involves multiple joins across five tables, which increases its structural complexity.\n- **Dependencies**: It relies on four scalar functions, which add layers of computation and dependency.\n- **SQL Logic**: The use of conditional logic (e.g., `CASE` statements, `IIF` functions) and window functions (`SUM` with `OVER`) adds to the complexity of the SQL logic.\n\n#### 3. Data Model Analysis\n- **Tables**:\n - `Billing.Contract`: Stores contract details.\n - `Billing.ContractLine`: Contains line items for contracts.\n - `Invoice.Invoice`: Holds invoice information.\n - `Invoice.InvoiceContractLine`: Links invoices to contract lines.\n - `Invoice.InvoiceContractLineAllocation`: Manages allocation of invoice contract lines across fiscal years.\n- **Functions**:\n - `Billing.UDF_GetContractLineAmountPaid`: calculates the amount paid for a contract line.\n - `Billing.UDF_GetFiscalYear`: Determines the fiscal year based on a date.\n - `Invoice.UDF_GetOriginalAmt`: Computes the original amount for a contract line, considering adjustments or corrections.\n\n#### 4. Business Context and Use Cases\nThis view is used in financial departments for:\n- **Fiscal Year Reporting**: Providing insights into how contract lines are split across fiscal years.\n- **Financial Analysis**: Analyzing payments and outstanding amounts related to contracts and invoices.\n- **Budgeting and Forecasting**: Assisting in budget planning by showing available and open amounts.\n- **Audit and Compliance**: Ensuring that financial transactions align with fiscal year requirements.\n\n#### 5. Performance Considerations\n- **Joins and Functions**: The view involves multiple joins and calls to scalar functions, which can impact performance, especially with large datasets.\n- **Window Functions**: The use of window functions (`SUM` with `OVER`) can be resource-intensive, particularly if the underlying tables are large.\n- **Indexes**: Ensuring that appropriate indexes exist on join columns and frequently queried fields can help mitigate performance issues.\n\n#### 6. Security and Access Control\n- **Data Sensitivity**: The view handles financial data, which is sensitive. Access should be restricted to authorized personnel only.\n- **Role-Based Access**: Implement role-based access control to ensure that only users with the necessary permissions can query this view.\n- **Auditing**: Consider implementing auditing to track who accesses the view and when, to ensure compliance with financial regulations.\n\n#### 7. Potential Issues or Recommendations\n- **Function Optimization**: Review the scalar functions for optimization opportunities, as they can be performance bottlenecks.\n- **Indexing Strategy**: Evaluate and implement an indexing strategy to improve join and filter performance.\n- **Data Validation**: Ensure that the logic for calculating amounts (e.g., `ActualAmount`, `OpenAmount`) is thoroughly validated to prevent discrepancies.\n- **Documentation**: Maintain comprehensive documentation for the view and its dependencies to aid in maintenance and troubleshooting.\n- **Testing**: Regularly test the view with different data scenarios to ensure it handles edge cases and fiscal year transitions correctly.",
      "complexity": "Medium",
      "model_used": "gpt-4o-2024-08-06",
      "tokens_used": 2173,
      "api_response_id": "chatcmpl-C8ago8DhPzbwAmxh13OWhytdtFAES"
    },
    "analysis_timestamp": "2025-08-25 19:15:11"
  },
  {
    "view_info": {
      "schema": "Invoice",
      "name": "vwInvoiceGroupContractAmounts",
      "created": "2025-08-25 16:04:00.903000",
      "last_altered": "2025-08-25 16:04:00.903000",
      "check_option": "NO CHECK OPTION",
      "comment": "",
      "definition": "CREATE VIEW [Invoice].[vwInvoiceGroupContractAmounts]\r\nAS\r\n\tSELECT InvoiceGroupContractID, CONVERT(DECIMAL(18, 2), ISNULL(SUM(AmountBilled), 0.00)) AS AmountBilled, CONVERT(DECIMAL(18, 2), ISNULL(SUM(AmountPaid), 0.00)) AS AmountPaid\r\n\tFROM [Invoice].[InvoiceAccountBilling]\r\n\tGROUP BY InvoiceGroupContractID;\r\n",
      "is_replicated": false,
      "is_published": false
    },
    "columns": [
      {
        "name": "InvoiceGroupContractID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 1,
        "comment": ""
      },
      {
        "name": "AmountBilled",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 2,
        "comment": ""
      },
      {
        "name": "AmountPaid",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 3,
        "comment": ""
      }
    ],
    "dependencies": [
      {
        "referenced_schema": "Invoice",
        "referenced_object": "InvoiceAccountBilling",
        "referenced_type": "USER_TABLE"
      }
    ],
    "analysis": {
      "view_name": "vwInvoiceGroupContractAmounts",
      "explanation": "#### 1. Overview\nThe view `Invoice.vwInvoiceGroupContractAmounts` is designed to aggregate financial data related to invoice group contracts. It calculates the total amounts billed and paid for each `InvoiceGroupContractID` by summing up the respective fields from the `Invoice.InvoiceAccountBilling` table. The view ensures that even if there are no entries for a particular contract, it returns a zero value instead of NULL, providing a more complete dataset for analysis or reporting.\n\n#### 2. Complexity Level: Low\nThe complexity of this view is considered low. It involves a straightforward aggregation using the `SUM` function and a `GROUP BY` clause. The logic is simple, with no joins, subqueries, or complex calculations. The view references a single table, which further reduces its complexity.\n\n#### 3. Data Model Analysis\n- **Underlying Table**: The view depends on the `Invoice.InvoiceAccountBilling` table. This table contains detailed billing records, including fields for `AmountBilled` and `AmountPaid`.\n- **Columns**:\n - `InvoiceGroupContractID`: Serves as the primary grouping key, indicating that each record in the view corresponds to a unique contract.\n - `AmountBilled` and `AmountPaid`: Aggregated financial metrics, converted to a decimal format to ensure precision in financial calculations.\n\n#### 4. Business Context and Use Cases\n- **Business Context**: This view is useful for financial reporting and analysis, particularly in contexts where understanding the financial status of invoice group contracts is crucial. It provides a summary of billing and payment activities.\n- **Use Cases**:\n - Generating financial reports that summarize billing and payment activities by contract.\n - Supporting dashboards that track financial performance metrics.\n - Assisting in financial audits by providing aggregated data for verification.\n\n#### 5. Performance Considerations\n- **Efficiency**: The view is efficient due to its simplicity and reliance on a single table. The use of `SUM` and `GROUP BY` is optimized in SQL Server for performance.\n- **Indexing**: Performance can be further enhanced by ensuring that `InvoiceGroupContractID` is indexed in the `Invoice.InvoiceAccountBilling` table, as this will speed up the grouping operation.\n- **Scalability**: As the dataset grows, the performance should remain stable, provided that the underlying table is properly indexed and maintained.\n\n#### 6. Security and Access Control\n- **Access Control**: Ensure that only authorized users have access to this view, especially since it involves financial data. Implement role-based access control to restrict access based on user roles.\n- **Data Sensitivity**: Since the view deals with financial data, consider encrypting sensitive information at the database level and ensure compliance with relevant data protection regulations.\n\n#### 7. Potential Issues or Recommendations\n- **NULL Handling**: The use of `ISNULL` ensures that the view returns zero instead of NULL for `AmountBilled` and `AmountPaid`, which is good practice for financial data.\n- **Data Integrity**: Regularly verify the integrity of the data in `Invoice.InvoiceAccountBilling` to ensure accurate aggregation results.\n- **Documentation**: Maintain clear documentation for the view, including its purpose, structure, and any dependencies, to aid in future maintenance and updates.\n- **Optimization**: Periodically review the performance of the view, especially as data volume increases, and adjust indexing strategies as necessary to maintain optimal performance.",
      "complexity": "Low",
      "model_used": "gpt-4o-2024-08-06",
      "tokens_used": 1175,
      "api_response_id": "chatcmpl-C8ah6BoOrejUYKZGhgpYAammDbIpq"
    },
    "analysis_timestamp": "2025-08-25 19:15:24"
  },
  {
    "view_info": {
      "schema": "Invoice",
      "name": "vwInvoiceGroupContractAmountsFromBilling",
      "created": "2025-08-25 16:04:00.713000",
      "last_altered": "2025-08-25 16:04:00.713000",
      "check_option": "NO CHECK OPTION",
      "comment": "",
      "definition": "CREATE VIEW [Invoice].[vwInvoiceGroupContractAmountsFromBilling]\r\nAS\r\nSELECT InvoiceGroupContractID,CONVERT(DECIMAL(18, 2), ISNULL(SUM(AmountBilled), 0.00)) AS AmountBilled,CONVERT(DECIMAL(18, 2), ISNULL(SUM(AmountPaid), 0.00)) AS AmountPaid\r\nFROM Invoice.InvoiceAccountBilling\r\nWHERE InvoiceID NOT IN (SELECT InvoiceID\r\n FROM Invoice.InvoiceAccountBilling\r\n GROUP BY InvoiceID \r\n HAVING SUM(AmountPaidPriorFY) <> 0 AND SUM(AmountPaidCurrentFY) <> 0)\r\nGROUP BY InvoiceGroupContractID\r\nUNION\r\nSELECT a.InvoiceGroupContractID, b.AmountBilled, b.AmountPaid\r\nFROM (SELECT IGC.InvoiceID,BGC.GroupID,IGC.InvoiceGroupContractID,BGC.FiscalYear,CASE WHEN BGC.FiscalYear = Billing.UDF_GetFiscalYear(I.InvoiceBillingPeriod + '01') THEN 2 ELSE 1 END AS idx\r\n\tFROM Invoice.InvoiceGroupContract AS IGC\r\n INNER JOIN Billing.BillingGroupContract AS BGC ON IGC.BillingGroupContractID = BGC.BillingGroupContractID\r\n INNER JOIN Invoice.Invoice AS I ON I.InvoiceID = IGC.InvoiceID) AS a\r\n\tINNER JOIN (SELECT InvoiceID,GroupID,1 AS idx,SUM(AmountPaidPriorFY) AS AmountPaid,SUM(AmountBilled - CAST(AmountBilled * BillingPeriodDaysCurrentFY/IIF(BillingPeriodDays = 0, 1, BillingPeriodDays) AS DECIMAL(18,2))) AS AmountBilled\r\n FROM Invoice.InvoiceAccountBilling\r\n WHERE InvoiceID IN (SELECT InvoiceID\r\n FROM Invoice.InvoiceAccountBilling\r\n GROUP BY invoiceid \r\n HAVING SUM(AmountPaidPriorFY) <> 0 AND SUM(AmountPaidCurrentFY) <> 0)\r\n GROUP BY InvoiceID, GroupID\r\n UNION\r\n SELECT InvoiceID,GroupID,2 AS idx,SUM(AmountPaidCurrentFY) AS AmountPaid,SUM(CAST(AmountBilled * BillingPeriodDaysCurrentFY/IIF(BillingPeriodDays = 0, 1, BillingPeriodDays) AS DECIMAL(18,2))) AS AmountBilled\r\n FROM Invoice.InvoiceAccountBilling\r\n WHERE InvoiceID IN (SELECT InvoiceID\r\n FROM Invoice.InvoiceAccountBilling\r\n GROUP BY invoiceid \r\n HAVING SUM(AmountPaidPriorFY) <> 0 AND SUM(AmountPaidCurrentFY) <> 0)\r\n GROUP BY InvoiceID, GroupID) AS b ON a.InvoiceID = b.InvoiceID AND a.GroupID = b.GroupID AND a.idx = b.idx;\r\n",
      "is_replicated": false,
      "is_published": false
    },
    "columns": [
      {
        "name": "InvoiceGroupContractID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 1,
        "comment": ""
      },
      {
        "name": "AmountBilled",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 38,
        "scale": 2,
        "ordinal_position": 2,
        "comment": ""
      },
      {
        "name": "AmountPaid",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 38,
        "scale": 2,
        "ordinal_position": 3,
        "comment": ""
      }
    ],
    "dependencies": [
      {
        "referenced_schema": "Billing",
        "referenced_object": "BillingGroupContract",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Billing",
        "referenced_object": "UDF_GetFiscalYear",
        "referenced_type": "SQL_SCALAR_FUNCTION"
      },
      {
        "referenced_schema": "Invoice",
        "referenced_object": "Invoice",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Invoice",
        "referenced_object": "InvoiceAccountBilling",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Invoice",
        "referenced_object": "InvoiceGroupContract",
        "referenced_type": "USER_TABLE"
      }
    ],
    "analysis": {
      "view_name": "vwInvoiceGroupContractAmountsFromBilling",
      "explanation": "#### 1. Overview\nThe view `Invoice.vwInvoiceGroupContractAmountsFromBilling` is designed to aggregate billing and payment data related to invoice group contracts. It consolidates information from multiple tables to provide a summarized view of amounts billed and paid, segmented by `InvoiceGroupContractID`. The view uses a combination of aggregation, conditional logic, and joins to achieve its purpose, which is to facilitate financial reporting and analysis of billing data across fiscal years.\n\n#### 2. Complexity Level: Medium\nThe complexity of this view is considered medium due to the following factors:\n- It involves multiple tables and a scalar function, indicating a moderate level of dependency.\n- The SQL logic includes aggregation, conditional logic, and a union operation, which adds to the complexity.\n- The view handles fiscal year calculations and conditional aggregations, which require a good understanding of the underlying data and business rules.\n\n#### 3. Data Model Analysis\nThe view depends on the following tables and function:\n- **Billing.BillingGroupContract (USER_TABLE):** contains details about billing contracts, including fiscal year information.\n- **Billing.UDF_GetFiscalYear (SQL_SCALAR_FUNCTION):** Used to determine the fiscal year based on a billing period.\n- **Invoice.Invoice (USER_TABLE):** Contains invoice details, including billing periods.\n- **Invoice.InvoiceAccountBilling (USER_TABLE):** store detailed billing and payment information, including amounts billed and paid for different fiscal years.\n- **Invoice.InvoiceGroupContract (USER_TABLE):** maps invoices to group contracts, providing a link between invoices and billing contracts.\n\nThe view aggregates data from `InvoiceAccountBilling` and combines it with contract information from `InvoiceGroupContract` and `BillingGroupContract`, using fiscal year logic to segment the data.\n\n#### 4. Business Context and Use Cases\nThis view is used for financial reporting and analysis, specifically to:\n- Track and report on the amounts billed and paid for each invoice group contract.\n- Provide insights into billing performance across fiscal years.\n- Support financial audits and compliance by offering a consolidated view of billing data.\n- Assist in budgeting and forecasting by analyzing historical billing and payment trends.\n\n#### 5. Performance Considerations\n- **Aggregation and Joins:** The use of aggregation functions and joins can impact performance, especially if the underlying tables are large. Indexing on key columns like `InvoiceID`, `InvoiceGroupContractID`, and `GroupID` can help improve performance.\n- **Union Operation:** The union operation combines results from two queries, which can be resource-intensive. Ensuring that both queries are optimized is crucial.\n- **Scalar Function:** The use of `Billing.UDF_GetFiscalYear` in the query can affect performance, especially if it is called for each row in a large dataset. Consider optimizing the function or minimizing its use within the query.\n\n#### 6. Security and Access Control\n- **View Permissions:** Ensure that only authorized users have access to this view, as it contains sensitive financial data.\n- **Underlying Tables:** Access to the underlying tables should be restricted to prevent unauthorized data manipulation.\n- **Data Masking:** Consider implementing data masking or encryption for sensitive columns if required by compliance standards.\n\n#### 7. Potential Issues or Recommendations\n- **Data Type Consistency:** The view converts `AmountBilled` and `AmountPaid` to `DECIMAL(18, 2)`, which lead to precision loss if the original data type is `DECIMAL(38, 2)`. Ensure that this conversion aligns with business requirements.\n- **Fiscal Year Logic:** The fiscal year determination logic relies on a scalar function. Review the function for efficiency and accuracy, especially if fiscal year definitions change.\n- **Indexing:** Evaluate and implement appropriate indexing strategies on the underlying tables to improve query performance.\n- **Error Handling:** Consider adding error handling or validation logic to manage potential data anomalies, such as division by zero in `BillingPeriodDays`.\n- **Documentation:** Maintain comprehensive documentation of the view's logic and dependencies to aid future maintenance and troubleshooting efforts.",
      "complexity": "Medium",
      "model_used": "gpt-4o-2024-08-06",
      "tokens_used": 1862,
      "api_response_id": "chatcmpl-C8ahJt1IEWBGDa71hqxdjwdQuXMNB"
    },
    "analysis_timestamp": "2025-08-25 19:15:38"
  },
  {
    "view_info": {
      "schema": "Invoice",
      "name": "vwInvoiceGroupContractLineAmountsFromBilling",
      "created": "2025-08-25 16:04:00.773000",
      "last_altered": "2025-08-25 16:04:00.773000",
      "check_option": "NO CHECK OPTION",
      "comment": "",
      "definition": "CREATE VIEW [Invoice].[vwInvoiceGroupContractLineAmountsFromBilling]\r\nAS\r\nWITH splitFYAccountBilling AS (SELECT A.InvoiceID,A.GroupID,A.ContractID,ISNULL(D.BudgetCode, '') AS BudgetCode,CONVERT(DECIMAL(18, 2), ISNULL(SUM(A.AmountPaidPriorFY), 0.00)) AS AmountPaidPriorFY,CONVERT(DECIMAL(18, 2), ISNULL(SUM(A.AmountPaidCurrentFY), 0.00)) AS AmountPaidCurrentFY,Billing.UDF_GetFiscalYear(E.CreatedDate) AS CurrentFY,Billing.UDF_GetFiscalYear(E.CreatedDate) - 1 AS PriorFY,SUM(A.AmountBilled - CAST(A.AmountBilled * A.BillingPeriodDaysCurrentFY /IIF(A.BillingPeriodDays = 0, 1, A.BillingPeriodDays) AS DECIMAL(18,2))) AS priorFyAmountBilled,SUM(CAST(A.AmountBilled * A.BillingPeriodDaysCurrentFY /IIF(A.BillingPeriodDays = 0, 1, A.BillingPeriodDays) AS DECIMAL(18,2))) AS currentFyAmountBilled\r\n\tFROM Invoice.InvoiceAccountBilling AS A\r\n INNER JOIN Invoice.Invoice AS E ON A.InvoiceID = E.InvoiceID\r\n LEFT JOIN Billing.EC3_Billing_Account AS B ON A.AccountID = B.AccountSeqid\r\n LEFT JOIN Billing.EC3_Billing_AgencyFundingAssignments AS C ON B.AgencyAccount = C.AgencyDivisionSeqid\r\n LEFT JOIN Billing.EC3_Billing_AgencyFunding AS D ON C.AgencyFundingSeqid = D.AgencyFundingSeqid\r\n\tWHERE A.InvoiceID IN (SELECT InvoiceID\r\n FROM Invoice.InvoiceAccountBilling\r\n GROUP BY InvoiceID\r\n HAVING SUM(AmountPaidPriorFY) <> 0 AND SUM(AmountPaidCurrentFY) <> 0)\r\n\tGROUP BY A.InvoiceID, A.GroupID, A.ContractID, E.CreatedDate, ISNULL(D.BudgetCode, ''))\r\nSELECT InvoiceID,GroupID,BudgetCode,fiscalYear,SUM(AmountBilled) AS AmountBilled,SUM(AmountPaid) AS AmountPaid\r\nFROM (SELECT InvoiceID,GroupID,BudgetCode,priorFY AS fiscalYear,priorFYAmountBilled AS AmountBilled,AmountPaidPriorFY AS AmountPaid\r\n\tFROM splitFYAccountBilling\r\n\tUNION\r\n\tSELECT InvoiceID, GroupID, BudgetCode, currentFY AS fiscalYear, currentFYAmountBilled AS AmountBilled, AmountPaidCurrentFY AS AmountPaid\r\n\tFROM splitFYAccountBilling) AS a\r\nGROUP BY InvoiceID, GroupID, BudgetCode, fiscalYear\r\nUNION\r\nSELECT A.InvoiceID,A.GroupID,ISNULL(D.BudgetCode, '') AS BudgetCode,F.FiscalYear,CONVERT(DECIMAL(18, 2), ISNULL(SUM(A.AmountBilled), 0.00)) AS AmountBilled,CONVERT(DECIMAL(18, 2), ISNULL(SUM(A.AmountPaid), 0.00)) AS AmountPaid\r\nFROM Invoice.InvoiceAccountBilling AS A\r\n\tINNER JOIN Invoice.InvoiceGroupContract AS E ON A.InvoiceGroupContractID = E.InvoiceGroupContractID\r\n\tINNER JOIN Billing.BillingGroupContract AS F ON E.BillingGroupContractID = F.BillingGroupContractID\r\n LEFT JOIN Billing.EC3_Billing_Account AS B ON A.AccountID = B.AccountSeqid\r\n LEFT JOIN Billing.EC3_Billing_AgencyFundingAssignments AS C ON B.AgencyAccount = C.AgencyDivisionSeqid\r\n LEFT JOIN Billing.EC3_Billing_AgencyFunding AS D ON C.AgencyFundingSeqid = D.AgencyFundingSeqid\r\nWHERE A.InvoiceID NOT IN (SELECT InvoiceID\r\n\tFROM Invoice.InvoiceAccountBilling\r\n\tGROUP BY InvoiceID \r\n\tHAVING SUM(AmountPaidPriorFY) <> 0 AND SUM(AmountPaidCurrentFY) <> 0)\r\nGROUP BY A.InvoiceID, A.GroupID, F.FiscalYear, ISNULL(D.BudgetCode, '');\r\n",
      "is_replicated": false,
      "is_published": false
    },
    "columns": [
      {
        "name": "InvoiceID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 1,
        "comment": ""
      },
      {
        "name": "GroupID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 2,
        "comment": ""
      },
      {
        "name": "BudgetCode",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 3,
        "comment": ""
      },
      {
        "name": "fiscalYear",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 4,
        "comment": ""
      },
      {
        "name": "AmountBilled",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 38,
        "scale": 2,
        "ordinal_position": 5,
        "comment": ""
      },
      {
        "name": "AmountPaid",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 38,
        "scale": 2,
        "ordinal_position": 6,
        "comment": ""
      }
    ],
    "dependencies": [
      {
        "referenced_schema": "Billing",
        "referenced_object": "BillingGroupContract",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Billing",
        "referenced_object": "EC3_Billing_Account",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Billing",
        "referenced_object": "EC3_Billing_AgencyFunding",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Billing",
        "referenced_object": "EC3_Billing_AgencyFundingAssignments",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Billing",
        "referenced_object": "UDF_GetFiscalYear",
        "referenced_type": "SQL_SCALAR_FUNCTION"
      },
      {
        "referenced_schema": "Invoice",
        "referenced_object": "Invoice",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Invoice",
        "referenced_object": "InvoiceAccountBilling",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Invoice",
        "referenced_object": "InvoiceGroupContract",
        "referenced_type": "USER_TABLE"
      }
    ],
    "analysis": {
      "view_name": "vwInvoiceGroupContractLineAmountsFromBilling",
      "explanation": "#### 1. Overview\n\nThe view `Invoice.vwInvoiceGroupContractLineAmountsFromBilling` is designed to aggregate and present financial data related to invoices, specifically focusing on amounts billed and paid across different fiscal years. It combines data from multiple tables related to billing and invoicing, and it uses a common table expression (CTE) to split and calculate amounts for prior and current fiscal years. The view also includes a union operation to handle cases where invoices have not been paid in both fiscal years.\n\n#### 2. Complexity Level: Medium\n\nThe complexity of this view is considered medium due to the following factors:\n- It involves multiple joins across several tables, which increases the complexity of understanding the data flow.\n- The use of a CTE to preprocess data adds a layer of complexity, especially with fiscal year calculations.\n- The union operation to handle different invoice scenarios requires careful consideration of logic to ensure data integrity.\n- Dependencies on a scalar function for fiscal year calculation add to the complexity.\n\n#### 3. Data Model Analysis\n\n**Underlying Tables/Views:**\n- `Billing.BillingGroupContract`: contains contract details related to billing groups.\n- `Billing.EC3_Billing_Account`: Contains account information for billing purposes.\n- `Billing.EC3_Billing_AgencyFunding`: Stores funding details for agencies.\n- `Billing.EC3_Billing_AgencyFundingAssignments`: Manages assignments of funding to agencies.\n- `Billing.UDF_GetFiscalYear`: A scalar function used to determine the fiscal year based on a date.\n- `Invoice.Invoice`: Contains invoice records.\n- `Invoice.InvoiceAccountBilling`: Manages billing details associated with invoices.\n- `Invoice.InvoiceGroupContract`: Links invoices to group contracts.\n\nThe view aggregates data from these tables to provide a comprehensive view of billing and payment amounts, segmented by fiscal year and budget code.\n\n#### 4. Business Context and Use Cases\n\nThis view is used for financial reporting and analysis, providing insights into:\n- Total amounts billed and paid for each invoice, grouped by fiscal year and budget code.\n- Financial performance tracking across fiscal years.\n- Budget management and auditing, ensuring that payments align with billed amounts.\n- Supporting decision-making processes related to contract management and financial planning.\n\n#### 5. Performance Considerations\n\n- **Joins and Aggregations**: The view involves multiple joins and aggregations, which can be resource-intensive, especially with large datasets.\n- **Scalar Function**: The use of `Billing.UDF_GetFiscalYear` in the CTE can impact performance if not optimized, as scalar functions can be called for each row processed.\n- **Union Operation**: The union operation can be costly in terms of performance, as it requires processing and combining two datasets.\n- **Indexes**: Ensuring that appropriate indexes exist on join and filter columns can help mitigate performance issues.\n\n#### 6. Security and Access Control\n\n- **Data Sensitivity**: The view handles financial data, which be sensitive. Proper access controls should be in place to ensure that only authorized users can access this view.\n- **Role-Based Access**: Implement role-based access control to restrict view access based on user roles and responsibilities.\n- **Auditing**: Consider auditing access to this view to track who is accessing financial data and when.\n\n#### 7. Potential Issues or Recommendations\n\n- **Function Optimization**: Review and optimize the `Billing.UDF_GetFiscalYear` function to ensure it performs efficiently, especially if it is called frequently.\n- **Indexing Strategy**: Evaluate and implement an indexing strategy to improve join and aggregation performance.\n- **Data Validation**: Ensure that the logic for splitting fiscal year amounts is accurate and aligns with business rules, particularly the handling of zero billing period days.\n- **Documentation**: Provide detailed documentation for the view, including its purpose, logic, and any assumptions made, to aid future maintenance and understanding by other team members.\n- **Testing**: Conduct thorough testing to ensure that the view returns accurate and expected results across different scenarios and data volumes.",
      "complexity": "Medium",
      "model_used": "gpt-4o-2024-08-06",
      "tokens_used": 2236,
      "api_response_id": "chatcmpl-C8ahYAE7wijjF8WoE3MuOoICEfTYi"
    },
    "analysis_timestamp": "2025-08-25 19:16:05"
  },
  {
    "view_info": {
      "schema": "Invoice",
      "name": "vwInvoiceGroupContractLines",
      "created": "2025-08-25 16:04:00.783000",
      "last_altered": "2025-08-25 16:04:00.783000",
      "check_option": "NO CHECK OPTION",
      "comment": "",
      "definition": "CREATE VIEW [Invoice].[vwInvoiceGroupContractLines]\r\nAS\r\nSELECT z.InvoiceGroupContractID,z.InvoiceID,a.InvoiceNumber,y.GroupID,x.GroupName,x.IsSummaryBilling,x.BillingType,y.FiscalYear,w.ContractNumber,v.ActualAmount,Billing.UDF_GetContractLineAmountPaid(v.ContractLineID, ISNULL(a.InvoiceDate, GETDATE())) AS CloseAmount,v.ActualAmount - Billing.UDF_GetContractLineAmountPaid(v.ContractLineID, ISNULL(a.InvoiceDate, GETDATE())) AS OpenAmount,v.ActualAmount - Billing.UDF_GetContractLineAmountPaid(v.ContractLineID, ISNULL(a.InvoiceDate, GETDATE())) AS AvailableAmount,z.CreatedDate,z.CreatedBy,z.ModifiedDate,z.ModifiedBy,w.ContractID,v.CommodityLine,v.AccountingLine,v.BudgetCode,v.ObjectCode,ISNULL(Billing.UDF_GetFundingType(v.BudgetCode),'') AS FundingSourceDescription,v.ContractLineID\r\nFROM Invoice.Invoice AS a \r\n\tINNER JOIN Invoice.InvoiceGroupContract AS z ON a.InvoiceID=z.InvoiceID\r\n INNER JOIN Billing.BillingGroupContract AS y ON z.BillingGroupContractID = y.BillingGroupContractID\r\n INNER JOIN Billing.vwBillingGroups AS x ON y.GroupID = x.GroupID\r\n INNER JOIN Billing.[Contract] AS w ON y.ContractID = w.ContractID\r\n INNER JOIN Billing.ContractLine AS v ON w.ContractID = v.ContractID AND y.FiscalYear=v.FiscalYear;\r\n",
      "is_replicated": false,
      "is_published": false
    },
    "columns": [
      {
        "name": "InvoiceGroupContractID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 1,
        "comment": ""
      },
      {
        "name": "InvoiceID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 2,
        "comment": ""
      },
      {
        "name": "InvoiceNumber",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 25,
        "precision": null,
        "scale": null,
        "ordinal_position": 3,
        "comment": ""
      },
      {
        "name": "GroupID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 4,
        "comment": ""
      },
      {
        "name": "GroupName",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 5,
        "comment": ""
      },
      {
        "name": "IsSummaryBilling",
        "data_type": "bit",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 6,
        "comment": ""
      },
      {
        "name": "BillingType",
        "data_type": "char",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 1,
        "precision": null,
        "scale": null,
        "ordinal_position": 7,
        "comment": ""
      },
      {
        "name": "FiscalYear",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 8,
        "comment": ""
      },
      {
        "name": "ContractNumber",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 25,
        "precision": null,
        "scale": null,
        "ordinal_position": 9,
        "comment": ""
      },
      {
        "name": "ActualAmount",
        "data_type": "decimal",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 10,
        "comment": ""
      },
      {
        "name": "CloseAmount",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 11,
        "comment": ""
      },
      {
        "name": "OpenAmount",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 19,
        "scale": 2,
        "ordinal_position": 12,
        "comment": ""
      },
      {
        "name": "AvailableAmount",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 19,
        "scale": 2,
        "ordinal_position": 13,
        "comment": ""
      },
      {
        "name": "CreatedDate",
        "data_type": "datetime",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 14,
        "comment": ""
      },
      {
        "name": "CreatedBy",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 15,
        "comment": ""
      },
      {
        "name": "ModifiedDate",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 16,
        "comment": ""
      },
      {
        "name": "ModifiedBy",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 17,
        "comment": ""
      },
      {
        "name": "ContractID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 18,
        "comment": ""
      },
      {
        "name": "CommodityLine",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 19,
        "comment": ""
      },
      {
        "name": "AccountingLine",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 20,
        "comment": ""
      },
      {
        "name": "BudgetCode",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 21,
        "comment": ""
      },
      {
        "name": "ObjectCode",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 3,
        "precision": null,
        "scale": null,
        "ordinal_position": 22,
        "comment": ""
      },
      {
        "name": "FundingSourceDescription",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": -1,
        "precision": null,
        "scale": null,
        "ordinal_position": 23,
        "comment": ""
      },
      {
        "name": "ContractLineID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 24,
        "comment": ""
      }
    ],
    "dependencies": [
      {
        "referenced_schema": "Billing",
        "referenced_object": "BillingGroupContract",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Billing",
        "referenced_object": "Contract",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Billing",
        "referenced_object": "ContractLine",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Billing",
        "referenced_object": "UDF_GetContractLineAmountPaid",
        "referenced_type": "SQL_SCALAR_FUNCTION"
      },
      {
        "referenced_schema": "Billing",
        "referenced_object": "UDF_GetFundingType",
        "referenced_type": "SQL_SCALAR_FUNCTION"
      },
      {
        "referenced_schema": "Billing",
        "referenced_object": "vwBillingGroups",
        "referenced_type": "VIEW"
      },
      {
        "referenced_schema": "Invoice",
        "referenced_object": "Invoice",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Invoice",
        "referenced_object": "InvoiceGroupContract",
        "referenced_type": "USER_TABLE"
      }
    ],
    "analysis": {
      "view_name": "vwInvoiceGroupContractLines",
      "explanation": "#### 1. Overview\nThe view `Invoice.vwInvoiceGroupContractLines` is designed to aggregate and present detailed information about invoice group contract lines. It combines data from multiple tables and views related to billing, contracts, and invoices. The view provides a comprehensive dataset that includes invoice details, group and contract information, financial amounts, and metadata about creation and modification. It also utilizes scalar functions to calculate dynamic values such as `CloseAmount`, `OpenAmount`, and `AvailableAmount`.\n\n#### 2. Complexity Level: Medium\nThe complexity of this view is considered medium due to the following factors:\n- It involves multiple joins across several tables and a view, which increases the complexity of the SQL logic.\n- The use of scalar functions for calculating financial amounts adds an additional layer of complexity.\n- The view does not include subqueries or complex aggregations, which keeps the complexity from being high.\n\n#### 3. Data Model Analysis\n- **Tables and Views**: The view depends on several tables and a view:\n - `Invoice.Invoice`: Provides invoice details.\n - `Invoice.InvoiceGroupContract`: Links invoices to billing group contracts.\n - `Billing.BillingGroupContract`: Contains information about billing group contracts.\n - `Billing.Contract`: Stores contract details.\n - `Billing.ContractLine`: Contains line items for contracts.\n - `Billing.vwBillingGroups`: A view that provides additional group information.\n- **Scalar Functions**:\n - `Billing.UDF_GetContractLineAmountPaid`: Calculates the amount paid for a contract line.\n - `Billing.UDF_GetFundingType`: Retrieves the funding type based on the budget code.\n\n#### 4. Business Context and Use Cases\n- **Purpose**: This view is used for reporting and analysis of invoice group contract lines, providing insights into financial transactions and contract management.\n- **Use Cases**:\n - Generating reports for financial audits and compliance.\n - Analyzing billing and contract performance.\n - Supporting decision-making in contract negotiations and renewals.\n - Facilitating budget and financial planning by providing detailed contract line data.\n\n#### 5. Performance Considerations\n- **Joins**: The view involves multiple joins, which can impact performance, especially if the underlying tables are large.\n- **Scalar Functions**: The use of scalar functions in the SELECT clause can lead to performance bottlenecks, as they are executed row-by-row.\n- **Indexes**: Ensuring that the joined columns are indexed can help improve performance.\n- **Data Volume**: The performance may degrade with large datasets, so consider partitioning or optimizing the underlying tables if necessary.\n\n#### 6. Security and Access Control\n- **Access Control**: Ensure that only authorized users have access to this view, as it contains sensitive financial information.\n- **Data Masking**: Consider implementing data masking for sensitive columns if the view is accessed by users who do not require full data visibility.\n- **Role-Based Access**: Implement role-based access control to restrict access based on user roles and responsibilities.\n\n#### 7. Potential Issues or Recommendations\n- **Function Optimization**: Review and optimize the scalar functions used in the view to improve performance.\n- **Indexing Strategy**: Evaluate the indexing strategy on the underlying tables to ensure efficient query execution.\n- **Data Integrity**: Ensure that the data integrity constraints are enforced in the underlying tables to maintain accurate and reliable data.\n- **View Maintenance**: Regularly review and update the view definition to accommodate changes in business requirements or data model updates.\n- **Documentation**: Maintain comprehensive documentation for the view, including its purpose, dependencies, and any business rules applied.",
      "complexity": "Medium",
      "model_used": "gpt-4o-2024-08-06",
      "tokens_used": 1783,
      "api_response_id": "chatcmpl-C8ahzyGsrBJAdUdu6XsfymLev3mhx"
    },
    "analysis_timestamp": "2025-08-25 19:16:18"
  },
  {
    "view_info": {
      "schema": "Invoice",
      "name": "vwInvoiceGroupContracts",
      "created": "2025-08-25 16:04:00.880000",
      "last_altered": "2025-08-25 16:04:00.880000",
      "check_option": "NO CHECK OPTION",
      "comment": "",
      "definition": "CREATE VIEW [Invoice].[vwInvoiceGroupContracts]\r\nAS\r\nWITH tmpTbl AS(SELECT IGC.InvoiceGroupContractID,IGC.InvoiceID,I.InvoiceNumber,IGC.BillingGroupContractID,BGC.FiscalYear,BGC.GroupID,BG.GroupName,BG.IsSummaryBilling,BG.BillingType,BGC.ContractID,C.ContractNumber,C.ActualAmount,Billing.UDF_GetContractAmountPaid(BGC.ContractID, GETDATE()) AS CloseAmount,CONVERT(DECIMAL(18, 2), ISNULL(IGCA.AmountBilled, 0.00)) AS AmountBilled,CONVERT(DECIMAL(18, 2), ISNULL(ICL.AmountPaid, 0.00)) AS AmountPaid,IGC.CreatedDate,IGC.CreatedBy,IGC.ModifiedDate,IGC.ModifiedBy\r\n\tFROM Invoice.InvoiceGroupContract AS IGC\r\n INNER JOIN Invoice.Invoice I ON I.InvoiceID = IGC.InvoiceID\r\n INNER JOIN Billing.BillingGroupContract BGC ON BGC.BillingGroupContractID = IGC.BillingGroupContractID\r\n INNER JOIN Billing.vwBillingGroups BG ON BG.GroupID = BGC.GroupID\r\n INNER JOIN Billing.[Contract] C ON C.ContractID = BGC.ContractID\r\n LEFT JOIN Invoice.vwInvoiceGroupContractAmountsFromBilling AS IGCA ON IGCA.InvoiceGroupContractID = IGC.InvoiceGroupContractID\r\n LEFT JOIN (SELECT invoiceid, contractid, FiscalYear, SUM(AmountPaid) AS AmountPaid\r\n FROM invoice.InvoiceContractLine\r\n GROUP BY invoiceid, contractid, FiscalYear) AS ICL ON I.InvoiceID = ICL.InvoiceID AND C.ContractID = ICL.ContractID AND BGC.FiscalYear = ICL.FiscalYear\r\n)\r\nSELECT tmpTbl.InvoiceGroupContractID,tmpTbl.InvoiceID,tmpTbl.InvoiceNumber,tmpTbl.BillingGroupContractID,tmpTbl.FiscalYear,tmpTbl.GroupID,tmpTbl.GroupName,tmpTbl.IsSummaryBilling,tmpTbl.BillingType,tmpTbl.ContractID,tmpTbl.ContractNumber,tmpTbl.ActualAmount,tmpTbl.CloseAmount,tmpTbl.ActualAmount - tmpTbl.CloseAmount AS OpenAmount,tmpTbl.ActualAmount - tmpTbl.CloseAmount AS AvailableAmount,tmpTbl.AmountBilled,tmpTbl.AmountPaid,tmpTbl.CreatedDate,tmpTbl.CreatedBy,tmpTbl.ModifiedDate,tmpTbl.ModifiedBy\r\nFROM tmpTbl;\r\n",
      "is_replicated": false,
      "is_published": false
    },
    "columns": [
      {
        "name": "InvoiceGroupContractID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 1,
        "comment": ""
      },
      {
        "name": "InvoiceID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 2,
        "comment": ""
      },
      {
        "name": "InvoiceNumber",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 25,
        "precision": null,
        "scale": null,
        "ordinal_position": 3,
        "comment": ""
      },
      {
        "name": "BillingGroupContractID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 4,
        "comment": ""
      },
      {
        "name": "FiscalYear",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 4,
        "precision": null,
        "scale": null,
        "ordinal_position": 5,
        "comment": ""
      },
      {
        "name": "GroupID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 6,
        "comment": ""
      },
      {
        "name": "GroupName",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 7,
        "comment": ""
      },
      {
        "name": "IsSummaryBilling",
        "data_type": "bit",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 8,
        "comment": ""
      },
      {
        "name": "BillingType",
        "data_type": "char",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 1,
        "precision": null,
        "scale": null,
        "ordinal_position": 9,
        "comment": ""
      },
      {
        "name": "ContractID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 10,
        "comment": ""
      },
      {
        "name": "ContractNumber",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 25,
        "precision": null,
        "scale": null,
        "ordinal_position": 11,
        "comment": ""
      },
      {
        "name": "ActualAmount",
        "data_type": "decimal",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 12,
        "comment": ""
      },
      {
        "name": "CloseAmount",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 13,
        "comment": ""
      },
      {
        "name": "OpenAmount",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 19,
        "scale": 2,
        "ordinal_position": 14,
        "comment": ""
      },
      {
        "name": "AvailableAmount",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 19,
        "scale": 2,
        "ordinal_position": 15,
        "comment": ""
      },
      {
        "name": "AmountBilled",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 16,
        "comment": ""
      },
      {
        "name": "AmountPaid",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 17,
        "comment": ""
      },
      {
        "name": "CreatedDate",
        "data_type": "datetime",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 18,
        "comment": ""
      },
      {
        "name": "CreatedBy",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 19,
        "comment": ""
      },
      {
        "name": "ModifiedDate",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 20,
        "comment": ""
      },
      {
        "name": "ModifiedBy",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 21,
        "comment": ""
      }
    ],
    "dependencies": [
      {
        "referenced_schema": "Billing",
        "referenced_object": "BillingGroupContract",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Billing",
        "referenced_object": "Contract",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Billing",
        "referenced_object": "UDF_GetContractAmountPaid",
        "referenced_type": "SQL_SCALAR_FUNCTION"
      },
      {
        "referenced_schema": "Billing",
        "referenced_object": "vwBillingGroups",
        "referenced_type": "VIEW"
      },
      {
        "referenced_schema": "Invoice",
        "referenced_object": "Invoice",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Invoice",
        "referenced_object": "InvoiceContractLine",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Invoice",
        "referenced_object": "InvoiceGroupContract",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Invoice",
        "referenced_object": "vwInvoiceGroupContractAmountsFromBilling",
        "referenced_type": "VIEW"
      }
    ],
    "analysis": {
      "view_name": "vwInvoiceGroupContracts",
      "explanation": "#### 1. Overview\nThe view `Invoice.vwInvoiceGroupContracts` is designed to aggregate and present data related to invoice group contracts. It combines information from multiple tables and views to provide a comprehensive view of invoice details, billing group contracts, and associated financial metrics. The view includes columns for invoice identification, contract details, fiscal information, and financial amounts such as actual, billed, paid, and calculated amounts. It leverages a common table expression (CTE) to organize and compute these details before selecting the final set of columns.\n\n#### 2. Complexity Level: Medium\nThe complexity of this view is considered medium due to the following factors:\n- **Structure**: The view uses a CTE to manage intermediate calculations and joins, which adds a layer of complexity.\n- **Dependencies**: It relies on multiple tables and views, including a scalar function, which increases the complexity of understanding and maintaining the view.\n- **SQL Logic**: The use of joins, subqueries, and function calls requires a moderate understanding of SQL to comprehend fully.\n\n#### 3. Data Model Analysis\n- **Primary Tables/Views**:\n - `Invoice.InvoiceGroupContract`: Central table for invoice group contract details.\n - `Invoice.Invoice`: Provides invoice-specific information.\n - `Billing.BillingGroupContract`: Contains billing group contract details.\n - `Billing.vwBillingGroups`: Supplies group-related metadata.\n - `Billing.Contract`: Offers contract-specific data.\n - `Invoice.vwInvoiceGroupContractAmountsFromBilling`: Provides additional billing amounts.\n - `Invoice.InvoiceContractLine`: Used for aggregating paid amounts.\n\n- **Function**:\n - `Billing.UDF_GetContractAmountPaid`: Computes the close amount for contracts.\n\nThe view effectively integrates these data sources to provide a unified dataset that reflects the current state of invoice group contracts.\n\n#### 4. Business Context and Use Cases\nThis view is used in financial reporting and analysis contexts where stakeholders need to understand the status and details of invoice group contracts. Potential use cases include:\n- **Financial Reporting**: Generating reports on invoicing and contract performance.\n- **Contract Management**: Monitoring contract fulfillment and financial metrics.\n- **Billing Analysis**: Analyzing billed versus paid amounts to assess financial health.\n\n#### 5. Performance Considerations\n- **Joins and Subqueries**: The view involves multiple joins and a subquery, which could impact performance, especially with large datasets.\n- **Function Call**: The scalar function `Billing.UDF_GetContractAmountPaid` is called for each row, which could be a performance bottleneck if not optimized.\n- **Indexes**: Ensuring that the underlying tables have appropriate indexes on join columns can help mitigate performance issues.\n\n#### 6. Security and Access Control\n- **View Permissions**: Access to this view should be controlled to ensure that only authorized users can view sensitive financial data.\n- **Underlying Tables/Views**: Permissions on the underlying tables and views should be consistent with the view's access control to prevent unauthorized data exposure.\n- **Function Security**: Ensure that the function `Billing.UDF_GetContractAmountPaid` is secure and does not expose sensitive logic or data.\n\n#### 7. Potential Issues or Recommendations\n- **Redundant Calculations**: The `OpenAmount` and `AvailableAmount` columns are calculated the same way, which be redundant unless they serve different business purposes.\n- **Function Optimization**: Review and optimize the `Billing.UDF_GetContractAmountPaid` function to ensure it performs efficiently, especially if it involves complex logic or data retrieval.\n- **Indexing Strategy**: Evaluate and implement an indexing strategy for the involved tables to improve join performance.\n- **Data Type Consistency**: Ensure that data types, especially for financial amounts, are consistent across tables to avoid conversion issues.\n- **Documentation**: Maintain comprehensive documentation for the view, including its purpose, dependencies, and any business logic encapsulated within it, to aid future maintenance and understanding.",
      "complexity": "Medium",
      "model_used": "gpt-4o-2024-08-06",
      "tokens_used": 2049,
      "api_response_id": "chatcmpl-C8aiBCjgTOkIQtXj4F9xhNB8ICozz"
    },
    "analysis_timestamp": "2025-08-25 19:16:33"
  },
  {
    "view_info": {
      "schema": "Invoice",
      "name": "vwInvoiceHasChargebacks",
      "created": "2025-08-25 16:04:00.887000",
      "last_altered": "2025-08-25 16:04:00.887000",
      "check_option": "NO CHECK OPTION",
      "comment": "",
      "definition": "CREATE VIEW [Invoice].[vwInvoiceHasChargebacks]\r\nAS\r\nWITH InvoiceBillingPayment AS (SELECT InvoiceID,SUM(ISNULL(AmountPaidPriorFY,0)) AS TotalChargeback,SUM(ISNULL(AmountPaid,0)) AS TotalPayment\r\n\tFROM Invoice.InvoiceAccountBilling\r\n\tGROUP BY InvoiceID),InvoiceGroupContract AS (SELECT InvoiceID,BillingType,STRING_AGG(ContractNumber, ',') AS ContractNumber\r\n\tFROM Invoice.vwInvoiceGroupContracts\r\n\tGROUP BY InvoiceID, BillingType)\r\n\r\nSELECT a.InvoiceID,a.InvoiceNumber,a.InvoiceBillingPeriod,d.BillingType,a.StatusID,e.StatusDescription,a.ProviderID,c.ProviderName,b.TotalChargeback,b.TotalPayment,CAST(d.ContractNumber AS VARCHAR(255)) AS ContractNumber\r\nFROM Invoice.Invoice AS a\r\n\tINNER JOIN InvoiceBillingPayment AS b ON a.InvoiceID = b.InvoiceID\r\n\tINNER JOIN Billing.vwProviders AS c ON a.ProviderID = c.ProviderID\r\n\tINNER JOIN InvoiceGroupContract AS d ON a.InvoiceID = d.InvoiceID\r\n\tINNER JOIN Invoice.InvoiceStatus AS e ON a.StatusID = e.StatusID\r\nWHERE a.StatusID = 8\r\n\tAND a.Active = 1;\r\n",
      "is_replicated": false,
      "is_published": false
    },
    "columns": [
      {
        "name": "InvoiceID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 1,
        "comment": ""
      },
      {
        "name": "InvoiceNumber",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 25,
        "precision": null,
        "scale": null,
        "ordinal_position": 2,
        "comment": ""
      },
      {
        "name": "InvoiceBillingPeriod",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 6,
        "precision": null,
        "scale": null,
        "ordinal_position": 3,
        "comment": ""
      },
      {
        "name": "BillingType",
        "data_type": "char",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 1,
        "precision": null,
        "scale": null,
        "ordinal_position": 4,
        "comment": ""
      },
      {
        "name": "StatusID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 5,
        "comment": ""
      },
      {
        "name": "StatusDescription",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 50,
        "precision": null,
        "scale": null,
        "ordinal_position": 6,
        "comment": ""
      },
      {
        "name": "ProviderID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 7,
        "comment": ""
      },
      {
        "name": "ProviderName",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 8,
        "comment": ""
      },
      {
        "name": "TotalChargeback",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 38,
        "scale": 2,
        "ordinal_position": 9,
        "comment": ""
      },
      {
        "name": "TotalPayment",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 38,
        "scale": 2,
        "ordinal_position": 10,
        "comment": ""
      },
      {
        "name": "ContractNumber",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 255,
        "precision": null,
        "scale": null,
        "ordinal_position": 11,
        "comment": ""
      }
    ],
    "dependencies": [
      {
        "referenced_schema": "Billing",
        "referenced_object": "vwProviders",
        "referenced_type": "VIEW"
      },
      {
        "referenced_schema": "Invoice",
        "referenced_object": "Invoice",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Invoice",
        "referenced_object": "InvoiceAccountBilling",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Invoice",
        "referenced_object": "InvoiceStatus",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Invoice",
        "referenced_object": "vwInvoiceGroupContracts",
        "referenced_type": "VIEW"
      }
    ],
    "analysis": {
      "view_name": "vwInvoiceHasChargebacks",
      "explanation": "#### 1. Overview\nThe view `Invoice.vwInvoiceHasChargebacks` is designed to aggregate and present invoice data specifically for invoices that have associated chargebacks. It combines information from multiple tables and views to provide a comprehensive dataset that includes invoice details, billing periods, provider information, chargeback totals, payment totals, and contract numbers. The view filters for invoices that are active and have a status ID of 8, which corresponds to a specific business state such as \"Chargeback Pending\" or \"Chargeback Processed.\"\n\n#### 2. Complexity Level: Medium\nThe complexity of this view is considered medium due to the following factors:\n- It involves multiple joins, including two subqueries (CTEs) that aggregate data.\n- It references both tables and other views, which adds layers of abstraction.\n- The use of `STRING_AGG` for concatenating contract numbers introduces additional complexity.\n- The view filters data based on specific conditions, which requires understanding of the business logic behind status IDs and active flags.\n\n#### 3. Data Model Analysis\n- **Tables and Views Referenced:**\n - `Invoice.Invoice`: Contains core invoice data.\n - `Invoice.InvoiceAccountBilling`: Provides payment and chargeback amounts.\n - `Invoice.InvoiceStatus`: Maps status IDs to descriptions.\n - `Billing.vwProviders`: Supplies provider details.\n - `Invoice.vwInvoiceGroupContracts`: Aggregates contract numbers by invoice and billing type.\n\n- **Key Columns:**\n - `InvoiceID`: Primary key for joining across tables.\n - `StatusID`: Used to filter and join with status descriptions.\n - `ProviderID`: Links to provider details.\n - `TotalChargeback` and `TotalPayment`: Aggregated financial metrics.\n\n#### 4. Business Context and Use Cases\nThis view is used in financial reporting and analysis, particularly for monitoring and managing chargebacks. It can be utilized by finance teams to:\n- Generate reports on invoices with chargebacks.\n- Analyze financial impact and trends related to chargebacks.\n- Support decision-making processes regarding billing and collections.\n- Provide insights into provider performance and contract compliance.\n\n#### 5. Performance Considerations\n- **Joins and Aggregations:** The view performs multiple joins and aggregations, which can impact performance, especially with large datasets.\n- **Indexing:** Ensuring that key columns like `InvoiceID`, `StatusID`, and `ProviderID` are indexed can improve join performance.\n- **Filtering:** The WHERE clause filters on `StatusID` and `Active`, which should be supported by indexes to enhance query efficiency.\n- **CTEs:** The use of CTEs for aggregation is efficient for readability but may need optimization if performance issues arise.\n\n#### 6. Security and Access Control\n- **Access Control:** Ensure that only authorized users have access to this view, as it contains sensitive financial data.\n- **Row-Level Security:** Consider implementing row-level security if different users should see different subsets of data based on roles or permissions.\n- **Data Masking:** If the view is exposed to users who should not see certain details, consider data masking techniques for sensitive columns.\n\n#### 7. Potential Issues or Recommendations\n- **Data Integrity:** Ensure that the underlying tables and views maintain data integrity, especially with respect to foreign key relationships.\n- **View Maintenance:** Regularly review and update the view definition to align with changes in business logic or database schema.\n- **Performance Tuning:** Monitor query performance and consider optimization strategies such as indexing, query rewriting, or materialized views if necessary.\n- **Documentation:** Maintain comprehensive documentation for the view, including its purpose, logic, and any business rules applied, to aid in maintenance and onboarding of new team members.",
      "complexity": "Medium",
      "model_used": "gpt-4o-2024-08-06",
      "tokens_used": 1533,
      "api_response_id": "chatcmpl-C8aiRCUk6HcjDBEEB8B4V57LYacLj"
    },
    "analysis_timestamp": "2025-08-25 19:16:45"
  },
  {
    "view_info": {
      "schema": "Invoice",
      "name": "vwInvoiceNotes",
      "created": "2025-08-25 16:04:01.033000",
      "last_altered": "2025-08-25 16:04:01.033000",
      "check_option": "NO CHECK OPTION",
      "comment": "",
      "definition": "CREATE VIEW [Invoice].[vwInvoiceNotes]\r\nAS\r\nSELECT N.NoteID,N.ParentID AS InvoiceID,I.InvoiceNumber,N.[Action],N.Note,N.CreatedDate,N.CreatedBy,CASE WHEN U.AuthenticatedUserID IS NULL THEN 'System' ELSE U.UserFirstName + ' ' + U.UserLastName END AS Username\r\nFROM Common.Note AS N\r\n\tINNER JOIN Invoice.Invoice AS I ON I.InvoiceID = N.ParentID\r\n\tLEFT JOIN Billing.EC3_Membership_EC3Membership AS U ON N.CreatedBy = U.AuthenticatedUserID\r\nWHERE N.ParentType = 'INVOICE';\r\n",
      "is_replicated": false,
      "is_published": false
    },
    "columns": [
      {
        "name": "NoteID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 1,
        "comment": ""
      },
      {
        "name": "InvoiceID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 2,
        "comment": ""
      },
      {
        "name": "InvoiceNumber",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 25,
        "precision": null,
        "scale": null,
        "ordinal_position": 3,
        "comment": ""
      },
      {
        "name": "Action",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 25,
        "precision": null,
        "scale": null,
        "ordinal_position": 4,
        "comment": ""
      },
      {
        "name": "Note",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 500,
        "precision": null,
        "scale": null,
        "ordinal_position": 5,
        "comment": ""
      },
      {
        "name": "CreatedDate",
        "data_type": "datetime",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 6,
        "comment": ""
      },
      {
        "name": "CreatedBy",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 7,
        "comment": ""
      },
      {
        "name": "Username",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 201,
        "precision": null,
        "scale": null,
        "ordinal_position": 8,
        "comment": ""
      }
    ],
    "dependencies": [
      {
        "referenced_schema": "Billing",
        "referenced_object": "EC3_Membership_EC3Membership",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Common",
        "referenced_object": "Note",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Invoice",
        "referenced_object": "Invoice",
        "referenced_type": "USER_TABLE"
      }
    ],
    "analysis": {
      "view_name": "vwInvoiceNotes",
      "explanation": "#### 1. Overview\nThe view `Invoice.vwInvoiceNotes` is designed to aggregate and present information related to notes associated with invoices. It combines data from three tables: `Common.Note`, `Invoice.Invoice`, and `Billing.EC3_Membership_EC3Membership`. The view filters notes specifically related to invoices by checking the `ParentType` column in the `Common.Note` table. It provides a comprehensive view of notes, including details about the note itself, the associated invoice, and the user who created the note.\n\n#### 2. Complexity Level: Medium\nThe complexity of this view is considered medium due to the following factors:\n- It involves multiple joins, including an inner join and a left join, which adds complexity to the SQL logic.\n- The view includes a conditional logic using a `CASE` statement to determine the `Username`.\n- It references three different tables, which requires understanding the relationships and dependencies between these tables.\n\n#### 3. Data Model Analysis\n- **Common.Note**: This table stores notes with a `NoteID`, `ParentID` (linked to `InvoiceID`), `Action`, `Note`, `CreatedDate`, `CreatedBy`, and `ParentType`. The `ParentType` is used to filter notes related to invoices.\n- **Invoice.Invoice**: This table contains invoice details, including `InvoiceID` and `InvoiceNumber`. It is joined with `Common.Note` to match notes to their respective invoices.\n- **Billing.EC3_Membership_EC3Membership**: This table holds user information, including `AuthenticatedUserID`, `UserFirstName`, and `UserLastName`. It is used to resolve the `CreatedBy` field in `Common.Note` to a human-readable username.\n\n#### 4. Business Context and Use Cases\nThe view is used in scenarios where stakeholders need to review or audit notes related to invoices. This can include:\n- Customer service representatives needing to understand the history of actions taken on an invoice.\n- Financial analysts reviewing invoice notes for auditing purposes.\n- Managers tracking user actions and notes for compliance and reporting.\n\n#### 5. Performance Considerations\n- **Joins**: The inner join between `Common.Note` and `Invoice.Invoice` is efficient as it filters out non-matching records early. However, the left join with `Billing.EC3_Membership_EC3Membership` could introduce performance overhead if the user table is large and not indexed properly.\n- **Indexes**: Ensure that `InvoiceID` in `Invoice.Invoice`, `ParentID` in `Common.Note`, and `AuthenticatedUserID` in `Billing.EC3_Membership_EC3Membership` are indexed to optimize join operations.\n- **Filters**: The `WHERE` clause filtering by `ParentType = 'INVOICE'` should be supported by an index on `ParentType` to improve performance.\n\n#### 6. Security and Access Control\n- **Access Control**: Ensure that only authorized users have access to this view, as it exposes sensitive information about invoices and user actions.\n- **Data Sensitivity**: Consider implementing row-level security if different users should have access to different subsets of data based on their roles or permissions.\n- **Audit**: Regularly audit access to this view to ensure compliance with data protection regulations.\n\n#### 7. Potential Issues or Recommendations\n- **Data Integrity**: Ensure that the `ParentID` in `Common.Note` always corresponds to a valid `InvoiceID` in `Invoice.Invoice` to maintain data integrity.\n- **User Information**: If user information is frequently updated, consider caching or optimizing the retrieval of user names to reduce the impact on performance.\n- **Scalability**: As the volume of data grows, monitor the performance of this view and consider partitioning the underlying tables or optimizing indexes to maintain efficiency.\n- **Documentation**: Maintain clear documentation of the view's purpose, structure, and dependencies to aid future maintenance and troubleshooting efforts.",
      "complexity": "Medium",
      "model_used": "gpt-4o-2024-08-06",
      "tokens_used": 1384,
      "api_response_id": "chatcmpl-C8aic0TJkLwYhxJJ1wr58WCenfHor"
    },
    "analysis_timestamp": "2025-08-25 19:16:57"
  },
  {
    "view_info": {
      "schema": "Invoice",
      "name": "vwInvoicePayments",
      "created": "2025-08-25 16:04:00.943000",
      "last_altered": "2025-08-25 16:04:00.943000",
      "check_option": "NO CHECK OPTION",
      "comment": "",
      "definition": "CREATE VIEW [Invoice].[vwInvoicePayments]\r\nAS\r\n\tSELECT IP.InvoicePaymentID, IP.InvoiceGroupContractID, IP.InvoiceID, I.InvoiceNumber, I.InvoiceDate, IP.GroupID, BG.GroupName, IP.ContractID, C.ContractNumber, IP.PaymentType, IP.PaymentNumber, IP.PaymentAmount, IP.DateIssued, IP.DateCleared, IP.DateAccepted, IP.CreatedDate, IP.CreatedBy, IP.ModifiedDate, IP.ModifiedBy, IP.Active\r\n\tFROM [Invoice].[InvoicePayment] IP\r\n\tLEFT JOIN [Invoice].[Invoice] I ON I.InvoiceID = IP.InvoiceID\r\n\tLEFT JOIN [Billing].[vwBillingGroups] BG ON BG.GroupID = IP.GroupID\r\n\tLEFT JOIN [Billing].[Contract] C ON C.ContractID = IP.ContractID;\r\n",
      "is_replicated": false,
      "is_published": false
    },
    "columns": [
      {
        "name": "InvoicePaymentID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 1,
        "comment": ""
      },
      {
        "name": "InvoiceGroupContractID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 2,
        "comment": ""
      },
      {
        "name": "InvoiceID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 3,
        "comment": ""
      },
      {
        "name": "InvoiceNumber",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 25,
        "precision": null,
        "scale": null,
        "ordinal_position": 4,
        "comment": ""
      },
      {
        "name": "InvoiceDate",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 5,
        "comment": ""
      },
      {
        "name": "GroupID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 6,
        "comment": ""
      },
      {
        "name": "GroupName",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 7,
        "comment": ""
      },
      {
        "name": "ContractID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 8,
        "comment": ""
      },
      {
        "name": "ContractNumber",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 25,
        "precision": null,
        "scale": null,
        "ordinal_position": 9,
        "comment": ""
      },
      {
        "name": "PaymentType",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 3,
        "precision": null,
        "scale": null,
        "ordinal_position": 10,
        "comment": ""
      },
      {
        "name": "PaymentNumber",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 255,
        "precision": null,
        "scale": null,
        "ordinal_position": 11,
        "comment": ""
      },
      {
        "name": "PaymentAmount",
        "data_type": "decimal",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 12,
        "comment": ""
      },
      {
        "name": "DateIssued",
        "data_type": "datetime",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 13,
        "comment": ""
      },
      {
        "name": "DateCleared",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 14,
        "comment": ""
      },
      {
        "name": "DateAccepted",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 15,
        "comment": ""
      },
      {
        "name": "CreatedDate",
        "data_type": "datetime",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 16,
        "comment": ""
      },
      {
        "name": "CreatedBy",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 17,
        "comment": ""
      },
      {
        "name": "ModifiedDate",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 18,
        "comment": ""
      },
      {
        "name": "ModifiedBy",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 19,
        "comment": ""
      },
      {
        "name": "Active",
        "data_type": "bit",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 20,
        "comment": ""
      }
    ],
    "dependencies": [
      {
        "referenced_schema": "Billing",
        "referenced_object": "Contract",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Billing",
        "referenced_object": "vwBillingGroups",
        "referenced_type": "VIEW"
      },
      {
        "referenced_schema": "Invoice",
        "referenced_object": "Invoice",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Invoice",
        "referenced_object": "InvoicePayment",
        "referenced_type": "USER_TABLE"
      }
    ],
    "analysis": {
      "view_name": "vwInvoicePayments",
      "explanation": "#### 1. Overview\nThe view `Invoice.vwInvoicePayments` is designed to provide a consolidated view of invoice payment details by joining data from multiple tables and a view. It aggregates information related to invoice payments, including invoice details, group information, and contract details. This view is useful for retrieving comprehensive payment information in a single query, which can be beneficial for reporting and analysis purposes.\n\n#### 2. Complexity Level: Medium\nThe complexity of this view is considered medium due to the following factors:\n- It involves multiple joins, including three LEFT JOIN operations, which can increase the complexity of the query execution plan.\n- It references both tables and another view, which adds layers to the data retrieval process.\n- The view does not include any complex calculations or subqueries, which keeps the complexity from being high.\n\n#### 3. Data Model Analysis\nThe view depends on the following objects:\n- **Invoice.InvoicePayment (USER_TABLE):** This table is the primary source of payment-related data, including payment type, number, amount, and dates.\n- **Invoice.Invoice (USER_TABLE):** Provides invoice-specific details such as invoice number and date.\n- **Billing.vwBillingGroups (VIEW):** Supplies group-related information, specifically the group name.\n- **Billing.Contract (USER_TABLE):** Offers contract-specific details, particularly the contract number.\n\nThe view's structure suggests a relational model where invoice payments are linked to invoices, groups, and contracts. The use of LEFT JOINs indicates that not all invoices, groups, or contracts have corresponding entries in the `InvoicePayment` table, allowing for the inclusion of payments that not have complete associated data.\n\n#### 4. Business Context and Use Cases\nThis view is used in scenarios where comprehensive payment information is required, such as:\n- Generating financial reports that include payment details alongside invoice, group, and contract information.\n- Supporting customer service operations by providing a detailed view of payment history and status.\n- Assisting in auditing and compliance checks by offering a consolidated view of payment transactions.\n\n#### 5. Performance Considerations\n- **Join Operations:** The use of multiple LEFT JOINs can impact performance, especially if the underlying tables/views are large. Indexes on join columns (e.g., `InvoiceID`, `GroupID`, `ContractID`) can help optimize query performance.\n- **View Dependencies:** The inclusion of another view (`Billing.vwBillingGroups`) can add overhead, as the performance of this view is dependent on the performance of the referenced view.\n- **Data Volume:** The performance may degrade with large datasets, particularly if the `InvoicePayment` table grows significantly.\n\n#### 6. Security and Access Control\n- **Access Control:** Ensure that users accessing this view have appropriate permissions on all underlying tables and views. This includes SELECT permissions on `Invoice.InvoicePayment`, `Invoice.Invoice`, `Billing.vwBillingGroups`, and `Billing.Contract`.\n- **Data Sensitivity:** Consider the sensitivity of the data exposed by this view, such as payment amounts and dates. Implement row-level security or data masking if necessary to protect sensitive information.\n\n#### 7. Potential Issues or Recommendations\n- **Indexing:** Evaluate and implement indexes on frequently queried columns, especially those used in join conditions, to improve performance.\n- **View Maintenance:** Regularly review and update the view definition to accommodate changes in business requirements or underlying data structures.\n- **Data Quality:** Ensure data integrity and consistency across the referenced tables and views to prevent discrepancies in the view output.\n- **Documentation:** Maintain comprehensive documentation for the view, including its purpose, dependencies, and any business rules applied, to facilitate maintenance and usage by other team members.",
      "complexity": "Medium",
      "model_used": "gpt-4o-2024-08-06",
      "tokens_used": 1487,
      "api_response_id": "chatcmpl-C8aiovVPrATmcUcWqBH2sTXprB04a"
    },
    "analysis_timestamp": "2025-08-25 19:17:12"
  },
  {
    "view_info": {
      "schema": "Invoice",
      "name": "vwInvoices",
      "created": "2025-08-25 16:04:00.917000",
      "last_altered": "2025-08-25 16:04:00.917000",
      "check_option": "NO CHECK OPTION",
      "comment": "",
      "definition": "\r\nCREATE VIEW [Invoice].[vwInvoices]\r\nAS\r\n\tSELECT I.InvoiceID, I.InvoiceNumber, I.InvoiceBillingPeriod, I.InvoiceDate, ISNULL((SELECT COUNT(1) FROM [Invoice].[InvoiceGroupContract] WHERE InvoiceID = I.InvoiceID), 0) AS InvoiceGroupCount, ISNULL(IA.AmountBilled, 0.00) AS AmountBilled, ISNULL(IA.AmountPaid, 00) AS AmountPaid, I.ProviderID, P.ProviderName, I.StatusID, S.StatusDescription, I.CreatedDate, I.CreatedBy, I.ModifiedDate, I.ModifiedBy, I.Active, IIF(CHARINDEX('_', I.InvoiceNumber)>0, RIGHT(I.InvoiceNumber, LEN(I.InvoiceNumber)-CHARINDEX('_', I.InvoiceNumber)), I.InvoiceNumber) AS ItsInvoiceNumber\r\n\tFROM [Invoice].[Invoice] I\r\n\tLEFT JOIN [Billing].[vwProviders] P ON P.ProviderID = I.ProviderID\r\n\tLEFT JOIN [Invoice].[InvoiceStatus] S ON S.StatusID = I.StatusID\r\n\tLEFT JOIN [Invoice].[vwInvoiceAmounts] IA ON IA.InvoiceID = I.InvoiceID;\r\n",
      "is_replicated": false,
      "is_published": false
    },
    "columns": [
      {
        "name": "InvoiceID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 1,
        "comment": ""
      },
      {
        "name": "InvoiceNumber",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 25,
        "precision": null,
        "scale": null,
        "ordinal_position": 2,
        "comment": ""
      },
      {
        "name": "InvoiceBillingPeriod",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 6,
        "precision": null,
        "scale": null,
        "ordinal_position": 3,
        "comment": ""
      },
      {
        "name": "InvoiceDate",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 4,
        "comment": ""
      },
      {
        "name": "InvoiceGroupCount",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 5,
        "comment": ""
      },
      {
        "name": "AmountBilled",
        "data_type": "decimal",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 38,
        "scale": 2,
        "ordinal_position": 6,
        "comment": ""
      },
      {
        "name": "AmountPaid",
        "data_type": "decimal",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 38,
        "scale": 2,
        "ordinal_position": 7,
        "comment": ""
      },
      {
        "name": "ProviderID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 8,
        "comment": ""
      },
      {
        "name": "ProviderName",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 20,
        "precision": null,
        "scale": null,
        "ordinal_position": 9,
        "comment": ""
      },
      {
        "name": "StatusID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 10,
        "comment": ""
      },
      {
        "name": "StatusDescription",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 50,
        "precision": null,
        "scale": null,
        "ordinal_position": 11,
        "comment": ""
      },
      {
        "name": "CreatedDate",
        "data_type": "datetime",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 12,
        "comment": ""
      },
      {
        "name": "CreatedBy",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 13,
        "comment": ""
      },
      {
        "name": "ModifiedDate",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 14,
        "comment": ""
      },
      {
        "name": "ModifiedBy",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 15,
        "comment": ""
      },
      {
        "name": "Active",
        "data_type": "bit",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 16,
        "comment": ""
      },
      {
        "name": "ItsInvoiceNumber",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 25,
        "precision": null,
        "scale": null,
        "ordinal_position": 17,
        "comment": ""
      }
    ],
    "dependencies": [
      {
        "referenced_schema": "Billing",
        "referenced_object": "vwProviders",
        "referenced_type": "VIEW"
      },
      {
        "referenced_schema": "Invoice",
        "referenced_object": "Invoice",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Invoice",
        "referenced_object": "InvoiceGroupContract",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Invoice",
        "referenced_object": "InvoiceStatus",
        "referenced_type": "USER_TABLE"
      },
      {
        "referenced_schema": "Invoice",
        "referenced_object": "vwInvoiceAmounts",
        "referenced_type": "VIEW"
      }
    ],
    "analysis": {
      "view_name": "vwInvoices",
      "explanation": "#### 1. Overview\nThe view `Invoice.vwInvoices` is designed to provide a comprehensive overview of invoice data by aggregating and joining information from multiple tables and views. It consolidates invoice details, billing amounts, provider information, and status descriptions into a single result set. This view is used for reporting and analysis purposes, allowing users to access detailed invoice information without needing to query multiple tables directly.\n\n#### 2. Complexity Level: Medium\nThe complexity of this view is considered medium due to the following factors:\n- It involves multiple joins, including two views and two tables, which increases the complexity of the SQL logic.\n- The use of subqueries and conditional logic (e.g., `ISNULL`, `IIF`, `CHARINDEX`) adds additional layers of complexity.\n- The view does not include any complex aggregations or window functions, which keeps the complexity from being high.\n\n#### 3. Data Model Analysis\n- **Primary Table**: `Invoice.Invoice` serves as the main table, providing core invoice details.\n- **Referenced Views and Tables**:\n - `Billing.vwProviders`: Provides provider names based on `ProviderID`.\n - `Invoice.InvoiceGroupContract`: Used to calculate `InvoiceGroupCount` via a subquery.\n - `Invoice.InvoiceStatus`: Supplies status descriptions based on `StatusID`.\n - `Invoice.vwInvoiceAmounts`: Offers billing and payment amounts, joined by `InvoiceID`.\n- **Columns**: The view includes a mix of directly selected columns, calculated fields (e.g., `InvoiceGroupCount`), and derived fields (e.g., `ItsInvoiceNumber`).\n\n#### 4. Business Context and Use Cases\n- **Reporting**: This view is used in financial reporting to provide insights into invoice statuses, amounts billed and paid, and provider-related information.\n- **Audit and Compliance**: The inclusion of created and modified metadata (dates and user IDs) suggests use in auditing and compliance checks.\n- **Operational Monitoring**: The `Active` flag and status descriptions can be used to monitor invoice processing and lifecycle stages.\n\n#### 5. Performance Considerations\n- **Joins**: The view uses LEFT JOINs, which can be performance-intensive if the underlying tables/views are large or not properly indexed.\n- **Subquery**: The subquery for `InvoiceGroupCount` could be a performance bottleneck if `InvoiceGroupContract` is large or lacks an index on `InvoiceID`.\n- **Indexes**: Ensuring indexes on `InvoiceID`, `ProviderID`, and `StatusID` in the respective tables can improve join performance.\n- **View Dependencies**: Performance of `vwInvoiceAmounts` and `vwProviders` can impact the overall performance of this view.\n\n#### 6. Security and Access Control\n- **Access Control**: Ensure that access to this view is restricted to users with appropriate permissions, as it exposes sensitive financial data.\n- **Data Sensitivity**: Consider implementing row-level security if different users should see different subsets of data based on their roles.\n- **Audit Trails**: The view includes metadata for auditing purposes, which should be protected to maintain data integrity.\n\n#### 7. Potential Issues or Recommendations\n- **Indexing**: Review and optimize indexes on all involved tables to enhance performance, especially for frequently queried columns.\n- **Subquery Optimization**: Consider refactoring the subquery for `InvoiceGroupCount` into a join if it can be optimized that way.\n- **View Maintenance**: Regularly review and update the view definition to accommodate changes in business logic or underlying table structures.\n- **Data Quality**: Ensure data quality checks are in place for nullable fields like `InvoiceDate`, `ProviderName`, and `StatusDescription` to prevent incomplete data from affecting reports.\n- **Scalability**: Monitor the performance impact as data volume grows, and consider partitioning strategies if necessary.",
      "complexity": "Medium",
      "model_used": "gpt-4o-2024-08-06",
      "tokens_used": 1602,
      "api_response_id": "chatcmpl-C8aj3k88dRCeJTTPyJZEedYgvLbv0"
    },
    "analysis_timestamp": "2025-08-25 19:17:28"
  },
  {
    "view_info": {
      "schema": "Invoice",
      "name": "vwInvoiceStatuses",
      "created": "2025-08-25 16:04:01.037000",
      "last_altered": "2025-08-25 16:04:01.037000",
      "check_option": "NO CHECK OPTION",
      "comment": "",
      "definition": "CREATE VIEW [Invoice].[vwInvoiceStatuses]\r\nAS\r\n\tSELECT StatusID, StatusDescription, IsWorkQueueStatus\r\n\tFROM [Invoice].[InvoiceStatus];\r\n\r\n",
      "is_replicated": false,
      "is_published": false
    },
    "columns": [
      {
        "name": "StatusID",
        "data_type": "int",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 1,
        "comment": ""
      },
      {
        "name": "StatusDescription",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 50,
        "precision": null,
        "scale": null,
        "ordinal_position": 2,
        "comment": ""
      },
      {
        "name": "IsWorkQueueStatus",
        "data_type": "bit",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 3,
        "comment": ""
      }
    ],
    "dependencies": [
      {
        "referenced_schema": "Invoice",
        "referenced_object": "InvoiceStatus",
        "referenced_type": "USER_TABLE"
      }
    ],
    "analysis": {
      "view_name": "vwInvoiceStatuses",
      "explanation": "#### 1. Overview\nThe view `Invoice.vwInvoiceStatuses` is a simple representation of the statuses associated with invoices in the database. It is designed to provide a straightforward way to access the status information of invoices, including the status ID, description, and whether the status is part of a work queue. The view is constructed from a single table, `Invoice.InvoiceStatus`, and does not include any additional logic or transformations beyond selecting specific columns.\n\n#### 2. Complexity Level: Low\nThe complexity level of this view is low. It involves a direct selection of columns from a single table without any joins, aggregations, or complex SQL logic. The view does not include any computed columns or conditional logic, making it straightforward and easy to understand.\n\n#### 3. Data Model Analysis\n- **Underlying Table**: The view depends on the `Invoice.InvoiceStatus` table. This table is assumed to contain the definitions of various statuses that an invoice can have, along with a flag indicating if the status is part of a work queue.\n- **Columns**:\n - `StatusID`: An integer serving as the primary key or unique identifier for each status.\n - `StatusDescription`: A varchar field providing a textual description of the status.\n - `IsWorkQueueStatus`: A bit field indicating whether the status is part of a work queue, used for workflow management.\n\n#### 4. Business Context and Use Cases\n- **Business Context**: This view is used in scenarios where there is a need to quickly reference or display the status of invoices. It can be used in reporting, dashboards, or user interfaces where invoice statuses need to be displayed or filtered.\n- **Use Cases**:\n - Generating reports that list invoices along with their statuses.\n - Filtering invoices based on their status in applications or services.\n - Integrating with workflow systems that need to know if an invoice status is part of a work queue.\n\n#### 5. Performance Considerations\n- **Performance**: Given the simplicity of the view, performance considerations are minimal. The view does not involve complex operations or large data transformations, so it should perform efficiently as long as the underlying table is properly indexed.\n- **Indexing**: Ensure that the `Invoice.InvoiceStatus` table has appropriate indexing, especially on the `StatusID` column, to facilitate quick lookups.\n\n#### 6. Security and Access Control\n- **Access Control**: Security should be managed at the database level, ensuring that only authorized users have access to this view. This can be achieved through role-based access control (RBAC) and granting permissions only to roles or users that require access to invoice status information.\n- **Data Sensitivity**: Since the view does not contain sensitive information, security concerns are minimal, but standard practices should still be followed.\n\n#### 7. Potential Issues or Recommendations\n- **Potential Issues**: There are no immediate issues with the view itself due to its simplicity. However, any changes to the structure of the `Invoice.InvoiceStatus` table, such as renaming columns or changing data types, can impact the view.\n- **Recommendations**:\n - **Documentation**: Ensure that the view is well-documented, including its purpose and any dependencies, to aid future maintenance.\n - **Version Control**: Use version control for database objects to track changes over time.\n - **Testing**: Regularly test the view as part of database maintenance to ensure it continues to function correctly, especially after any changes to the underlying table.",
      "complexity": "Low",
      "model_used": "gpt-4o-2024-08-06",
      "tokens_used": 1112,
      "api_response_id": "chatcmpl-C8ajKx7sDT0O8HNqIIsG9rYhDEwX6"
    },
    "analysis_timestamp": "2025-08-25 19:17:40"
  },
  {
    "view_info": {
      "schema": "Invoice",
      "name": "vwPaymentRequests",
      "created": "2025-08-25 16:04:00.910000",
      "last_altered": "2025-08-25 16:04:00.910000",
      "check_option": "NO CHECK OPTION",
      "comment": "",
      "definition": "CREATE VIEW [Invoice].[vwPaymentRequests]\r\nAS\r\nSELECT DISTINCT CONVERT(VARCHAR(50), C.ContractNumber) AS ContractNumber,H.PaymentRequestID,C.PaymentRequestNumber,C.PaymentRequestVersionNumber,CONVERT(VARCHAR(50), C.InvoiceNumber) AS InvoiceNumber,H.DOC_ACTU_AM,H.PYMT_AM,H.DOC_APPL_CREA_DT,H.DOC_APPL_LAST_DT\r\nFROM fms.vwPaymentRequestHeader AS H\r\n\tINNER JOIN (SELECT DISTINCT PRCOMM.VEND_INV_NO AS InvoiceNumber,PRCOMM.ContractNumber,PRCOMM.PaymentRequestNumber,MAX(PRCOMM.PaymentRequestVersionNumber) AS PaymentRequestVersionNumber\r\n FROM fms.vwPaymentRequestCommodity AS PRCOMM\r\n GROUP BY PRCOMM.VEND_INV_NO, PRCOMM.ContractNumber, PRCOMM.PaymentRequestNumber) AS C\r\n ON (C.PaymentRequestNumber + ' ' + CONVERT(VARCHAR(20), C.PaymentRequestVersionNumber)) = H.PaymentRequestID;\r\n",
      "is_replicated": false,
      "is_published": false
    },
    "columns": [
      {
        "name": "ContractNumber",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 50,
        "precision": null,
        "scale": null,
        "ordinal_position": 1,
        "comment": ""
      },
      {
        "name": "PaymentRequestID",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 55,
        "precision": null,
        "scale": null,
        "ordinal_position": 2,
        "comment": ""
      },
      {
        "name": "PaymentRequestNumber",
        "data_type": "varchar",
        "is_nullable": "NO",
        "column_default": null,
        "max_length": 34,
        "precision": null,
        "scale": null,
        "ordinal_position": 3,
        "comment": ""
      },
      {
        "name": "PaymentRequestVersionNumber",
        "data_type": "int",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 10,
        "scale": 0,
        "ordinal_position": 4,
        "comment": ""
      },
      {
        "name": "InvoiceNumber",
        "data_type": "varchar",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": 50,
        "precision": null,
        "scale": null,
        "ordinal_position": 5,
        "comment": ""
      },
      {
        "name": "DOC_ACTU_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 6,
        "comment": ""
      },
      {
        "name": "PYMT_AM",
        "data_type": "decimal",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": 18,
        "scale": 2,
        "ordinal_position": 7,
        "comment": ""
      },
      {
        "name": "DOC_APPL_CREA_DT",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 8,
        "comment": ""
      },
      {
        "name": "DOC_APPL_LAST_DT",
        "data_type": "datetime",
        "is_nullable": "YES",
        "column_default": null,
        "max_length": null,
        "precision": null,
        "scale": null,
        "ordinal_position": 9,
        "comment": ""
      }
    ],
    "dependencies": [
      {
        "referenced_schema": "fms",
        "referenced_object": "vwPaymentRequestCommodity",
        "referenced_type": "VIEW"
      },
      {
        "referenced_schema": "fms",
        "referenced_object": "vwPaymentRequestHeader",
        "referenced_type": "VIEW"
      }
    ],
    "analysis": {
      "view_name": "vwPaymentRequests",
      "explanation": "#### 1. Overview\nThe view `Invoice.vwPaymentRequests` is designed to aggregate and present payment request information by joining data from two other views: `fms.vwPaymentRequestHeader` and `fms.vwPaymentRequestCommodity`. It provides a consolidated view of payment requests, including contract numbers, payment request identifiers, invoice numbers, and associated financial details. The view uses a combination of `DISTINCT` and `GROUP BY` clauses to ensure unique records and to aggregate data based on the maximum version number of payment requests.\n\n#### 2. Complexity Level: Medium\nThe complexity of this view is considered medium due to the following factors:\n- It involves a join between two views, which adds a layer of abstraction and complexity.\n- The use of subqueries and aggregation functions (`MAX`) within the join condition increases the complexity.\n- The view employs `DISTINCT` to ensure unique results, which can impact performance and complexity.\n\n#### 3. Data Model Analysis\n- **Referenced Views**:\n - `fms.vwPaymentRequestHeader`: This view contains header-level information about payment requests, such as amounts and dates.\n - `fms.vwPaymentRequestCommodity`: This view contain detailed commodity-level information, including invoice numbers and contract details.\n- **Columns**:\n - The view selects a mix of varchar, int, decimal, and datetime data types, reflecting a combination of identifiers, financial amounts, and timestamps.\n- **Join Logic**:\n - The join condition concatenates `PaymentRequestNumber` and `PaymentRequestVersionNumber` to match with `PaymentRequestID`, indicating a composite key relationship.\n\n#### 4. Business Context and Use Cases\n- **Purpose**: The view is used to provide a comprehensive overview of payment requests for reporting, auditing, or financial reconciliation purposes.\n- **Use Cases**:\n - Generating reports for financial analysis and tracking payment request statuses.\n - Supporting audit processes by providing a consolidated view of payment request data.\n - Facilitating integration with other financial systems or modules that require payment request information.\n\n#### 5. Performance Considerations\n- **DISTINCT and GROUP BY**: The use of `DISTINCT` and `GROUP BY` can lead to performance overhead, especially if the underlying views return large datasets.\n- **Join on Concatenated Fields**: The join condition involves concatenating fields, which can be computationally expensive and may impact query performance.\n- **Aggregation**: The `MAX` function within the subquery requires additional computation, potentially affecting performance if not indexed properly.\n\n#### 6. Security and Access Control\n- **View Security**: Ensure that access to the view is restricted to authorized users only, as it aggregates sensitive financial data.\n- **Underlying Views**: Security settings on the underlying views (`fms.vwPaymentRequestHeader` and `fms.vwPaymentRequestCommodity`) should be reviewed to ensure consistent access control.\n- **No Check Option**: The absence of a check option means that the view does not enforce any constraints on data modifications, which is typical for read-only reporting views.\n\n#### 7. Potential Issues or Recommendations\n- **Indexing**: Consider indexing the columns involved in the join and aggregation operations to improve performance.\n- **View Maintenance**: Regularly review and optimize the view definition to ensure it meets performance and business requirements as data volumes grow.\n- **Data Integrity**: Ensure that the logic for concatenating `PaymentRequestNumber` and `PaymentRequestVersionNumber` accurately reflects the intended business rules and does not lead to data mismatches.\n- **Documentation**: Maintain comprehensive documentation of the view's purpose, logic, and dependencies to aid in future maintenance and troubleshooting efforts.",
      "complexity": "Medium",
      "model_used": "gpt-4o-2024-08-06",
      "tokens_used": 1445,
      "api_response_id": "chatcmpl-C8ajViH2IwTAQn24iYsucgaSmckxn"
    },
    "analysis_timestamp": "2025-08-25 19:17:57"
  }
]
