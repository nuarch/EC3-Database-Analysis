graph TD
    dbo_xp_cmdshell[dbo.xp_cmdshell]
    published_usp_create_energyusagesummarygroupbyagencyandenergytype[published.usp_create_energyusagesummarygroupbyagencyandenergytype]
    published_usp_createaccountlevelsummarybydollarsbtusco2andenergytype[published.usp_createaccountlevelsummarybydollarsbtusco2andenergytype]
    published_usp_createsummarizededdollarsbtusandco2byagencydivisionhierarchy[published.usp_createsummarizededdollarsbtusandco2byagencydivisionhierarchy]
    published_usp_utility_countrowspublisheddatabypublishedbillingperiod[published.usp_utility_countrowspublisheddatabypublishedbillingperiod]
    temporal_hashvalueupdateforpublishedtables[temporal.hashvalueupdateforpublishedtables]
    temporal_usp_insertnewperiodfrompublishedtotemporalaccountlevelsummarybyagency[temporal.usp_insertnewperiodfrompublishedtotemporalaccountlevelsummarybyagency]
    temporal_usp_insertnewperiodfrompublishedtotemporalaccountlevelsummarybycitywide[temporal.usp_insertnewperiodfrompublishedtotemporalaccountlevelsummarybycitywide]
    temporal_usp_insertnewperiodfrompublishedtotemporalaccountlevelsummarybyfacility[temporal.usp_insertnewperiodfrompublishedtotemporalaccountlevelsummarybyfacility]
    temporal_usp_insertnewperiodfrompublishedtotemporalaccountmeterlevelrawdataforcurrentperiod[temporal.usp_insertnewperiodfrompublishedtotemporalaccountmeterlevelrawdataforcurrentperiod]
    temporal_usp_insertnewperiodfrompublishedtotemporalenergyusagesummarygroupbyagencyandenergytype[temporal.usp_insertnewperiodfrompublishedtotemporalenergyusagesummarygroupbyagencyandenergytype]
    temporal_usp_insertnewperiodfrompublishedtotemporalfiscalyearpivotbyagencyandfacilitydollarsandusage[temporal.usp_insertnewperiodfrompublishedtotemporalfiscalyearpivotbyagencyandfacilitydollarsandusage]
    temporal_usp_insertnewperiodfrompublishedtotemporalfiscalyearpivotbyagencydollarsandusage[temporal.usp_insertnewperiodfrompublishedtotemporalfiscalyearpivotbyagencydollarsandusage]
    temporal_usp_insertnewperiodfrompublishedtotemporalfiscalyearpivotbyagencyfacilityandaccountdollarsandusage[temporal.usp_insertnewperiodfrompublishedtotemporalfiscalyearpivotbyagencyfacilityandaccountdollarsandusage]
    temporal_usp_insertnewperiodfrompublishedtotemporalfiscalyearpivotbyencoremonthlypayments[temporal.usp_insertnewperiodfrompublishedtotemporalfiscalyearpivotbyencoremonthlypayments]
    temporal_usp_insertnewperiodfrompublishedtotemporalforaccountlevelrawdataforcurrentperiod[temporal.usp_insertnewperiodfrompublishedtotemporalforaccountlevelrawdataforcurrentperiod]
    temporal_usp_insertnewperiodfrompublishedtotemporalforaccountlevelsummaryfordollarsbtusandco2[temporal.usp_insertnewperiodfrompublishedtotemporalforaccountlevelsummaryfordollarsbtusandco2]
    temporal_usp_truncatepublishingtables[temporal.usp_truncatepublishingtables]
    utils_usp_reindextablesafterpublishing[utils.usp_reindextablesafterpublishing]
    utils_usp_reindextemporaltablesafterpublishing[utils.usp_reindextemporaltablesafterpublishing]
    published_usp_createpublishedtablesfromviewsforcurrentbillingperiod[published.usp_createpublishedtablesfromviewsforcurrentbillingperiod] --> published_usp_create_energyusagesummarygroupbyagencyandenergytype[published.usp_create_energyusagesummarygroupbyagencyandenergytype]
    published_usp_createpublishedtablesfromviewsforcurrentbillingperiod[published.usp_createpublishedtablesfromviewsforcurrentbillingperiod] --> published_usp_createaccountlevelsummarybydollarsbtusco2andenergytype[published.usp_createaccountlevelsummarybydollarsbtusco2andenergytype]
    published_usp_createpublishedtablesfromviewsforcurrentbillingperiod[published.usp_createpublishedtablesfromviewsforcurrentbillingperiod] --> published_usp_createsummarizededdollarsbtusandco2byagencydivisionhierarchy[published.usp_createsummarizededdollarsbtusandco2byagencydivisionhierarchy]
    published_usp_createpublishedtablesfromviewsforcurrentbillingperiod[published.usp_createpublishedtablesfromviewsforcurrentbillingperiod] --> published_usp_ssis_createdepextractinseptsformat[published.usp_ssis_createdepextractinseptsformat]
    published_usp_createpublishedtablesfromviewsforcurrentbillingperiod[published.usp_createpublishedtablesfromviewsforcurrentbillingperiod] --> published_usp_ssis_createseptscsvextract[published.usp_ssis_createseptscsvextract]
    published_usp_createpublishedtablesfromviewsforcurrentbillingperiod[published.usp_createpublishedtablesfromviewsforcurrentbillingperiod] --> published_usp_utility_countrowspublisheddatabypublishedbillingperiod[published.usp_utility_countrowspublisheddatabypublishedbillingperiod]
    published_usp_createpublishedtablesfromviewsforcurrentbillingperiod[published.usp_createpublishedtablesfromviewsforcurrentbillingperiod] --> temporal_hashvalueupdateforpublishedtables[temporal.hashvalueupdateforpublishedtables]
    published_usp_createpublishedtablesfromviewsforcurrentbillingperiod[published.usp_createpublishedtablesfromviewsforcurrentbillingperiod] --> temporal_usp_processandinserttemporaldata[temporal.usp_processandinserttemporaldata]
    published_usp_createpublishedtablesfromviewsforcurrentbillingperiod[published.usp_createpublishedtablesfromviewsforcurrentbillingperiod] --> temporal_usp_truncatepublishingtables[temporal.usp_truncatepublishingtables]
    published_usp_createpublishedtablesfromviewsforcurrentbillingperiod[published.usp_createpublishedtablesfromviewsforcurrentbillingperiod] --> utils_usp_reindextablesafterpublishing[utils.usp_reindextablesafterpublishing]
    published_usp_createpublishedtablesfromviewsforcurrentbillingperiod[published.usp_createpublishedtablesfromviewsforcurrentbillingperiod] --> utils_usp_reindextemporaltablesafterpublishing[utils.usp_reindextemporaltablesafterpublishing]
    published_usp_ssis_createdepextractinseptsformat[published.usp_ssis_createdepextractinseptsformat] --> dbo_xp_cmdshell[dbo.xp_cmdshell]
    published_usp_ssis_createseptscsvextract[published.usp_ssis_createseptscsvextract] --> dbo_xp_cmdshell[dbo.xp_cmdshell]
    temporal_usp_processandinserttemporaldata[temporal.usp_processandinserttemporaldata] --> temporal_usp_insertnewperiodfrompublishedtotemporalaccountlevelsummarybyagency[temporal.usp_insertnewperiodfrompublishedtotemporalaccountlevelsummarybyagency]
    temporal_usp_processandinserttemporaldata[temporal.usp_processandinserttemporaldata] --> temporal_usp_insertnewperiodfrompublishedtotemporalaccountlevelsummarybycitywide[temporal.usp_insertnewperiodfrompublishedtotemporalaccountlevelsummarybycitywide]
    temporal_usp_processandinserttemporaldata[temporal.usp_processandinserttemporaldata] --> temporal_usp_insertnewperiodfrompublishedtotemporalaccountlevelsummarybyfacility[temporal.usp_insertnewperiodfrompublishedtotemporalaccountlevelsummarybyfacility]
    temporal_usp_processandinserttemporaldata[temporal.usp_processandinserttemporaldata] --> temporal_usp_insertnewperiodfrompublishedtotemporalaccountmeterlevelrawdataforcurrentperiod[temporal.usp_insertnewperiodfrompublishedtotemporalaccountmeterlevelrawdataforcurrentperiod]
    temporal_usp_processandinserttemporaldata[temporal.usp_processandinserttemporaldata] --> temporal_usp_insertnewperiodfrompublishedtotemporalenergyusagesummarygroupbyagencyandenergytype[temporal.usp_insertnewperiodfrompublishedtotemporalenergyusagesummarygroupbyagencyandenergytype]
    temporal_usp_processandinserttemporaldata[temporal.usp_processandinserttemporaldata] --> temporal_usp_insertnewperiodfrompublishedtotemporalfiscalyearpivotbyagencyandfacilitydollarsandusage[temporal.usp_insertnewperiodfrompublishedtotemporalfiscalyearpivotbyagencyandfacilitydollarsandusage]
    temporal_usp_processandinserttemporaldata[temporal.usp_processandinserttemporaldata] --> temporal_usp_insertnewperiodfrompublishedtotemporalfiscalyearpivotbyagencydollarsandusage[temporal.usp_insertnewperiodfrompublishedtotemporalfiscalyearpivotbyagencydollarsandusage]
    temporal_usp_processandinserttemporaldata[temporal.usp_processandinserttemporaldata] --> temporal_usp_insertnewperiodfrompublishedtotemporalfiscalyearpivotbyagencyfacilityandaccountdollarsandusage[temporal.usp_insertnewperiodfrompublishedtotemporalfiscalyearpivotbyagencyfacilityandaccountdollarsandusage]
    temporal_usp_processandinserttemporaldata[temporal.usp_processandinserttemporaldata] --> temporal_usp_insertnewperiodfrompublishedtotemporalfiscalyearpivotbyencoremonthlypayments[temporal.usp_insertnewperiodfrompublishedtotemporalfiscalyearpivotbyencoremonthlypayments]
    temporal_usp_processandinserttemporaldata[temporal.usp_processandinserttemporaldata] --> temporal_usp_insertnewperiodfrompublishedtotemporalforaccountlevelrawdataforcurrentperiod[temporal.usp_insertnewperiodfrompublishedtotemporalforaccountlevelrawdataforcurrentperiod]
    temporal_usp_processandinserttemporaldata[temporal.usp_processandinserttemporaldata] --> temporal_usp_insertnewperiodfrompublishedtotemporalforaccountlevelsummaryfordollarsbtusandco2[temporal.usp_insertnewperiodfrompublishedtotemporalforaccountlevelsummaryfordollarsbtusandco2]