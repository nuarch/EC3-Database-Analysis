{
  "version": 1,
  "type": "doc",
  "content": [
    {
      "type": "bodiedExtension",
      "attrs": {
        "extensionType": "com.atlassian.confluence.macro.core",
        "extensionKey": "details",
        "parameters": {
          "macroParams": {
            "hidden": {
              "value": "true"
            }
          },
          "macroMetadata": {
            "schemaVersion": {
              "value": "1"
            },
            "title": "Page Properties"
          }
        }
      },
      "content": [
        {
          "type": "table",
          "attrs": {
            "isNumberColumnEnabled": false,
            "layout": "default"
          },
          "content": [
            {
              "type": "tableRow",
              "content": [
                {
                  "type": "tableHeader",
                  "attrs": {
                    "colspan": 1,
                    "background": "#f4f5f7",
                    "rowspan": 1
                  },
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "text": "Schema Name",
                          "type": "text",
                          "marks": [
                            {
                              "type": "strong"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "attrs": {
                    "colspan": 1,
                    "rowspan": 1
                  },
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "text": "CrisNationalGridWest",
                          "type": "text"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": "tableRow",
              "content": [
                {
                  "type": "tableHeader",
                  "attrs": {
                    "colspan": 1,
                    "background": "#f4f5f7",
                    "rowspan": 1
                  },
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "text": "Stored Procedure Name",
                          "type": "text",
                          "marks": [
                            {
                              "type": "strong"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "attrs": {
                    "colspan": 1,
                    "rowspan": 1
                  },
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "text": "usp_Util_CRIS_CompareVariousTablesByAccountNumer",
                          "type": "text"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": "tableRow",
              "content": [
                {
                  "type": "tableHeader",
                  "attrs": {
                    "colspan": 1,
                    "background": "#f4f5f7",
                    "rowspan": 1
                  },
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "text": "Complexity Level",
                          "type": "text",
                          "marks": [
                            {
                              "type": "strong"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "attrs": {
                    "colspan": 1,
                    "rowspan": 1
                  },
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "text": "Medium",
                          "type": "text"
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "type": "heading",
      "attrs": {
        "level": 1
      },
      "content": [
        {
          "type": "text",
          "text": "1. Overview"
        }
      ]
    },
    {
      "type": "paragraph",
      "content": [
        {
          "type": "text",
          "text": "The stored procedure "
        },
        {
          "type": "text",
          "text": "usp_Util_CRIS_CompareVariousTablesByAccountNumer",
          "marks": [
            {
              "type": "code"
            }
          ]
        },
        {
          "type": "text",
          "text": " is designed to retrieve and compare billing and account information across multiple tables within the "
        },
        {
          "type": "text",
          "text": "CrisNationalGridWest",
          "marks": [
            {
              "type": "code"
            }
          ]
        },
        {
          "type": "text",
          "text": " and "
        },
        {
          "type": "text",
          "text": "Billing",
          "marks": [
            {
              "type": "code"
            }
          ]
        },
        {
          "type": "text",
          "text": " schemas. It focuses on records associated with a specific account number, which is provided as an input parameter. The procedure executes several "
        },
        {
          "type": "text",
          "text": "SELECT",
          "marks": [
            {
              "type": "code"
            }
          ]
        },
        {
          "type": "text",
          "text": " statements to extract data from different tables, each query targeting a specific aspect of the account's billing and adjustment history. The results are ordered by various criteria, primarily focusing on billing periods and transaction codes."
        }
      ]
    },
    {
      "type": "heading",
      "attrs": {
        "level": 1
      },
      "content": [
        {
          "type": "text",
          "text": "2. Complexity Level: Medium"
        }
      ]
    },
    {
      "type": "paragraph",
      "content": [
        {
          "type": "text",
          "text": "The complexity of this stored procedure is considered medium due to the following factors:"
        }
      ]
    },
    {
      "type": "bulletList",
      "content": [
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "It involves multiple "
                },
                {
                  "type": "text",
                  "text": "SELECT",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " statements querying different tables."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "It includes conditional logic within the queries."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "It performs calculations within the "
                },
                {
                  "type": "text",
                  "text": "SELECT",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " statements."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "It uses multiple ordering criteria to sort the results."
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "type": "heading",
      "attrs": {
        "level": 1
      },
      "content": [
        {
          "type": "text",
          "text": "3. Input Parameters"
        }
      ]
    },
    {
      "type": "bulletList",
      "content": [
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "@AccountNumer varchar(15)",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ": This parameter is the account number used to filter records in the queries. It is crucial for identifying and retrieving data specific to the account in question."
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "type": "heading",
      "attrs": {
        "level": 1
      },
      "content": [
        {
          "type": "text",
          "text": "4. Business Logic and Workflow"
        }
      ]
    },
    {
      "type": "bulletList",
      "content": [
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The procedure begins by querying the "
                },
                {
                  "type": "text",
                  "text": "ARCHIVEUploadAccountBillingDetail",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " table to retrieve historical billing details for the specified account number, ordering the results by "
                },
                {
                  "type": "text",
                  "text": "BillingPeriod",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " and "
                },
                {
                  "type": "text",
                  "text": "TransactionCode",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "It then queries the "
                },
                {
                  "type": "text",
                  "text": "UploadAccountBillingAdjustmentCrisGas",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " table to extract billing adjustments, using conditional logic to determine which arrears and miscellaneous charge amounts to display based on the billing period and its revision."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The procedure continues by querying the "
                },
                {
                  "type": "text",
                  "text": "UploadAccountBillingDetail",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " table twice, with different ordering criteria, to provide detailed billing information."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "It retrieves preloaded billing details from the "
                },
                {
                  "type": "text",
                  "text": "UploadAccountBillingDetailPreload",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " table, using a substring of the account number for filtering."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The "
                },
                {
                  "type": "text",
                  "text": "Billing.Account",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " table is queried to obtain account status and tariff information."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The procedure then joins "
                },
                {
                  "type": "text",
                  "text": "Billing.AccountBilling",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " with "
                },
                {
                  "type": "text",
                  "text": "Billing.AccountBillingCrisGas",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " to extract detailed billing and gas charge information, ordering by "
                },
                {
                  "type": "text",
                  "text": "BillingPeriodRevision",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Finally, it retrieves calculated billing amounts from "
                },
                {
                  "type": "text",
                  "text": "Billing.AccountBillingCrisGas",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ", again ordering by "
                },
                {
                  "type": "text",
                  "text": "BillingPeriodRevision",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "."
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "type": "heading",
      "attrs": {
        "level": 1
      },
      "content": [
        {
          "type": "text",
          "text": "5. Performance Considerations"
        }
      ]
    },
    {
      "type": "bulletList",
      "content": [
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The procedure executes multiple queries, which could lead to performance issues if the tables contain a large number of records."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The use of "
                },
                {
                  "type": "text",
                  "text": "ORDER BY",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " clauses in each query can be resource-intensive, especially if indexes are not properly configured on the columns used for sorting."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The repeated querying of the same tables with different ordering criteria may result in redundant data retrieval, potentially impacting performance."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The use of conditional logic and calculations within the "
                },
                {
                  "type": "text",
                  "text": "SELECT",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " statements can add computational overhead."
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "type": "heading",
      "attrs": {
        "level": 1
      },
      "content": [
        {
          "type": "text",
          "text": "6. Potential Issues or Risks"
        }
      ]
    },
    {
      "type": "bulletList",
      "content": [
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The procedure assumes that the account number is correctly formatted and exists in the database. If the account number is incorrect or does not exist, the queries will return no results."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The use of a substring in the "
                },
                {
                  "type": "text",
                  "text": "UploadAccountBillingDetailPreload",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " query may lead to incorrect or unexpected results if account numbers are not consistently formatted."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The procedure does not handle potential errors or exceptions, such as database connectivity issues or invalid input, which could lead to failures during execution."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The lack of transaction management means that if any part of the procedure fails, there is no rollback mechanism to maintain data consistency."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The procedure's reliance on specific table structures and column names means that any changes to the database schema could break the procedure or lead to incorrect results."
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "type": "heading",
      "attrs": {
        "level": 1
      },
      "content": [
        {
          "type": "text",
          "text": "7. Stored Procedure Definition"
        }
      ]
    },
    {
      "type": "codeBlock",
      "attrs": {
        "language": "sql"
      },
      "content": [
        {
          "type": "text",
          "text": "CREATE     procedure [CrisNationalGridWest].[usp_Util_CRIS_CompareVariousTablesByAccountNumer]\n    (\r\n      @AccountNumer varchar(15)\r\n    )\r\nas \r\n    begin\r\n\t\tselect  'ARCHIVEUploadAccountBillingDetail' AS TableName ,\r\n\t\t\t\tUploadAccountBillingDetailSeqid ,\r\n\t\t\t\tBillingPeriod ,\r\n\t\t\t\tBillingPeriodRevision ,\r\n\t\t\t\tFirstBillingPeriodCanceled ,\r\n\t\t\t\tIsSpannedBilling ,\r\n\t\t\t\tAccountNumber ,\r\n\t\t\t\tActivityDateTime ,\r\n\t\t\t\tTransactionCode ,\r\n\t\t\t\tBillingFromDate ,\r\n\t\t\t\tBillingToDate ,\r\n\t\t\t\tGasChargeAmount ,\r\n\t\t\t\tAccountArrears ,\r\n\t\t\t\tMiscellaneousChargeAmount ,\r\n\t\t\t\tCurrentAccountBalance ,\r\n\t\t\t\tCurrentAccountBalance - ( GasChargeAmount + AccountArrears\r\n\t\t\t\t\t\t\t\t\t\t  + MiscellaneousChargeAmount ) as NetPaidAdj ,\r\n\t\t\t\tBilledCCF ,\r\n\t\t\t\tBilledTherms\r\n\t\tFROM [CrisNationalGridWest].[ARCHIVEUploadAccountBillingDetail]\r\n\t\twhere   AccountNumber = @AccountNumer\r\n\t\torder by BillingPeriod  desc,TransactionCode desc\r\n\r\n\r\n        select  'UploadAccountBillingAdjustmentCrisGas' as TableName ,\r\n                IsSpannedBilling ,\r\n                BillingPeriod ,\r\n                BillingPeriodRevision ,\r\n                FirstBillingPeriodCanceled ,\r\n                AccountNumber ,\r\n                OriginalAccountNumber ,\r\n                 FromDate ,\r\n                ToDate ,\r\n                CancelFromDate ,\r\n                CancelToDate ,\r\n               GasRateCode ,\r\n                SpannedGasChargeAmount ,\r\n                SpannedBilledTherms ,\r\n                SpannedBilledCCF ,\r\n                PaidAdjustmentAmount ,\r\n                TotalNetPaidAdjustmentCalc ,\r\n                GasChargeAmount ,\r\n                RevisedGasChargeAmount ,\r\n                case when BillingPeriod = BillingPeriodRevision\r\n                     then AccountArrears\r\n                     else PriorAccountArrears\r\n                end as AccountArrears ,\r\n                case when BillingPeriod = BillingPeriodRevision\r\n                     then MiscellaneousChargeAmount\r\n                     else PriorMiscellaneousChargeAmount\r\n                end as MiscellaneousChargeAmount ,\r\n                CurrentAccountBalance ,\r\n                OriginalBilledAmount ,\r\n                RevisedBilledAmount ,\r\n                CancelBilledAmount ,\r\n                NetChangeDollars ,\r\n                OriginalTherms ,\r\n                RevisedTherms ,\r\n                CancelTherms ,\r\n                NetChangeTherms ,\r\n                OriginalCCF ,\r\n                RevisedCCF ,\r\n                CancelCCF ,\r\n                NetChangeCCF ,\r\n                PriorPeriodAccountBalance ,\r\n                TerminationBalance ,\r\n                TotalPaymentsPosted ,\r\n                Notes\r\n        FROM CrisNationalGridWest.UploadAccountBillingAdjustmentCrisGas\r\n        where   ( AccountNumber = @AccountNumer )\r\norder by  BillingPeriodRevision desc\r\n\r\n\t\tselect  'UploadAccountBillingDetail' AS TableName ,\r\n\t\t\t\tUploadAccountBillingDetailSeqid ,\r\n\t\t\t\tBillingPeriod ,\r\n\t\t\t\tBillingPeriodRevision ,\r\n\t\t\t\tFirstBillingPeriodCanceled ,\r\n\t\t\t\tIsSpannedBilling ,\r\n\t\t\t\tAccountNumber ,\r\n\t\t\t\tActivityDateTime ,\r\n\t\t\t\tTransactionCode ,\r\n\t\t\t\t\tBillingFromDate ,\r\n\t\t\t\tBillingToDate ,\t\t\t\r\n\t\t\t\tGasChargeAmount ,\r\n\t\t\t\tAccountArrears ,\r\n\t\t\t\tMiscellaneousChargeAmount ,\r\n\t\t\t\tCurrentAccountBalance ,\r\n\t\t\t\tCurrentAccountBalance - ( GasChargeAmount + AccountArrears\r\n\t\t\t\t\t\t\t\t\t\t  + MiscellaneousChargeAmount ) as NetPaidAdj ,\r\n\r\n\t\t\t\tBilledCCF ,\r\n\t\t\t\tBilledTherms\r\n\t\tFROM CrisNationalGridWest.UploadAccountBillingDetail\r\n\t\twhere   AccountNumber = @AccountNumer\r\n\t\torder by BillingPeriodRevision desc ,TransactionCode desc,ActivityDateTime desc\r\n\r\n        \r\n        select  'UploadAccountBillingDetail' ,\r\n                TransactionCode ,\r\n                ActivityDate ,\r\n                ActivityTime ,\r\n                BillingPeriod ,\r\n                BillingPeriodRevision ,\r\n                IsSpannedBilling ,\r\n                AccountNumber ,\r\n                BillingFromDate ,\r\n                BillingToDate ,\r\n                GasChargeAmount ,\r\n                AccountArrears ,\r\n                MiscellaneousChargeAmount ,\r\n                CurrentAccountBalance ,\r\n                BilledTherms ,\r\n                BilledCCF\r\n        FROM CrisNationalGridWest.UploadAccountBillingDetail\r\n        where   ( AccountNumber = @AccountNumer )\r\n        order by BillingPeriodRevision desc,TransactionCode desc,ActivityDate desc,ActivityTime desc\r\n\r\n        select  'UploadAccountBillingDetailPreload' ,\r\n                BillingPeriod ,\r\n                BillingPeriodRevision ,\r\n                AccountNumber ,\r\n\t\t\t\tTransactionCode,\r\n                ActivityDate ,\r\n                ActivityTime ,\r\n                BillingFromDate ,\r\n                BillingToDate ,\r\n                GasChargeAmount ,\r\n                AccountArrears ,\r\n                MiscellaneousChargeAmount ,\r\n                CurrentAccountBalance ,\r\n                BilledCCF ,\r\n                BilledTherms\r\n        FROM CrisNationalGridWest.UploadAccountBillingDetailPreload\r\n        where   ( AccountNumber = substring(@AccountNumer, 1, 11) )\r\n        order by TransactionCode,\r\n\t\t\t\t ActivityDate desc ,\r\n                 ActivityTime desc\r\n\r\n        select  AccountSeqid ,\r\n                CurrentAccountNumber ,\r\n                OriginalAccountNumber ,\r\n                AccountStatus ,\r\n                AccountPreviousStatus ,\r\n                AccountStatusCodePeriod ,\r\n                AccountEffectiveTurnOn ,\r\n                AccountEffectiveTurnOff ,\r\n                DeliveryTariffRate ,\r\n                DeliveryTariffEffectiveDate ,\r\n                CommodityTariffRate ,\r\n                CommodityTariffEffectiveDate ,\r\n                UtilityServiceAddress ,\r\n                Notes\r\n        FROM Billing.Account\r\n        where   ( CurrentAccountNumber = @AccountNumer )\r\n \r\n     \r\n        select  'Billing.AccountBilling' as TableName ,\r\n                Billing.AccountBilling.OriginalAccountNumber ,\r\n                Billing.AccountBilling.BillingPeriodRevision ,\r\n                Billing.AccountBilling.FromDate ,\r\n                Billing.AccountBilling.ToDate ,\r\n                Billing.AccountBilling.ManualPaymentOverrideAmount ,\r\n                Billing.AccountBilling.TotalAmountDue ,\r\n                Billing.AccountBilling.OriginalBilledAmount ,\r\n                Billing.AccountBilling.RevisedBilledAmount ,\r\n                Billing.AccountBilling.PaidAdjustmentAmount ,\r\n                Billing.AccountBilling.AccountEnergyUsage ,\r\n                Billing.AccountBilling.OriginalEnergyUsage ,\r\n                Billing.AccountBilling.NetDollarChange ,\r\n                Billing.AccountBilling.NetEnergyUsageChange\r\n        FROM Billing.AccountBilling\r\n                inner join Billing.AccountBillingCrisGas on Billing.AccountBilling.AccountBillingSeqid = Billing.AccountBillingCrisGas.AccountBillingSeqid\r\n        where   ( Billing.AccountBilling.OriginalAccountNumber = @AccountNumer )\r\n        order by Billing.AccountBilling.BillingPeriodRevision desc\r\n\r\n        select  'Billing.AccountBillingCrisGas' ,\r\n                Billing.AccountBilling.OriginalAccountNumber ,\r\n                Billing.AccountBillingCrisGas.BillingPeriodRevision ,\r\n                Billing.AccountBillingCrisGas.OriginalGasChargeAmount\r\n                + Billing.AccountBillingCrisGas.AccountArrears\r\n                + Billing.AccountBillingCrisGas.MiscellaneousChargeAmount as calcOriginalBilledAmount ,\r\n                Billing.AccountBillingCrisGas.RevisedGasChargeAmount\r\n                + Billing.AccountBillingCrisGas.AccountArrears\r\n                + Billing.AccountBillingCrisGas.MiscellaneousChargeAmount as calcRevisedBilledAmount ,\r\n                Billing.AccountBillingCrisGas.OriginalGasChargeAmount ,\r\n                Billing.AccountBillingCrisGas.RevisedGasChargeAmount ,\r\n                Billing.AccountBillingCrisGas.AccountArrears ,\r\n                Billing.AccountBillingCrisGas.MiscellaneousChargeAmount ,\r\n                Billing.AccountBillingCrisGas.BilledCCF ,\r\n                Billing.AccountBillingCrisGas.BilledTherms\r\n        FROM Billing.AccountBilling\r\n                inner join Billing.AccountBillingCrisGas on Billing.AccountBilling.AccountBillingSeqid = Billing.AccountBillingCrisGas.AccountBillingSeqid\r\n        where   ( Billing.AccountBilling.OriginalAccountNumber = @AccountNumer )\r\n        order by Billing.AccountBillingCrisGas.BillingPeriodRevision desc    \r\n\r\n    end"
        }
      ]
    }
  ]
}