{
  "version": 1,
  "type": "doc",
  "content": [
    {
      "type": "bodiedExtension",
      "attrs": {
        "extensionType": "com.atlassian.confluence.macro.core",
        "extensionKey": "details",
        "parameters": {
          "macroParams": {
            "hidden": {
              "value": "true"
            }
          },
          "macroMetadata": {
            "schemaVersion": {
              "value": "1"
            },
            "title": "Page Properties"
          }
        }
      },
      "content": [
        {
          "type": "table",
          "attrs": {
            "isNumberColumnEnabled": false,
            "layout": "default"
          },
          "content": [
            {
              "type": "tableRow",
              "content": [
                {
                  "type": "tableHeader",
                  "attrs": {
                    "colspan": 1,
                    "background": "#f4f5f7",
                    "rowspan": 1
                  },
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "text": "Schema Name",
                          "type": "text",
                          "marks": [
                            {
                              "type": "strong"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "attrs": {
                    "colspan": 1,
                    "rowspan": 1
                  },
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "text": "Published",
                          "type": "text"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": "tableRow",
              "content": [
                {
                  "type": "tableHeader",
                  "attrs": {
                    "colspan": 1,
                    "background": "#f4f5f7",
                    "rowspan": 1
                  },
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "text": "Stored Procedure Name",
                          "type": "text",
                          "marks": [
                            {
                              "type": "strong"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "attrs": {
                    "colspan": 1,
                    "rowspan": 1
                  },
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "text": "usp_Utility_DeleteAndReSeedSequenceIdPublishedData",
                          "type": "text"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": "tableRow",
              "content": [
                {
                  "type": "tableHeader",
                  "attrs": {
                    "colspan": 1,
                    "background": "#f4f5f7",
                    "rowspan": 1
                  },
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "text": "Complexity Level",
                          "type": "text",
                          "marks": [
                            {
                              "type": "strong"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "attrs": {
                    "colspan": 1,
                    "rowspan": 1
                  },
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "text": "Medium",
                          "type": "text"
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "type": "heading",
      "attrs": {
        "level": 1
      },
      "content": [
        {
          "type": "text",
          "text": "1. Overview"
        }
      ]
    },
    {
      "type": "paragraph",
      "content": [
        {
          "type": "text",
          "text": "The stored procedure "
        },
        {
          "type": "text",
          "text": "usp_Utility_DeleteAndReSeedSequenceIdPublishedData",
          "marks": [
            {
              "type": "code"
            }
          ]
        },
        {
          "type": "text",
          "text": " is designed to manage data within a set of tables in the "
        },
        {
          "type": "text",
          "text": "Published",
          "marks": [
            {
              "type": "code"
            }
          ]
        },
        {
          "type": "text",
          "text": " schema. It deletes records for a specified billing period and reseeds the identity columns of these tables to ensure that the sequence numbers are contiguous after deletions. This procedure is used to maintain data integrity and sequence continuity across multiple tables related to energy usage and financial data."
        }
      ]
    },
    {
      "type": "heading",
      "attrs": {
        "level": 1
      },
      "content": [
        {
          "type": "text",
          "text": "2. Complexity Level: Medium"
        }
      ]
    },
    {
      "type": "paragraph",
      "content": [
        {
          "type": "text",
          "text": "The complexity of this stored procedure is considered medium due to the following factors:"
        }
      ]
    },
    {
      "type": "bulletList",
      "content": [
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "It involves multiple operations across several tables."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "It uses dynamic identity reseeding, which requires careful handling to avoid data integrity issues."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "It includes repetitive tasks that must be executed in a specific order to maintain consistency."
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "type": "heading",
      "attrs": {
        "level": 1
      },
      "content": [
        {
          "type": "text",
          "text": "3. Input Parameters"
        }
      ]
    },
    {
      "type": "bulletList",
      "content": [
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "@PublishedBillingPeriod varchar(6)",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ": This parameter specifies the billing period for which records should be deleted. It is expected to be in a format that can be represented within six characters, indicating a year and month (e.g., '202301' for January 2023)."
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "type": "heading",
      "attrs": {
        "level": 1
      },
      "content": [
        {
          "type": "text",
          "text": "4. Business Logic and Workflow"
        }
      ]
    },
    {
      "type": "orderedList",
      "content": [
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Initialization",
                  "marks": [
                    {
                      "type": "strong"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ": The procedure begins by declaring a variable "
                },
                {
                  "type": "text",
                  "text": "@maxRowNumber",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " to store the maximum sequence ID value for reseeding purposes."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Table Operations",
                  "marks": [
                    {
                      "type": "strong"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ": For each table in the "
                },
                {
                  "type": "text",
                  "text": "Published",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " schema:"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "type": "bulletList",
      "content": [
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Check Identity",
                  "marks": [
                    {
                      "type": "strong"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ": The "
                },
                {
                  "type": "text",
                  "text": "DBCC CHECKIDENT",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " command is used with "
                },
                {
                  "type": "text",
                  "text": "NoRESEED",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " to ensure the current identity value is known."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Delete Records",
                  "marks": [
                    {
                      "type": "strong"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ": Records matching the specified "
                },
                {
                  "type": "text",
                  "text": "@PublishedBillingPeriod",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " are deleted."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Determine Max Sequence ID",
                  "marks": [
                    {
                      "type": "strong"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ": The maximum sequence ID is retrieved from the table to determine the new seed value."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Reseed Identity",
                  "marks": [
                    {
                      "type": "strong"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ": The identity column is reseeded to the maximum sequence ID value to ensure continuity."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Log Operation",
                  "marks": [
                    {
                      "type": "strong"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ": A message is printed to indicate the reseeding operation for each table."
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "type": "orderedList",
      "content": [
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Tables Involved",
                  "marks": [
                    {
                      "type": "strong"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ": The procedure operates on multiple tables, including:"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "type": "bulletList",
      "content": [
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "EnergyUsageSummaryGroupByAgencyAndEnergyType",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "AccountLevelRawDataForCurrentPeriod",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "AccountLevelSummaryByAgency",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "AccountLevelSummaryByCityWide",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "AccountLevelSummaryByFacility",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "AccountLevelSummaryForDollarsBtusAndCo2",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "AccountMeterLevelRawDataForCurrentPeriod",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "FiscalYearPivotByAgencyAndFacilityDollarsAndUsage",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "FiscalYearPivotByAgencyDollarsAndUsage",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "FiscalYearPivotByAgencyFacilityAndAccountDollarsAndUsage",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "FiscalYearPivotByEncoreMonthlyPayments",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "MonthlyPublishedSummaryData",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "type": "orderedList",
      "content": [
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Commented Code",
                  "marks": [
                    {
                      "type": "strong"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ": There is a section of commented-out code related to the "
                },
                {
                  "type": "text",
                  "text": "FiscalYearPivotByUtilityInvoiceAccountBillingGroupDollarsAndUsage",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " table, indicating it be temporarily excluded from the procedure."
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "type": "heading",
      "attrs": {
        "level": 1
      },
      "content": [
        {
          "type": "text",
          "text": "5. Performance Considerations"
        }
      ]
    },
    {
      "type": "bulletList",
      "content": [
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Transaction Management",
                  "marks": [
                    {
                      "type": "strong"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ": The procedure does not explicitly use transactions, which leads to partial updates if an error occurs. Implementing transactions ensure atomicity."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Indexing",
                  "marks": [
                    {
                      "type": "strong"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ": Ensure that the "
                },
                {
                  "type": "text",
                  "text": "PublishedBillingPeriod",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " column is indexed to optimize the DELETE operations."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Concurrency",
                  "marks": [
                    {
                      "type": "strong"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ": The procedure locks tables during DELETE operations, which impact performance in a high-concurrency environment."
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "type": "heading",
      "attrs": {
        "level": 1
      },
      "content": [
        {
          "type": "text",
          "text": "6. Potential Issues or Risks"
        }
      ]
    },
    {
      "type": "bulletList",
      "content": [
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Data Integrity",
                  "marks": [
                    {
                      "type": "strong"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ": If the maximum sequence ID is not correctly calculated or if the reseeding fails, it could lead to identity conflicts or gaps."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Concurrency Issues",
                  "marks": [
                    {
                      "type": "strong"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ": Without proper transaction handling, concurrent executions could lead to race conditions or deadlocks."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Error Handling",
                  "marks": [
                    {
                      "type": "strong"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ": The procedure lacks error handling, which could result in unhandled exceptions and inconsistent states."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Scalability",
                  "marks": [
                    {
                      "type": "strong"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ": As the number of tables and records grows, the procedure may become a bottleneck due to its sequential processing nature."
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "type": "heading",
      "attrs": {
        "level": 1
      },
      "content": [
        {
          "type": "text",
          "text": "7. Stored Procedure Definition"
        }
      ]
    },
    {
      "type": "codeBlock",
      "attrs": {
        "language": "sql"
      },
      "content": [
        {
          "type": "text",
          "text": "CREATE   PROCEDURE [Published].[usp_Utility_DeleteAndReSeedSequenceIdPublishedData]    (\t@PublishedBillingPeriod varchar(6))\nAS\r\nBegin\r\ndeclare @maxRowNumber int\r\n--\r\nDBCC CHECKIDENT ('Published.EnergyUsageSummaryGroupByAgencyAndEnergyType', NoRESEED)\r\nDELETE FROM Published.EnergyUsageSummaryGroupByAgencyAndEnergyType WHERE [PublishedBillingPeriod] = @PublishedBillingPeriod\r\n\r\nselect @maxRowNumber = max(EnergyUsageSummaryGroupByAgencyAndEnergyTypeSeqid)  FROM Published.EnergyUsageSummaryGroupByAgencyAndEnergyType\r\n--\r\nDBCC CHECKIDENT ('Published.EnergyUsageSummaryGroupByAgencyAndEnergyType', RESEED,@maxRowNumber)\r\n--\r\nprint 'Published.AccountLevelRawDataForCurrentPeriod: reseeded: '+str(@maxRowNumber)\r\n--\r\nDBCC CHECKIDENT ('Published.AccountLevelRawDataForCurrentPeriod', NoRESEED)\r\nDELETE FROM Published.AccountLevelRawDataForCurrentPeriod WHERE [PublishedBillingPeriod] = @PublishedBillingPeriod\r\n\r\nselect @maxRowNumber = max(RawDataForCurrentPeriodSeqid)  FROM Published.AccountLevelRawDataForCurrentPeriod\r\n--\r\nDBCC CHECKIDENT ('Published.AccountLevelRawDataForCurrentPeriod', RESEED,@maxRowNumber)\r\n--\r\nprint 'Published.AccountLevelRawDataForCurrentPeriod: reseeded: '+str(@maxRowNumber)\r\n--\r\nDBCC CHECKIDENT ('Published.AccountLevelRawDataForCurrentPeriod', NoRESEED)\r\n--\r\n--\r\nDBCC CHECKIDENT ('Published.AccountLevelSummaryByAgency', NoRESEED)\r\n\r\nDELETE FROM Published.AccountLevelSummaryByAgency WHERE [PublishedBillingPeriod] = @PublishedBillingPeriod\r\n\r\nselect @maxRowNumber = max(AccountLevelSummaryByAgencySeqid)  FROM Published.AccountLevelSummaryByAgency\r\n--\r\nDBCC CHECKIDENT ('Published.AccountLevelSummaryByAgency', RESEED,@maxRowNumber)\r\n--\r\nprint 'Published.AccountLevelSummaryByAgency: reseeded: '+str(@maxRowNumber)\r\n--\r\nDBCC CHECKIDENT ('Published.AccountLevelSummaryByAgency', NoRESEED)\r\n--\r\n\r\nDBCC CHECKIDENT ('Published.AccountLevelSummaryByCityWide', NoRESEED)\r\nDELETE FROM Published.AccountLevelSummaryByCityWide WHERE [PublishedBillingPeriod] = @PublishedBillingPeriod\r\n\r\nselect @maxRowNumber = max(AccountLevelSummaryByCityWideSeqid)  FROM Published.AccountLevelSummaryByCityWide\r\n--\r\nDBCC CHECKIDENT ('Published.AccountLevelSummaryByCityWide', RESEED,@maxRowNumber)\r\n--\r\nprint 'Published.AccountLevelSummaryByCityWide: reseeded: '+str(@maxRowNumber)\r\n--\r\nDBCC CHECKIDENT ('Published.AccountLevelSummaryByCityWide', NoRESEED)\r\n--\r\n--\r\nDBCC CHECKIDENT ('Published.AccountLevelSummaryByFacility', NoRESEED)\r\nDELETE FROM Published.AccountLevelSummaryByFacility WHERE [PublishedBillingPeriod] = @PublishedBillingPeriod\r\n\r\nselect @maxRowNumber = max(AccountLevelSummaryByFacilitySeqid)  FROM Published.AccountLevelSummaryByFacility\r\n--\r\nDBCC CHECKIDENT ('Published.AccountLevelSummaryByFacility', RESEED,@maxRowNumber)\r\n--\r\nprint 'Published.AccountLevelSummaryByFacility: reseeded: '+str(@maxRowNumber)\r\n--\r\nDBCC CHECKIDENT ('Published.AccountLevelSummaryByFacility', NoRESEED)\r\n--\r\nDBCC CHECKIDENT ('Published.AccountLevelSummaryForDollarsBtusAndCo2', NoRESEED)\r\nDELETE FROM Published.AccountLevelSummaryForDollarsBtusAndCo2 WHERE [PublishedBillingPeriod] = @PublishedBillingPeriod\r\n\r\nselect @maxRowNumber = max(AccountLevelSummaryForDollarsBtusAndCo2Seqid)  FROM Published.AccountLevelSummaryForDollarsBtusAndCo2\r\n--\r\nDBCC CHECKIDENT ('Published.AccountLevelSummaryForDollarsBtusAndCo2', RESEED,@maxRowNumber)\r\n--\r\nprint 'Published.AccountLevelSummaryForDollarsBtusAndCo2: reseeded: '+str(@maxRowNumber)\r\n--\r\nDBCC CHECKIDENT ('Published.AccountLevelSummaryForDollarsBtusAndCo2', NoRESEED)\r\n--\r\n--\r\nDBCC CHECKIDENT ('Published.AccountMeterLevelRawDataForCurrentPeriod', NoRESEED)\r\nDELETE FROM Published.AccountMeterLevelRawDataForCurrentPeriod WHERE [PublishedBillingPeriod] = @PublishedBillingPeriod\r\n\r\nselect @maxRowNumber = max(AccountMeterLevelRawDataForCurrentPeriodSeqid)  FROM Published.AccountMeterLevelRawDataForCurrentPeriod\r\n--\r\nDBCC CHECKIDENT ('Published.AccountMeterLevelRawDataForCurrentPeriod', RESEED,@maxRowNumber)\r\n--\r\nprint 'Published.AccountMeterLevelRawDataForCurrentPeriod: reseeded: '+str(@maxRowNumber)\r\n--\r\nDBCC CHECKIDENT ('Published.AccountMeterLevelRawDataForCurrentPeriod', NoRESEED)\r\n--\r\nDBCC CHECKIDENT ('Published.FiscalYearPivotByAgencyAndFacilityDollarsAndUsage', NoRESEED)\r\nDELETE FROM Published.FiscalYearPivotByAgencyAndFacilityDollarsAndUsage WHERE [PublishedBillingPeriod] = @PublishedBillingPeriod\r\n\r\nselect @maxRowNumber = max(FiscalYearPivotByAgencyAndFacilityDollarsAndUsageSeqid)  FROM Published.FiscalYearPivotByAgencyAndFacilityDollarsAndUsage\r\n--\r\nDBCC CHECKIDENT ('Published.FiscalYearPivotByAgencyAndFacilityDollarsAndUsage', RESEED,@maxRowNumber)\r\n--\r\nprint 'Published.FiscalYearPivotByAgencyAndFacilityDollarsAndUsage: reseeded: '+str(@maxRowNumber)\r\n--\r\nDBCC CHECKIDENT ('Published.FiscalYearPivotByAgencyAndFacilityDollarsAndUsage', NoRESEED)\r\n--\r\n\r\nDBCC CHECKIDENT ('Published.FiscalYearPivotByAgencyDollarsAndUsage', NoRESEED)\r\nDELETE FROM Published.FiscalYearPivotByAgencyDollarsAndUsage WHERE [PublishedBillingPeriod] = @PublishedBillingPeriod\r\n\r\nselect @maxRowNumber = max(FiscalYearPivotByAgencyDollarsAndUsageSeqid)  FROM Published.FiscalYearPivotByAgencyDollarsAndUsage\r\n--\r\nDBCC CHECKIDENT ('Published.FiscalYearPivotByAgencyDollarsAndUsage', RESEED,@maxRowNumber)\r\n--\r\nprint 'Published.FiscalYearPivotByAgencyDollarsAndUsage: reseeded: '+str(@maxRowNumber)\r\n--\r\nDBCC CHECKIDENT ('Published.FiscalYearPivotByAgencyDollarsAndUsage', NoRESEED)\r\n--\r\nDBCC CHECKIDENT ('Published.FiscalYearPivotByAgencyDollarsAndUsage', NoRESEED)\r\nDELETE FROM Published.FiscalYearPivotByAgencyDollarsAndUsage WHERE [PublishedBillingPeriod] = @PublishedBillingPeriod\r\n\r\nselect @maxRowNumber = max(FiscalYearPivotByAgencyDollarsAndUsageSeqid)  FROM Published.FiscalYearPivotByAgencyDollarsAndUsage\r\n--\r\nDBCC CHECKIDENT ('Published.FiscalYearPivotByAgencyDollarsAndUsage', RESEED,@maxRowNumber)\r\n--\r\nprint 'Published.FiscalYearPivotByAgencyDollarsAndUsage: reseeded: '+str(@maxRowNumber)\r\n--\r\nDBCC CHECKIDENT ('Published.FiscalYearPivotByAgencyDollarsAndUsage', NoRESEED)\r\n--\r\n--\r\n\r\nDBCC CHECKIDENT ('Published.FiscalYearPivotByAgencyFacilityAndAccountDollarsAndUsage', NoRESEED)\r\nDELETE FROM Published.FiscalYearPivotByAgencyFacilityAndAccountDollarsAndUsage WHERE [PublishedBillingPeriod] = @PublishedBillingPeriod\r\n\r\nselect @maxRowNumber = max(FiscalYearPivotByAgencyFacilityAndAccountDollarsAndUsageSeqid)  FROM Published.FiscalYearPivotByAgencyFacilityAndAccountDollarsAndUsage\r\n--\r\nDBCC CHECKIDENT ('Published.FiscalYearPivotByAgencyFacilityAndAccountDollarsAndUsage', RESEED,@maxRowNumber)\r\n--\r\nprint 'Published.FiscalYearPivotByAgencyFacilityAndAccountDollarsAndUsage: reseeded: '+str(@maxRowNumber)\r\n--\r\nDBCC CHECKIDENT ('Published.FiscalYearPivotByAgencyFacilityAndAccountDollarsAndUsage', NoRESEED)\r\n--\r\n--\r\nDBCC CHECKIDENT ('Published.FiscalYearPivotByEncoreMonthlyPayments', NoRESEED)\r\nDELETE FROM Published.FiscalYearPivotByEncoreMonthlyPayments WHERE [PublishedBillingPeriod] = @PublishedBillingPeriod\r\n\r\nselect @maxRowNumber = max(FiscalYearPivotByEncoreMonthlyPaymentsSeqid)  FROM Published.FiscalYearPivotByEncoreMonthlyPayments\r\n--\r\nDBCC CHECKIDENT ('Published.FiscalYearPivotByEncoreMonthlyPayments', RESEED,@maxRowNumber)\r\n--\r\nprint 'Published.FiscalYearPivotByEncoreMonthlyPayments: reseeded: '+str(@maxRowNumber)\r\n--\r\nDBCC CHECKIDENT ('Published.FiscalYearPivotByEncoreMonthlyPayments', NoRESEED)\r\n--\r\n\r\n\r\n--DBCC CHECKIDENT ('Published.FiscalYearPivotByUtilityInvoiceAccountBillingGroupDollarsAndUsage', NoRESEED)\r\n--DELETE FROM Published.FiscalYearPivotByUtilityInvoiceAccountBillingGroupDollarsAndUsage WHERE [PublishedBillingPeriod] = @PublishedBillingPeriod\r\n\r\n--select @maxRowNumber = max(FiscalYearPivotByUtilityInvoiceAccountBillingGroupDollarsAndUsageSeqid)  FROM Published.FiscalYearPivotByUtilityInvoiceAccountBillingGroupDollarsAndUsage\r\n----\r\n--DBCC CHECKIDENT ('Published.FiscalYearPivotByUtilityInvoiceAccountBillingGroupDollarsAndUsage', RESEED,@maxRowNumber)\r\n----\r\n--print 'Published.FiscalYearPivotByUtilityInvoiceAccountBillingGroupDollarsAndUsage: reseeded: '+str(@maxRowNumber)\r\n----\r\n--DBCC CHECKIDENT ('Published.FiscalYearPivotByUtilityInvoiceAccountBillingGroupDollarsAndUsage', NoRESEED)\r\n----\r\nDBCC CHECKIDENT ('Published.MonthlyPublishedSummaryData', NoRESEED)\r\nDELETE FROM Published.MonthlyPublishedSummaryData WHERE [PublishedBillingPeriod] = @PublishedBillingPeriod\r\n\r\nselect @maxRowNumber = max(MonthlyPublishedSummaryDataSEqid)  FROM Published.MonthlyPublishedSummaryData\r\n--\r\nDBCC CHECKIDENT ('Published.MonthlyPublishedSummaryData', RESEED,@maxRowNumber)\r\n--\r\nprint 'Published.MonthlyPublishedSummaryData: reseeded: '+str(@maxRowNumber)\r\n--\r\nDBCC CHECKIDENT ('Published.MonthlyPublishedSummaryData', NoRESEED)\r\n--\r\nEnd"
        }
      ]
    }
  ]
}