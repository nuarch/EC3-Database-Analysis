{
  "version": 1,
  "type": "doc",
  "content": [
    {
      "type": "bodiedExtension",
      "attrs": {
        "extensionType": "com.atlassian.confluence.macro.core",
        "extensionKey": "details",
        "parameters": {
          "macroParams": {
            "hidden": {
              "value": "true"
            }
          },
          "macroMetadata": {
            "schemaVersion": {
              "value": "1"
            },
            "title": "Page Properties"
          }
        }
      },
      "content": [
        {
          "type": "table",
          "attrs": {
            "isNumberColumnEnabled": false,
            "layout": "default"
          },
          "content": [
            {
              "type": "tableRow",
              "content": [
                {
                  "type": "tableHeader",
                  "attrs": {
                    "colspan": 1,
                    "background": "#f4f5f7",
                    "rowspan": 1
                  },
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "text": "Schema Name",
                          "type": "text",
                          "marks": [
                            {
                              "type": "strong"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "attrs": {
                    "colspan": 1,
                    "rowspan": 1
                  },
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "text": "NationalGridWest",
                          "type": "text"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": "tableRow",
              "content": [
                {
                  "type": "tableHeader",
                  "attrs": {
                    "colspan": 1,
                    "background": "#f4f5f7",
                    "rowspan": 1
                  },
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "text": "Stored Procedure Name",
                          "type": "text",
                          "marks": [
                            {
                              "type": "strong"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "attrs": {
                    "colspan": 1,
                    "rowspan": 1
                  },
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "text": "usp_Cris_ProcessAccountData",
                          "type": "text"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": "tableRow",
              "content": [
                {
                  "type": "tableHeader",
                  "attrs": {
                    "colspan": 1,
                    "background": "#f4f5f7",
                    "rowspan": 1
                  },
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "text": "Complexity Level",
                          "type": "text",
                          "marks": [
                            {
                              "type": "strong"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "attrs": {
                    "colspan": 1,
                    "rowspan": 1
                  },
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "text": "Medium",
                          "type": "text"
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "type": "heading",
      "attrs": {
        "level": 1
      },
      "content": [
        {
          "type": "text",
          "text": "1. Overview"
        }
      ]
    },
    {
      "type": "paragraph",
      "content": [
        {
          "type": "text",
          "text": "The stored procedure "
        },
        {
          "type": "text",
          "text": "usp_Cris_ProcessAccountData",
          "marks": [
            {
              "type": "code"
            }
          ]
        },
        {
          "type": "text",
          "text": " is designed to process account data for a utility company, specifically for gas billing adjustments. It operates within the "
        },
        {
          "type": "text",
          "text": "NationalGridWest",
          "marks": [
            {
              "type": "code"
            }
          ]
        },
        {
          "type": "text",
          "text": " schema and is responsible for transferring data from the "
        },
        {
          "type": "text",
          "text": "UploadCrisAccountMeterBilling",
          "marks": [
            {
              "type": "code"
            }
          ]
        },
        {
          "type": "text",
          "text": " table to the "
        },
        {
          "type": "text",
          "text": "UploadLegacyKeyspanWestAccountBillingAdjustmentGas",
          "marks": [
            {
              "type": "code"
            }
          ]
        },
        {
          "type": "text",
          "text": " table. The procedure begins by truncating the target table, effectively clearing it of any existing data, and then populates it with new data based on specific criteria and transformations."
        }
      ]
    },
    {
      "type": "heading",
      "attrs": {
        "level": 1
      },
      "content": [
        {
          "type": "text",
          "text": "2. Complexity Level: Medium"
        }
      ]
    },
    {
      "type": "paragraph",
      "content": [
        {
          "type": "text",
          "text": "The complexity of this stored procedure is considered medium due to the following factors:"
        }
      ]
    },
    {
      "type": "bulletList",
      "content": [
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "It involves data transformation and insertion operations."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "It uses a TRUNCATE operation, which requires careful handling to avoid data loss."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "It involves multiple fields with specific business logic for data mapping."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "It includes a conditional data selection from the source table."
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "type": "heading",
      "attrs": {
        "level": 1
      },
      "content": [
        {
          "type": "text",
          "text": "3. Input Parameters"
        }
      ]
    },
    {
      "type": "bulletList",
      "content": [
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "@AuthenticatedUserID INT",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ": This parameter is used to track the user who initiated the procedure. It is inserted into the "
                },
                {
                  "type": "text",
                  "text": "AuthenticatedUserID",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " column of the target table to maintain an audit trail of who processed the data."
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "type": "heading",
      "attrs": {
        "level": 1
      },
      "content": [
        {
          "type": "text",
          "text": "4. Business Logic and Workflow"
        }
      ]
    },
    {
      "type": "orderedList",
      "content": [
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Truncate Operation",
                  "marks": [
                    {
                      "type": "strong"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ": The procedure starts by truncating the "
                },
                {
                  "type": "text",
                  "text": "UploadLegacyKeyspanWestAccountBillingAdjustmentGas",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " table, which removes all existing rows. This ensures that the table is ready to receive fresh data without any remnants from previous operations."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Data Insertion",
                  "marks": [
                    {
                      "type": "strong"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ": The procedure inserts data into the truncated table. The data is sourced from the "
                },
                {
                  "type": "text",
                  "text": "UploadCrisAccountMeterBilling",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " table, filtered by "
                },
                {
                  "type": "text",
                  "text": "transactionType = 'A'",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ". This indicates that only records marked with this transaction type are considered for processing."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Data Mapping and Transformation",
                  "marks": [
                    {
                      "type": "strong"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ": The procedure maps and transforms data from the source table to the target table. Specific columns are populated with values from the source table, while others are set to default or calculated values. For example:"
                }
              ]
            },
            {
              "type": "bulletList",
              "content": [
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "BillingAction",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": " is set to 'O' (original)."
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "GasRateCode",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": " is set to '262'."
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "SalesType",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": " is set to 'BT'."
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "ProcessEffectiveDate",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": " is set using a custom function "
                        },
                        {
                          "type": "text",
                          "text": "[dbo].ConvertDateToYYYYMMDD(GETDATE())",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": "."
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Audit and Metadata",
                  "marks": [
                    {
                      "type": "strong"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ": The procedure records metadata such as the "
                },
                {
                  "type": "text",
                  "text": "AuthenticatedUserID",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ", "
                },
                {
                  "type": "text",
                  "text": "DateAdded",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ", and "
                },
                {
                  "type": "text",
                  "text": "LastUpdate",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " to maintain an audit trail and track when the data was processed."
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "type": "heading",
      "attrs": {
        "level": 1
      },
      "content": [
        {
          "type": "text",
          "text": "5. Performance Considerations"
        }
      ]
    },
    {
      "type": "bulletList",
      "content": [
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Truncate Operation",
                  "marks": [
                    {
                      "type": "strong"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ": The use of "
                },
                {
                  "type": "text",
                  "text": "TRUNCATE TABLE",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " is efficient for clearing data but should be used with caution as it does not log individual row deletions, making it non-recoverable through transaction logs."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Bulk Insert",
                  "marks": [
                    {
                      "type": "strong"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ": The procedure performs a bulk insert operation, which is generally efficient. However, the performance can be affected by the size of the data being inserted and the complexity of the transformations."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Indexing",
                  "marks": [
                    {
                      "type": "strong"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ": Ensure that the target table is appropriately indexed to handle the insert operations efficiently, especially if the table is large or frequently accessed."
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "type": "heading",
      "attrs": {
        "level": 1
      },
      "content": [
        {
          "type": "text",
          "text": "6. Potential Issues or Risks"
        }
      ]
    },
    {
      "type": "bulletList",
      "content": [
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Data Loss",
                  "marks": [
                    {
                      "type": "strong"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ": The "
                },
                {
                  "type": "text",
                  "text": "TRUNCATE TABLE",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " operation can lead to data loss if not handled correctly. Ensure that the data being truncated is no longer needed or has been backed up."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Concurrency",
                  "marks": [
                    {
                      "type": "strong"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ": If multiple processes attempt to run this procedure simultaneously, it could lead to data integrity issues or deadlocks."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Error Handling",
                  "marks": [
                    {
                      "type": "strong"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ": The procedure lacks explicit error handling. Consider adding try-catch blocks to manage exceptions and ensure that errors are logged for troubleshooting."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Hardcoded Values",
                  "marks": [
                    {
                      "type": "strong"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ": The use of hardcoded values like 'O', '262', and 'BT' can reduce flexibility. Consider parameterizing these values if they are subject to change."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Function Dependency",
                  "marks": [
                    {
                      "type": "strong"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ": The procedure relies on a custom function "
                },
                {
                  "type": "text",
                  "text": "[dbo].ConvertDateToYYYYMMDD",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ", which must be present and correctly implemented in the database."
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "type": "heading",
      "attrs": {
        "level": 1
      },
      "content": [
        {
          "type": "text",
          "text": "7. Stored Procedure Definition"
        }
      ]
    },
    {
      "type": "codeBlock",
      "attrs": {
        "language": "sql"
      },
      "content": [
        {
          "type": "text",
          "text": "-- =============================================\n-- Author:\t\tDerek Ho\r\n-- Create date: <Create Date,,>\r\n\r\n-- Description:\t\r\n/*\r\n\tData setup for Cris:\r\n\tBillingAction= O -original\r\n\tGasRateCode= '262'\r\n\tNumberOfBillingPeriods= 1\r\n\tSalesType = 'BT'\r\n\tMeterType = 'G'\r\n*/\r\n-- =============================================\r\nCREATE PROCEDURE [NationalGridWest].[usp_Cris_ProcessAccountData] \r\n\t@AuthenticatedUserID INT\r\nAS\r\nBEGIN\r\n\t\r\n\tTRUNCATE TABLE [NationalGridWest].[UploadLegacyKeyspanWestAccountBillingAdjustmentGas]\r\n\tINSERT INTO [NationalGridWest].[UploadLegacyKeyspanWestAccountBillingAdjustmentGas]\r\n       ([AdjustedAccount]\r\n       ,[AdjustedAccountBilling]\r\n       ,[AdjustedAccountBillingGas]\r\n       ,[AccountUtilityCompanySeqid]\r\n       ,[OriginalAccountNumber]\r\n       ,[FacilityName]\r\n       ,[ServiceAddress]\r\n       ,[BillingPeriod]\r\n       ,[BillingPeriodRevision]\r\n       ,[AccountStatus]\r\n       ,[AccountpreviousStatus]\r\n       ,[AccountStatusPeriod]\r\n       ,[CurrentInvoiceAccountBillingGroup]\r\n       ,[NumberOfTransactions]\r\n       ,[NumberOfRebillTransactions]\r\n       ,[NumberOfCancelTransactions]\r\n       ,[FirstCanceledBillingPeriod]\r\n       ,[EstimatedOrActualBilling]\r\n       ,[InitialCancelFromDate]\r\n       ,[CurrentBillingToDate]\r\n       ,[NumberOfBillingPeriods]\r\n       ,[TotalBillingDaysRebilled]\r\n       ,[TotalRebilledAmount]\r\n       ,[TotalCanceledAmount]\r\n       ,[PriorRevisedBilledAmount]\r\n       ,[RevisedBilledAmount]\r\n       ,[CanceledBilledAmount]\r\n       ,[PriorRevisedCCF]\r\n       ,[RevisedCCF]\r\n       ,[CanceledCCF]\r\n       ,[PriorRevisedTherms]\r\n       ,[RevisedTherms]\r\n       ,[CanceledTherms]\r\n       ,[AverageRebillCostOfGasCharge]\r\n       ,[AverageRebillThermsFactor]\r\n       ,[BillingDays]\r\n       ,[BillingDate]\r\n       ,[ToDate]\r\n       ,[FromDate]\r\n       ,[BillingAction]\r\n       ,[ProcessedInTheCurrentPeriod]\r\n       ,[GasRateCode]\r\n       ,[TotalCCF]\r\n       ,[TotalTherms]\r\n       ,[ThermsFactor]\r\n       ,[CancelFromDate]\r\n       ,[CancelToDate]\r\n       ,[CancelTotalCCF]\r\n       ,[CancelTotalTherms]\r\n       ,[CancelThermsFactor]\r\n       ,[CancelBillingDays]\r\n       ,[ProcessEffectiveDate]\r\n       ,[DerivedFromSpannedBill]\r\n       ,[SpannedBillingPeriodRevision]\r\n       ,[SpannedFirstCanceledBillingPeriod]\r\n       ,[SpannedBilledAmount]\r\n       ,[SpannedCCF]\r\n       ,[SpannedThermFactor]\r\n       ,[SpannedTherm]\r\n       ,[SpannedMonthlyPercentage]\r\n       ,[SpannedTotalPercentage]\r\n       ,[BillCreationDate]\r\n       ,[PostMarkDate]\r\n       ,[DatePaymentDue]\r\n       ,[DateAcceptanceIntoOEC]\r\n       ,[NetPaidAdjustmentAmount]\r\n       ,[EnergySource]\r\n       ,[BillingCycle]\r\n       ,[SalesType]\r\n       ,[ManualPaymentOverride]\r\n       ,[ManualDataEntry]\r\n       ,[DiscountedAmount]\r\n       ,[DiscountPercentage]\r\n       ,[IsTimeOfDayAccount]\r\n       ,[LastPeriodModified]\r\n       ,[BalanceDollars]\r\n       ,[CreditDollars]\r\n       ,[Notes]\r\n       ,[AuthenticatedUserID]\r\n       ,[DateAdded]\r\n       ,[LastUpdate])\r\n\t\tselect\r\n            NULL --(<AdjustedAccount, seqid,>\r\n           ,NULL -- <AdjustedAccountBilling, seqid,>\r\n           ,NULL -- <AdjustedAccountBillingGas, seqid,>\r\n           ,UtilityCompanyID --<AccountUtilityCompanySeqid, seqid,>\r\n           ,AccountNumber --<OriginalAccountNumber, acctnum,>\r\n           ,ServiceAccountName --<FacilityName, UtilityServiceAccountName,>\r\n           ,LTRIM(RTRIM(ServiceAddress)) -- <ServiceAddress, addr,>\r\n           ,BillingPeriod --<BillingPeriod, yyyymm,>\r\n           ,BillingPeriodRevision -- <BillingPeriodRevision, yyyymm,>\r\n           ,NULL --<AccountStatus, AccountStatus,>\r\n           ,NULL --<AccountpreviousStatus, AccountStatus,>\r\n           ,NULL --<AccountStatusPeriod, yyyymm,>\r\n           ,AccountInvoiceBillingGroup --<CurrentInvoiceAccountBillingGroup, seqid,>\r\n           ,1 --<NumberOfTransactions, Accumulator,>\r\n           ,1 --<NumberOfRebillTransactions, Accumulator,>\r\n           ,0 --<NumberOfCancelTransactions, Accumulator,>\r\n           ,FirstCancelPeriod --<FirstCanceledBillingPeriod, yyyymm,>\r\n           ,EstimatedCode --<EstimatedOrActualBilling, varchar(3),>\r\n           ,NULL --<InitialCancelFromDate, yyyymmdd,>\r\n           ,NULL --<CurrentBillingToDate, yyyymmdd,>\r\n           ,1 --<NumberOfBillingPeriods, Accumulator,>\r\n           ,BillingDays --<TotalBillingDaysRebilled, Accumulator,>\r\n           ,billedAmount --<TotalRebilledAmount, BillingAmt,>\r\n           ,0--<TotalCanceledAmount, BillingAmt,>\r\n           ,NULL --<PriorRevisedBilledAmount, BillingAmt,>\r\n           ,excelPaymentDollars --<RevisedBilledAmount, BillingAmt,>\r\n           ,0 --<CanceledBilledAmount, BillingAmt,>\r\n           \r\n           ,NULL --<PriorRevisedCCF, EnergyUnit,>\r\n           ,TotalCCF --<RevisedCCF, EnergyUnit,>\r\n           ,NULL --<CanceledCCF, EnergyUnit,>\r\n           \r\n           ,NULL --<PriorRevisedTherms, EnergyUnit,>\r\n           ,TotalTherms --<RevisedTherms, EnergyUnit,>\r\n           ,NULL --<CanceledTherms, EnergyUnit,>\r\n           \r\n           ,NULL --<AverageRebillCostOfGasCharge, BillingAmt,>\r\n           ,ThermsFactor --<AverageRebillThermsFactor, ThermsFactor,>\r\n           ,BillingDays -- <BillingDays, Accumulator,>\r\n           ,NULL --<BillingDate, yyyymmdd,>\r\n           ,ToDate --<ToDate, yyyymmdd,>\r\n           ,FromDate --<FromDate, yyyymmdd,>\r\n           ,'O' --<BillingAction, BillingAction,>\r\n           ,'Y' --<ProcessedInTheCurrentPeriod, yesnoWithDefaultNo,>\r\n           ,'262'--<GasRateCode, GasRateCode,> \r\n           ,TotalCCF --<TotalCCF, EnergyUnit,>\r\n           ,TotalTherms --<TotalTherms, EnergyUnit,>\r\n           ,ThermsFactor --<ThermsFactor, ThermsFactor,>\r\n           ,NULL --<CancelFromDate, yyyymmdd,>\r\n           ,NULL --<CancelToDate, yyyymmdd,>\r\n           ,NULL --<CancelTotalCCF, EnergyUnit,>\r\n           ,NULL --<CancelTotalTherms, EnergyUnit,>\r\n           ,NULL --<CancelThermsFactor, ThermsFactor,>\r\n           ,NULL --<CancelBillingDays, Accumulator,>\r\n           ,[dbo].ConvertDateToYYYYMMDD (GETDATE()) --<ProcessEffectiveDate, yyyymmdd,>\r\n           ,'N' --<DerivedFromSpannedBill, yesnoWithDefaultNo,>\r\n           ,NULL --<SpannedBillingPeriodRevision, yyyymm,>\r\n           ,NULL --<SpannedFirstCanceledBillingPeriod, yyyymm,>\r\n           ,NULL --<SpannedBilledAmount, BillingAmt,>\r\n           ,NULL --<SpannedCCF, EnergyUnit,>\r\n           ,NULL --<SpannedThermFactor, ThermsFactor,>\r\n           ,NULL --<SpannedTherm, EnergyUnit,>\r\n           ,NULL --<SpannedMonthlyPercentage, SpannedPercentage,>\r\n           ,NULL --<SpannedTotalPercentage, SpannedPercentage,>\r\n           ,NULL --<BillCreationDate, yyyymmdd,>\r\n           ,NULL --<PostMarkDate, yyyymmdd,>\r\n           ,NULL --<DatePaymentDue, yyyymmdd,>\r\n           ,NULL --<DateAcceptanceIntoOEC, yyyymmdd,>\r\n           ,excelPaidAdjustmentDollars --<NetPaidAdjustmentAmount, BillingAmt,>\r\n           ,'5' --<EnergySource, EnergySource,>\r\n           ,'M' --<BillingCycle, MonthlyBillingCycle,>\r\n           ,'BT' --<SalesType, SalesType,>\r\n           ,'N' --<ManualPaymentOverride, yesnoWithDefaultNo,>\r\n           ,'N' --<ManualDataEntry, yesnoWithDefaultNo,>\r\n           ,0 --<DiscountedAmount, BillingAmt,>\r\n           ,0 --<DiscountPercentage, DiscountPercentage,>\r\n           ,'N' --<IsTimeOfDayAccount, yesnoWithDefaultNo,>\r\n           ,BillingPeriodRevision --<LastPeriodModified, yyyymm,>\r\n           ,excelBalanceDollars --<BalanceDollars, BillingAmt,>\r\n           ,excelCreditDollars --<CreditDollars, BillingAmt,>\r\n           ,'Legacy Billing data treatd as a single billing period independent of the number of periods covered' --<Notes, notes,>\r\n           ,@AuthenticatedUserID --<AuthenticatedUserID, AuthenticatedUserID,>\r\n           ,GETDATE() --<DateAdded, DateAdded,>\r\n           ,getdate() --<LastUpdate, LastUpdate,>\r\n       FROM NationalGridWest.UploadCrisAccountMeterBilling\r\n       WHERE transactionType = 'A'\r\n\t\r\nEND"
        }
      ]
    }
  ]
}