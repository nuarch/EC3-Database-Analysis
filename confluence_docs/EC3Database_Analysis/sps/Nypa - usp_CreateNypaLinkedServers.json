{
  "version": 1,
  "type": "doc",
  "content": [
    {
      "type": "bodiedExtension",
      "attrs": {
        "extensionType": "com.atlassian.confluence.macro.core",
        "extensionKey": "details",
        "parameters": {
          "macroParams": {
            "hidden": {
              "value": "true"
            }
          },
          "macroMetadata": {
            "schemaVersion": {
              "value": "1"
            },
            "title": "Page Properties"
          }
        }
      },
      "content": [
        {
          "type": "table",
          "attrs": {
            "isNumberColumnEnabled": false,
            "layout": "default"
          },
          "content": [
            {
              "type": "tableRow",
              "content": [
                {
                  "type": "tableHeader",
                  "attrs": {
                    "colspan": 1,
                    "background": "#f4f5f7",
                    "rowspan": 1
                  },
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "text": "Schema Name",
                          "type": "text",
                          "marks": [
                            {
                              "type": "strong"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "attrs": {
                    "colspan": 1,
                    "rowspan": 1
                  },
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "text": "Nypa",
                          "type": "text"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": "tableRow",
              "content": [
                {
                  "type": "tableHeader",
                  "attrs": {
                    "colspan": 1,
                    "background": "#f4f5f7",
                    "rowspan": 1
                  },
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "text": "Stored Procedure Name",
                          "type": "text",
                          "marks": [
                            {
                              "type": "strong"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "attrs": {
                    "colspan": 1,
                    "rowspan": 1
                  },
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "text": "usp_CreateNypaLinkedServers",
                          "type": "text"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": "tableRow",
              "content": [
                {
                  "type": "tableHeader",
                  "attrs": {
                    "colspan": 1,
                    "background": "#f4f5f7",
                    "rowspan": 1
                  },
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "text": "Complexity Level",
                          "type": "text",
                          "marks": [
                            {
                              "type": "strong"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "attrs": {
                    "colspan": 1,
                    "rowspan": 1
                  },
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "text": "Low",
                          "type": "text"
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "type": "heading",
      "attrs": {
        "level": 1
      },
      "content": [
        {
          "type": "text",
          "text": "1. Overview"
        }
      ]
    },
    {
      "type": "paragraph",
      "content": [
        {
          "type": "text",
          "text": "The stored procedure "
        },
        {
          "type": "text",
          "text": "usp_CreateNypaLinkedServers",
          "marks": [
            {
              "type": "code"
            }
          ]
        },
        {
          "type": "text",
          "text": " is designed to create several linked servers in a Microsoft SQL Server environment. These linked servers are configured to connect to text files located on a network share using the Microsoft Jet OLE DB 4.0 provider. The procedure is part of the "
        },
        {
          "type": "text",
          "text": "Nypa",
          "marks": [
            {
              "type": "code"
            }
          ]
        },
        {
          "type": "text",
          "text": " schema and is intended to facilitate access to various data files related to billing and account information. The procedure includes commented-out sections that suggest additional linked servers be added if needed."
        }
      ]
    },
    {
      "type": "heading",
      "attrs": {
        "level": 1
      },
      "content": [
        {
          "type": "text",
          "text": "2. Complexity Level: Low"
        }
      ]
    },
    {
      "type": "paragraph",
      "content": [
        {
          "type": "text",
          "text": "The complexity level of this stored procedure is low. It primarily consists of a series of "
        },
        {
          "type": "text",
          "text": "sp_addlinkedserver",
          "marks": [
            {
              "type": "code"
            }
          ]
        },
        {
          "type": "text",
          "text": " calls, which are straightforward to implement. There is no conditional logic, looping, or complex data manipulation involved."
        }
      ]
    },
    {
      "type": "heading",
      "attrs": {
        "level": 1
      },
      "content": [
        {
          "type": "text",
          "text": "3. Input Parameters"
        }
      ]
    },
    {
      "type": "bulletList",
      "content": [
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "@Status int OUTPUT",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ": This is an output parameter intended to indicate the success or failure of the procedure. However, the current implementation does not set or modify this parameter, rendering it ineffective in its current state."
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "type": "heading",
      "attrs": {
        "level": 1
      },
      "content": [
        {
          "type": "text",
          "text": "4. Business Logic and Workflow"
        }
      ]
    },
    {
      "type": "bulletList",
      "content": [
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The procedure's main task is to create linked servers using the "
                },
                {
                  "type": "text",
                  "text": "sp_addlinkedserver",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " system stored procedure."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Each linked server is configured to connect to a specific text file located on a network share ("
                },
                {
                  "type": "text",
                  "text": "\\\\dcasec3\\NypaCurrentBillingCycle\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ")."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The linked servers are named according to the type of data they are intended to access (e.g., "
                },
                {
                  "type": "text",
                  "text": "NypaEncoreBilling",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ", "
                },
                {
                  "type": "text",
                  "text": "NypaCoverSheet",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ")."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The procedure includes commented-out lines for additional linked servers, indicating potential future expansion or modification."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The procedure does not include any error handling or logic to check if the linked servers already exist before attempting to create them."
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "type": "heading",
      "attrs": {
        "level": 1
      },
      "content": [
        {
          "type": "text",
          "text": "5. Performance Considerations"
        }
      ]
    },
    {
      "type": "bulletList",
      "content": [
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The creation of linked servers is a lightweight operation, but the performance impact will depend on the network latency and the size of the files being accessed."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Since the procedure does not check for existing linked servers, running it multiple times results in errors or redundant operations, which affect performance."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The use of the Microsoft Jet OLE DB 4.0 provider have limitations in terms of performance and scalability, especially with large datasets."
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "type": "heading",
      "attrs": {
        "level": 1
      },
      "content": [
        {
          "type": "text",
          "text": "6. Potential Issues or Risks"
        }
      ]
    },
    {
      "type": "bulletList",
      "content": [
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Lack of Error Handling",
                  "marks": [
                    {
                      "type": "strong"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ": The procedure does not include any error handling mechanisms. If any of the "
                },
                {
                  "type": "text",
                  "text": "sp_addlinkedserver",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " calls fail, the procedure will not capture or report these errors."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Redundancy",
                  "marks": [
                    {
                      "type": "strong"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ": Without checks for existing linked servers, the procedure may attempt to create servers that already exist, leading to errors."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Security Risks",
                  "marks": [
                    {
                      "type": "strong"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ": The procedure accesses files on a network share, which could pose security risks if the share is not properly secured."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Obsolete Technology",
                  "marks": [
                    {
                      "type": "strong"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ": The Microsoft Jet OLE DB 4.0 provider is considered outdated and may not be supported in future SQL Server versions. This could lead to compatibility issues."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Unused Output Parameter",
                  "marks": [
                    {
                      "type": "strong"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ": The "
                },
                {
                  "type": "text",
                  "text": "@Status",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " output parameter is not utilized, which could lead to confusion or misinterpretation of the procedure's success or failure status."
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "type": "heading",
      "attrs": {
        "level": 1
      },
      "content": [
        {
          "type": "text",
          "text": "7. Stored Procedure Definition"
        }
      ]
    },
    {
      "type": "codeBlock",
      "attrs": {
        "language": "sql"
      },
      "content": [
        {
          "type": "text",
          "text": "CREATE PROCEDURE [Nypa].[usp_CreateNypaLinkedServers] @Status int  OUTPUT\n   \r\n AS --**************************************************************************************\r\n--* Name:         \r\n--*\r\n--* Description:  Not Used\r\n---*               \r\n--* Exec:       \t\tusp_CreateNypaLinkedServers\r\n--*\r\n--* Parameter(s):         @Status int output\r\n--*\r\n--*\tSet ANSI_null on\r\n--*\tgo\r\n\r\n--* Database:     OEC\r\n--*\r\n--* Return:\t    0 Success\r\n--*                   9 Failure\r\n--*\r\n--* AUTHOR:       Peter Heller (PAH)\r\n--* Created On:   5/05/2006\r\n--**************************************************************************************\r\n--* Date         Tech Description of Change\r\n--* ---------- ----  -------------------------------------------------------------\r\n--* 10/26/2005 PAH  First Version \r\n--**************************************************************************************\r\n\r\n--**************************************************************************************\r\n--Declare Variables\r\n--**************************************************************************************\r\n--\r\n--**************************************************************************************\r\n--Set defaults\r\n--**************************************************************************************\r\n\r\n--**************************************************************************************\r\n--Main Process\r\n--**************************************************************************************\r\n--\r\nEXEC sp_addlinkedserver NypaEncoreBilling, 'Jet 4.0','Microsoft.Jet.OLEDB.4.0', '\\\\dcasec3\\NypaCurrentBillingCycle\\EncoreBilling', NULL, 'Text' \r\n--\r\nEXEC sp_addlinkedserver NypaCoverSheet, 'Jet 4.0','Microsoft.Jet.OLEDB.4.0', '\\\\dcasec3\\NypaCurrentBillingCycle\\Coversheet', NULL, 'Text' \r\n--\r\nEXEC sp_addlinkedserver NypaExchangeData, 'Jet 4.0','Microsoft.Jet.OLEDB.4.0', '\\\\dcasec3\\NypaCurrentBillingCycle\\ExchangeData', NULL, 'Text' \r\n--\r\nEXEC sp_addlinkedserver NypaAccountBilling, 'Jet 4.0','Microsoft.Jet.OLEDB.4.0', '\\\\dcasec3\\NypaCurrentBillingCycle\\AccountBilling', NULL, 'Text' \r\n--\r\nEXEC sp_addlinkedserver NypaMeterBilling, 'Jet 4.0','Microsoft.Jet.OLEDB.4.0', '\\\\dcasec3\\NypaCurrentBillingCycle\\MeterBilling', NULL, 'Text' \r\n--\r\nEXEC sp_addlinkedserver NypaAllActiveAccounts, 'Jet 4.0','Microsoft.Jet.OLEDB.4.0', '\\\\dcasec3\\NypaCurrentBillingCycle\\AllActiveAccounts', NULL, 'Text' \r\n------\r\n----EXEC sp_addlinkedserver NypaAllActiveMeters, 'Jet 4.0','Microsoft.Jet.OLEDB.4.0', '\\\\dcasec3\\NypaCurrentBillingCycle\\AllActiveMeters', NULL, 'Text' \r\n------\r\n------\r\n----EXEC sp_addlinkedserver NypaStreetLighting, 'Jet 4.0','Microsoft.Jet.OLEDB.4.0', '\\\\dcasec3\\NypaCurrentBillingCycle\\StreetLighting', NULL, 'Text' \r\n------\r\n--\r\n--EXEC sp_addlinkedserver NypaCoverSheetSeny, 'Jet 4.0','Microsoft.Jet.OLEDB.4.0', '\\\\dcasec3\\t$\\UploadDataFiles\\NYPA\\CoverSheetSeny', NULL, 'Text' \r\n--"
        }
      ]
    }
  ]
}