{
  "version": 1,
  "type": "doc",
  "content": [
    {
      "type": "bodiedExtension",
      "attrs": {
        "extensionType": "com.atlassian.confluence.macro.core",
        "extensionKey": "details",
        "parameters": {
          "macroParams": {
            "hidden": {
              "value": "true"
            }
          },
          "macroMetadata": {
            "schemaVersion": {
              "value": "1"
            },
            "title": "Page Properties"
          }
        }
      },
      "content": [
        {
          "type": "table",
          "attrs": {
            "isNumberColumnEnabled": false,
            "layout": "default"
          },
          "content": [
            {
              "type": "tableRow",
              "content": [
                {
                  "type": "tableHeader",
                  "attrs": {
                    "colspan": 1,
                    "background": "#f4f5f7",
                    "rowspan": 1
                  },
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "text": "Schema Name",
                          "type": "text",
                          "marks": [
                            {
                              "type": "strong"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "attrs": {
                    "colspan": 1,
                    "rowspan": 1
                  },
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "text": "Published",
                          "type": "text"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": "tableRow",
              "content": [
                {
                  "type": "tableHeader",
                  "attrs": {
                    "colspan": 1,
                    "background": "#f4f5f7",
                    "rowspan": 1
                  },
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "text": "Stored Procedure Name",
                          "type": "text",
                          "marks": [
                            {
                              "type": "strong"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "attrs": {
                    "colspan": 1,
                    "rowspan": 1
                  },
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "text": "PrePublishing_AdjustAccountEffectiveDates",
                          "type": "text"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": "tableRow",
              "content": [
                {
                  "type": "tableHeader",
                  "attrs": {
                    "colspan": 1,
                    "background": "#f4f5f7",
                    "rowspan": 1
                  },
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "text": "Complexity Level",
                          "type": "text",
                          "marks": [
                            {
                              "type": "strong"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "attrs": {
                    "colspan": 1,
                    "rowspan": 1
                  },
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "text": "Medium",
                          "type": "text"
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "type": "heading",
      "attrs": {
        "level": 1
      },
      "content": [
        {
          "type": "text",
          "text": "1. Overview"
        }
      ]
    },
    {
      "type": "paragraph",
      "content": [
        {
          "type": "text",
          "text": "The stored procedure "
        },
        {
          "type": "text",
          "text": "PrePublishing_AdjustAccountEffectiveDates",
          "marks": [
            {
              "type": "code"
            }
          ]
        },
        {
          "type": "text",
          "text": " is designed to adjust and synchronize date fields across several tables within the "
        },
        {
          "type": "text",
          "text": "Billing",
          "marks": [
            {
              "type": "code"
            }
          ]
        },
        {
          "type": "text",
          "text": " schema of the "
        },
        {
          "type": "text",
          "text": "OEC",
          "marks": [
            {
              "type": "code"
            }
          ]
        },
        {
          "type": "text",
          "text": " database. It primarily focuses on converting placeholder dates ("
        },
        {
          "type": "text",
          "text": "99999999",
          "marks": [
            {
              "type": "code"
            }
          ]
        },
        {
          "type": "text",
          "text": ") to a more standardized future date ("
        },
        {
          "type": "text",
          "text": "99991231",
          "marks": [
            {
              "type": "code"
            }
          ]
        },
        {
          "type": "text",
          "text": ") and ensuring that effective dates in the "
        },
        {
          "type": "text",
          "text": "AccountExchangeMeterTrack",
          "marks": [
            {
              "type": "code"
            }
          ]
        },
        {
          "type": "text",
          "text": " table are consistent with those in the "
        },
        {
          "type": "text",
          "text": "Account",
          "marks": [
            {
              "type": "code"
            }
          ]
        },
        {
          "type": "text",
          "text": " and "
        },
        {
          "type": "text",
          "text": "Meter",
          "marks": [
            {
              "type": "code"
            }
          ]
        },
        {
          "type": "text",
          "text": " tables. The procedure also includes several "
        },
        {
          "type": "text",
          "text": "SELECT",
          "marks": [
            {
              "type": "code"
            }
          ]
        },
        {
          "type": "text",
          "text": " statements to retrieve and presumably verify the data after updates."
        }
      ]
    },
    {
      "type": "heading",
      "attrs": {
        "level": 1
      },
      "content": [
        {
          "type": "text",
          "text": "2. Complexity Level: Medium"
        }
      ]
    },
    {
      "type": "paragraph",
      "content": [
        {
          "type": "text",
          "text": "The complexity of this stored procedure is considered medium. It involves multiple update operations across different tables, conditional logic to ensure data consistency, and several "
        },
        {
          "type": "text",
          "text": "SELECT",
          "marks": [
            {
              "type": "code"
            }
          ]
        },
        {
          "type": "text",
          "text": " statements for data verification. The logic is straightforward but involves multiple steps and joins, which increases its complexity."
        }
      ]
    },
    {
      "type": "heading",
      "attrs": {
        "level": 1
      },
      "content": [
        {
          "type": "text",
          "text": "3. Input Parameters"
        }
      ]
    },
    {
      "type": "paragraph",
      "content": [
        {
          "type": "text",
          "text": "This stored procedure does not take any input parameters. It operates on the entire dataset within the specified tables, applying the same logic universally without filtering or customization based on input values."
        }
      ]
    },
    {
      "type": "heading",
      "attrs": {
        "level": 1
      },
      "content": [
        {
          "type": "text",
          "text": "4. Business Logic and Workflow"
        }
      ]
    },
    {
      "type": "bulletList",
      "content": [
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Date Conversion",
                  "marks": [
                    {
                      "type": "strong"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ": The procedure begins by updating date fields in three tables ("
                },
                {
                  "type": "text",
                  "text": "Account",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ", "
                },
                {
                  "type": "text",
                  "text": "Meter",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ", and "
                },
                {
                  "type": "text",
                  "text": "AccountExchangeMeterTrack",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ") to replace "
                },
                {
                  "type": "text",
                  "text": "99999999",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " with "
                },
                {
                  "type": "text",
                  "text": "99991231",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ". This is likely to standardize the representation of an indefinite future date."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Data Synchronization",
                  "marks": [
                    {
                      "type": "strong"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                }
              ]
            },
            {
              "type": "bulletList",
              "content": [
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "It checks and updates the "
                        },
                        {
                          "type": "text",
                          "text": "AccountExchangeMeterTrack",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": " table to ensure that the "
                        },
                        {
                          "type": "text",
                          "text": "AccountEffectiveBillingStartDate",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": " and "
                        },
                        {
                          "type": "text",
                          "text": "AccountEffectiveBillingEndDate",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": " match the "
                        },
                        {
                          "type": "text",
                          "text": "AccountEffectiveTurnOn",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": " and "
                        },
                        {
                          "type": "text",
                          "text": "AccountEffectiveTurnOff",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": " dates from the "
                        },
                        {
                          "type": "text",
                          "text": "Account",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": " table."
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Similarly, it synchronizes the "
                        },
                        {
                          "type": "text",
                          "text": "MeterEffectiveBillingStartDate",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": " and "
                        },
                        {
                          "type": "text",
                          "text": "MeterEffectiveBillingEndDate",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": " in "
                        },
                        {
                          "type": "text",
                          "text": "AccountExchangeMeterTrack",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": " with the "
                        },
                        {
                          "type": "text",
                          "text": "MeterEffectiveOnDate",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": " and "
                        },
                        {
                          "type": "text",
                          "text": "MeterEffectiveOffDate",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": " from the "
                        },
                        {
                          "type": "text",
                          "text": "Meter",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": " table."
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Data Verification",
                  "marks": [
                    {
                      "type": "strong"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ": The procedure includes several "
                },
                {
                  "type": "text",
                  "text": "SELECT",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " statements to retrieve data for verification purposes:"
                }
              ]
            },
            {
              "type": "bulletList",
              "content": [
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "It checks for discrepancies between the effective dates in "
                        },
                        {
                          "type": "text",
                          "text": "Account",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": " and "
                        },
                        {
                          "type": "text",
                          "text": "AccountExchangeMeterTrack",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": "."
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "It retrieves accounts with effective turn-on dates starting with "
                        },
                        {
                          "type": "text",
                          "text": "9999",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": ", which may indicate accounts with indefinite start dates."
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "It checks for mismatches between "
                        },
                        {
                          "type": "text",
                          "text": "AccountEffectiveTurnOff",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": " and "
                        },
                        {
                          "type": "text",
                          "text": "AccountEffectiveBillingEndDate",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": ", as well as "
                        },
                        {
                          "type": "text",
                          "text": "AccountEffectiveTurnOn",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": " and "
                        },
                        {
                          "type": "text",
                          "text": "AccountEffectiveBillingStartDate",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": "."
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "type": "heading",
      "attrs": {
        "level": 1
      },
      "content": [
        {
          "type": "text",
          "text": "5. Performance Considerations"
        }
      ]
    },
    {
      "type": "bulletList",
      "content": [
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Table Scans",
                  "marks": [
                    {
                      "type": "strong"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ": The updates and selects without indexed columns or conditions could lead to full table scans, which may impact performance, especially if the tables are large."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Concurrency",
                  "marks": [
                    {
                      "type": "strong"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ": The procedure updates multiple tables, which could lead to locking issues if executed concurrently by multiple sessions."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Batch Processing",
                  "marks": [
                    {
                      "type": "strong"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ": If the tables are large, consider processing the updates in batches to reduce transaction size and potential locking."
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "type": "heading",
      "attrs": {
        "level": 1
      },
      "content": [
        {
          "type": "text",
          "text": "6. Potential Issues or Risks"
        }
      ]
    },
    {
      "type": "bulletList",
      "content": [
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Data Integrity",
                  "marks": [
                    {
                      "type": "strong"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ": The procedure assumes that all "
                },
                {
                  "type": "text",
                  "text": "99999999",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " dates should be converted to "
                },
                {
                  "type": "text",
                  "text": "99991231",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ". If "
                },
                {
                  "type": "text",
                  "text": "99999999",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " has a specific business meaning in some contexts, this could lead to data integrity issues."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Concurrency and Locking",
                  "marks": [
                    {
                      "type": "strong"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ": The updates could cause locking issues, especially if the procedure is run frequently or on large datasets."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Lack of Error Handling",
                  "marks": [
                    {
                      "type": "strong"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ": The procedure does not include error handling, which could lead to unhandled exceptions and incomplete updates if an error occurs."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "No Logging",
                  "marks": [
                    {
                      "type": "strong"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ": There is no logging mechanism to track changes made by the procedure, which could be important for auditing and troubleshooting."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Assumptions on Data Consistency",
                  "marks": [
                    {
                      "type": "strong"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ": The procedure assumes that discrepancies between effective dates in different tables should always be resolved by aligning them, which may not always be the correct business decision."
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "type": "heading",
      "attrs": {
        "level": 1
      },
      "content": [
        {
          "type": "text",
          "text": "7. Stored Procedure Definition"
        }
      ]
    },
    {
      "type": "codeBlock",
      "attrs": {
        "language": "sql"
      },
      "content": [
        {
          "type": "text",
          "text": "CREATE     procedure [Published].[PrePublishing_AdjustAccountEffectiveDates]\nAS --**************************************************************************************\r\n--* Name:         \r\n--*\r\n--* Description:  Process the various date adjustments\r\n--*            \r\n--*               \r\n--* Exec:        PrePublishing_AdjustAccountEffectiveDates\r\n--*\r\n--* Parameter(s):         \r\n--*\r\n--*\r\n--* Database:     OEC\r\n--*\r\n--* Return:\t    \r\n--*             \r\n--*\r\n--* AUTHOR:       Peter Heller (PAH)\r\n--* Created On:   06/06/2014\r\n--**************************************************************************************\r\n--* Date         Tech Description of Change\r\n--* ---------- ----  -------------------------------------------------------------\r\n--* 06/06/2014 PAH  First Version  \r\n--***************************************************************************************\r\nBegin \r\n--************************************************************************************** \r\n--Declare Variables                                            \r\n--**************************************************************************************    \r\n\r\n\r\n--**************************************************************************************    \r\n\r\n/*\r\n\t\tConvert all 99999999 dates to 99991231\r\n*/\r\n        update  Billing.Account\r\n        set     AccountEffectiveTurnOff = '99991231'\r\n        where   ( AccountEffectiveTurnOff = '99999999' )\r\n\r\n        update  Billing.Meter\r\n        set     MeterEffectiveOffDate = '99991231'\r\n        where   ( MeterEffectiveOffDate = '99999999' )\r\n\r\n        update  Billing.AccountExchangeMeterTrack\r\n        set     AccountEffectiveBillingEndDate = '99991231'\r\n        where   ( AccountEffectiveBillingEndDate = '99999999' )\r\n\r\n        update  Billing.AccountExchangeMeterTrack\r\n        set     AccountEffectiveBillingStartDate = '99991231'\r\n        where   ( AccountEffectiveBillingStartDate = '99999999' )\r\n\r\n        update  Billing.AccountExchangeMeterTrack\r\n        set     MeterEffectiveBillingEndDate = '99991231'\r\n        where   ( MeterEffectiveBillingEndDate = '99999999' )\r\n\r\n        update  Billing.AccountExchangeMeterTrack\r\n        set     MeterEffectiveBillingStartDate = '99991231'\r\n        where   ( MeterEffectiveBillingStartDate = '99999999' )\r\n\r\n/*\r\n\t\tUpdate the changes based upon exchanges occuring in the published billing period to the Billing.AccountExchangeMeterTrack\r\n\t\tfor accounts and meters\r\n*/\r\n        select  aemt.AccountEffectiveBillingStartDate\r\n        ,       aemt.AccountEffectiveBillingEndDate\r\n        ,       a.AccountEffectiveTurnOn\r\n        ,       a.AccountEffectiveTurnOff\r\n        FROM Billing.Account as a\r\n                inner join Billing.AccountExchangeMeterTrack as aemt on aemt.OriginalAccountSeqid = a.AccountSeqid\r\n        where   aemt.AccountEffectiveBillingStartDate <> a.AccountEffectiveTurnOn\r\n                or aemt.AccountEffectiveBillingEndDate <> a.AccountEffectiveTurnOff\r\n\r\n        update  Billing.AccountExchangeMeterTrack\r\n        set     AccountEffectiveBillingStartDate = a.AccountEffectiveTurnOn\r\n        ,       AccountEffectiveBillingEndDate = a.AccountEffectiveTurnOff\r\n        FROM Billing.Account as a\r\n                inner join Billing.AccountExchangeMeterTrack as aemt on aemt.OriginalAccountSeqid = a.AccountSeqid\r\n        where   aemt.AccountEffectiveBillingStartDate <> a.AccountEffectiveTurnOn\r\n                or aemt.AccountEffectiveBillingEndDate <> a.AccountEffectiveTurnOff                                                            \r\n\r\n        select  aemt.MeterEffectiveBillingStartDate\r\n        ,       aemt.MeterEffectiveBillingEndDate\r\n        ,       m.MeterEffectiveOnDate\r\n        ,       m.MeterEffectiveOffDate\r\n        FROM Billing.Meter as m\r\n                inner join Billing.AccountExchangeMeterTrack as aemt on aemt.OriginalMeterSeqid = m.MeterSeqid\r\n        where   aemt.MeterEffectiveBillingStartDate <> m.MeterEffectiveOnDate\r\n                or aemt.MeterEffectiveBillingEndDate <> m.MeterEffectiveOffDate\r\n\r\n\r\n\r\n        update  Billing.AccountExchangeMeterTrack\r\n        set     MeterEffectiveBillingStartDate = m.MeterEffectiveOnDate\r\n        ,       MeterEffectiveBillingEndDate = m.MeterEffectiveOffDate\r\n        FROM Billing.Meter as m\r\n                inner join Billing.AccountExchangeMeterTrack as aemt on aemt.OriginalMeterSeqid = m.MeterSeqid\r\n        where   aemt.MeterEffectiveBillingStartDate <> m.MeterEffectiveOnDate\r\n                or aemt.MeterEffectiveBillingEndDate <> m.MeterEffectiveOffDate\r\n\r\n\r\n        select  a.AccountStatus\r\n        ,       A.UtilityServiceAccountName\r\n        ,       A.UtilityServiceAddress\r\n        ,       a.AccountPreviousStatus\r\n        ,       a.AccountStatusCodePeriod\r\n        ,       a.AccountSeqid\r\n        ,       a.CurrentAccountNumber\r\n        ,       a.OriginalAccountNumber\r\n        ,       aemt.AccountEffectiveBillingStartDate\r\n        ,       aemt.AccountEffectiveBillingEndDate\r\n        ,       a.AccountEffectiveTurnOn\r\n        ,       a.AccountEffectiveTurnOff\r\n        FROM Billing.Account as a\r\n                inner join Billing.AccountExchangeMeterTrack as aemt on aemt.OriginalAccountSeqid = a.AccountSeqid\r\n        where   a.AccountEffectiveTurnOn like '9999%'\r\n\r\n        select  a.AccountStatus\r\n        ,       a.AccountPreviousStatus\r\n        ,       a.AccountStatusCodePeriod\r\n        ,       a.AccountSeqid\r\n        ,       a.CurrentAccountNumber\r\n        ,       a.OriginalAccountNumber\r\n        ,       aemt.AccountEffectiveBillingStartDate\r\n        ,       aemt.AccountEffectiveBillingEndDate\r\n        ,       a.AccountEffectiveTurnOn\r\n        ,       a.AccountEffectiveTurnOff\r\n        FROM Billing.Account as a\r\n                inner join Billing.AccountExchangeMeterTrack as aemt on aemt.OriginalAccountSeqid = a.AccountSeqid\r\n        where   a.AccountEffectiveTurnOff <> aemt.AccountEffectiveBillingEndDate\r\n                or a.AccountEffectiveTurnOn <> aemt.AccountEffectiveBillingStartDate\r\n\t\r\n    end"
        }
      ]
    }
  ]
}