{
  "version": 1,
  "type": "doc",
  "content": [
    {
      "type": "bodiedExtension",
      "attrs": {
        "extensionType": "com.atlassian.confluence.macro.core",
        "extensionKey": "details",
        "parameters": {
          "macroParams": {
            "hidden": {
              "value": "true"
            }
          },
          "macroMetadata": {
            "schemaVersion": {
              "value": "1"
            },
            "title": "Page Properties"
          }
        }
      },
      "content": [
        {
          "type": "table",
          "attrs": {
            "isNumberColumnEnabled": false,
            "layout": "default"
          },
          "content": [
            {
              "type": "tableRow",
              "content": [
                {
                  "type": "tableHeader",
                  "attrs": {
                    "colspan": 1,
                    "background": "#f4f5f7",
                    "rowspan": 1
                  },
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "text": "Schema Name",
                          "type": "text",
                          "marks": [
                            {
                              "type": "strong"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "attrs": {
                    "colspan": 1,
                    "rowspan": 1
                  },
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "text": "CrisNationalGridWest",
                          "type": "text"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": "tableRow",
              "content": [
                {
                  "type": "tableHeader",
                  "attrs": {
                    "colspan": 1,
                    "background": "#f4f5f7",
                    "rowspan": 1
                  },
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "text": "Stored Procedure Name",
                          "type": "text",
                          "marks": [
                            {
                              "type": "strong"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "attrs": {
                    "colspan": 1,
                    "rowspan": 1
                  },
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "text": "usp_CRIS_ArchiveRawActualBillPreloadData",
                          "type": "text"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": "tableRow",
              "content": [
                {
                  "type": "tableHeader",
                  "attrs": {
                    "colspan": 1,
                    "background": "#f4f5f7",
                    "rowspan": 1
                  },
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "text": "Complexity Level",
                          "type": "text",
                          "marks": [
                            {
                              "type": "strong"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "attrs": {
                    "colspan": 1,
                    "rowspan": 1
                  },
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "text": "Medium",
                          "type": "text"
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "type": "heading",
      "attrs": {
        "level": 1
      },
      "content": [
        {
          "type": "text",
          "text": "1. Overview"
        }
      ]
    },
    {
      "type": "paragraph",
      "content": [
        {
          "type": "text",
          "text": "The stored procedure "
        },
        {
          "type": "text",
          "text": "usp_CRIS_ArchiveRawActualBillPreloadData",
          "marks": [
            {
              "type": "code"
            }
          ]
        },
        {
          "type": "text",
          "text": " is designed to archive data from several staging tables into corresponding historical tables within a SQL Server database. It is part of a data management process that involves moving data from temporary or working tables to permanent storage for historical reference. The procedure performs a series of "
        },
        {
          "type": "text",
          "text": "INSERT INTO... SELECT",
          "marks": [
            {
              "type": "code"
            }
          ]
        },
        {
          "type": "text",
          "text": " operations to transfer data from the "
        },
        {
          "type": "text",
          "text": "CrisNationalGridWest",
          "marks": [
            {
              "type": "code"
            }
          ]
        },
        {
          "type": "text",
          "text": " schema's preload tables to the "
        },
        {
          "type": "text",
          "text": "ActualBill",
          "marks": [
            {
              "type": "code"
            }
          ]
        },
        {
          "type": "text",
          "text": " schema's history tables."
        }
      ]
    },
    {
      "type": "heading",
      "attrs": {
        "level": 1
      },
      "content": [
        {
          "type": "text",
          "text": "2. Complexity Level: Medium"
        }
      ]
    },
    {
      "type": "paragraph",
      "content": [
        {
          "type": "text",
          "text": "The complexity level of this stored procedure is considered medium. It involves multiple data transfer operations across several tables, each with a significant number of columns. The procedure is straightforward in terms of logic but requires careful handling due to the volume of data and the number of operations performed."
        }
      ]
    },
    {
      "type": "heading",
      "attrs": {
        "level": 1
      },
      "content": [
        {
          "type": "text",
          "text": "3. Input Parameters"
        }
      ]
    },
    {
      "type": "bulletList",
      "content": [
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "@StatusCode int OUTPUT",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ": This is an output parameter used to indicate the execution status of the stored procedure. It is set to "
                },
                {
                  "type": "text",
                  "text": "0",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " upon successful completion of the procedure, indicating success."
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "type": "heading",
      "attrs": {
        "level": 1
      },
      "content": [
        {
          "type": "text",
          "text": "4. Business Logic and Workflow"
        }
      ]
    },
    {
      "type": "orderedList",
      "content": [
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Archiving Data",
                  "marks": [
                    {
                      "type": "strong"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ": The procedure archives data from five different preload tables:"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "type": "bulletList",
      "content": [
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "UploadAccountBillingDetailPreload",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "UploadExchangeDetailPreload",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "UploadMeterReadDetailPreload",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "UploadPaymentDetailPreload",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "UploadBillingSummaryPreload",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "type": "orderedList",
      "content": [
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Data Transfer",
                  "marks": [
                    {
                      "type": "strong"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ": For each table, the procedure performs an "
                },
                {
                  "type": "text",
                  "text": "INSERT INTO... SELECT",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " operation, copying all columns from the source table in the "
                },
                {
                  "type": "text",
                  "text": "CrisNationalGridWest",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " schema to the corresponding history table in the "
                },
                {
                  "type": "text",
                  "text": "ActualBill",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " schema."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Status Code Setting",
                  "marks": [
                    {
                      "type": "strong"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ": After all data transfer operations are completed, the procedure sets the "
                },
                {
                  "type": "text",
                  "text": "@StatusCode",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " to "
                },
                {
                  "type": "text",
                  "text": "0",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ", indicating successful execution."
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "type": "heading",
      "attrs": {
        "level": 1
      },
      "content": [
        {
          "type": "text",
          "text": "5. Performance Considerations"
        }
      ]
    },
    {
      "type": "bulletList",
      "content": [
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Data Volume",
                  "marks": [
                    {
                      "type": "strong"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ": The procedure handles large volumes of data, which can impact performance. The size of the data being transferred should be monitored to ensure that the database can handle the load without performance degradation."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Transaction Management",
                  "marks": [
                    {
                      "type": "strong"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ": The procedure does not explicitly manage transactions. If any "
                },
                {
                  "type": "text",
                  "text": "INSERT",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " operation fails, it results in partial data transfer. Implementing transaction management ensure atomicity."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Indexing",
                  "marks": [
                    {
                      "type": "strong"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ": Ensure that the target history tables are appropriately indexed to handle the "
                },
                {
                  "type": "text",
                  "text": "INSERT",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " operations efficiently and to support any subsequent queries on these tables."
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "type": "heading",
      "attrs": {
        "level": 1
      },
      "content": [
        {
          "type": "text",
          "text": "6. Potential Issues or Risks"
        }
      ]
    },
    {
      "type": "bulletList",
      "content": [
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Data Integrity",
                  "marks": [
                    {
                      "type": "strong"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ": Without transaction management, there is a risk of partial data transfer if an error occurs during execution. This could lead to inconsistencies between the source and target tables."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Error Handling",
                  "marks": [
                    {
                      "type": "strong"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ": The procedure lacks error handling mechanisms. If an error occurs during data transfer, it will not be captured or logged, making troubleshooting difficult."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Scalability",
                  "marks": [
                    {
                      "type": "strong"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ": As data volume grows, the procedure may face scalability issues. Consider partitioning the tables or implementing batch processing to handle large datasets more efficiently."
                }
              ]
            }
          ]
        },
        {
          "type": "listItem",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Concurrency",
                  "marks": [
                    {
                      "type": "strong"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ": If the source tables are being updated concurrently with the execution of this procedure, it could lead to data inconsistencies. Implementing locking mechanisms or using snapshot isolation levels could mitigate this risk."
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "type": "paragraph",
      "content": [
        {
          "type": "text",
          "text": "Overall, while the procedure is straightforward in its logic, careful consideration of performance and data integrity aspects is crucial to ensure reliable and efficient operation."
        }
      ]
    },
    {
      "type": "heading",
      "attrs": {
        "level": 1
      },
      "content": [
        {
          "type": "text",
          "text": "7. Stored Procedure Definition"
        }
      ]
    },
    {
      "type": "codeBlock",
      "attrs": {
        "language": "sql"
      },
      "content": [
        {
          "type": "text",
          "text": "CREATE PROCEDURE [CrisNationalGridWest].[usp_CRIS_ArchiveRawActualBillPreloadData] @StatusCode int  OUTPUT\n   \r\nAS \r\n--**************************************************************************************\r\n--* Name:         \r\n--*\r\n--* Description:  \r\n--*               \r\n--*               \r\n--*               \r\n--* Exec:         [CrisNationalGridWest].[usp_CRIS_ArchiveRawActualBillPreloadData]\r\n--*\r\n--* Parameter(s):         \r\n--*                            StatusCode  int output       \t   -  Execution Return Status \r\n--*\r\n--* Database:     OEC\r\n--*\r\n--* Return:\t    0 Success\r\n--*                   9 Failure\r\n--*\r\n--* AUTHOR:       Peter Heller (PAH)\r\n--* Created On:   10/17/2006\r\n--**************************************************************************************\r\n--* Date         Tech Description of Change\r\n--* ---------- ----  -------------------------------------------------------------\r\n--* 09/15/2010 PAH  First Version  \r\n--***************************************************************************************\r\nBegin \r\n--************************************************************************************** \r\n--\tMain Processing\r\n--**************************************************************************************\r\n--\r\n--\tInsert Applied payment details to the prior months account billing row\r\n--\r\n-- Save UploadAccountBillingDetailPreload to Archive\r\n--\r\nINSERT INTO ActualBill.HistoryCrisNationalGridWestUploadAccountBillingDetailPreload\r\n                      (UploadAccountBillingDetailPreloadSeqid, UtilityCompanyID, AccountBillingGroup, BillingPeriod, BillingPeriodRevision, AccountNumber, Filler1, \r\n                      MeterReadWorkDay, UtilityServiceAccountName, UtilityServiceAddress, Borough, Zipcode, State, ActivityCode, ActivityDate, ActivityTime, \r\n                      TransactionCode, SpecialLedgerAccountNUmber, SpecialLedgerWorkDay, Filler2, GasRateCode, BillFrequency, EstimatedOrActualBillingCode, \r\n                      GasChargeAmount, BillingFromDate, BillingToDate, BillRenderDate, BillingDays, BilledCCF, ThermFactor, BilledTherms, NumberOfMeters, BillType, \r\n                      CommodityChargeAmount, DeliveryChargeAmount, MTACommodityTax, MTADeliveryTax, SalesTax, SystemBenefitsCharge, \r\n                      RetailDecouplingMechanismCharge, DeliveryRateSurcharge, RealTimeNormalizationCharge, LatePaymentCharge, PaperBillCharge, \r\n                      CommodityCostFactor, MTACommodityFactor, MTADeliveryFactor, SalesTaxFactor, SystemBenefitChargeFactor, RetailDecouplingMechanismFactor, \r\n                      DeliveryRateSurchargeFactor, RealTimeNormalizationFactor, LatePaymentFactor, CurrentAccountBalance, AccountArrears, TerminationBalance, \r\n                      TotalPaymentsPosted, DateLastPayment, MiscellaneousChargeAmount, MiscellaneousChargeType)\r\nSELECT  UploadAccountBillingDetailPreloadSeqid, UtilityCompanyID, \r\n                      AccountBillingGroup, BillingPeriod, BillingPeriodRevision, AccountNumber, Filler1, MeterReadWorkDay, UtilityServiceAccountName, \r\n                      UtilityServiceAddress, Borough, Zipcode, State, ActivityCode, ActivityDate, ActivityTime, TransactionCode, SpecialLedgerAccountNUmber, \r\n                      SpecialLedgerWorkDay, Filler2, GasRateCode, BillFrequency, EstimatedOrActualBillingCode, GasChargeAmount, BillingFromDate, BillingToDate, \r\n                      BillRenderDate, BillingDays, BilledCCF, ThermFactor, BilledTherms, NumberOfMeters, BillType, CommodityChargeAmount, DeliveryChargeAmount, \r\n                      MTACommodityTax, MTADeliveryTax, SalesTax, SystemBenefitsCharge, RetailDecouplingMechanismCharge, DeliveryRateSurcharge, \r\n                      RealTimeNormalizationCharge, LatePaymentCharge, PaperBillCharge, CommodityCostFactor, MTACommodityFactor, MTADeliveryFactor, \r\n                      SalesTaxFactor, SystemBenefitChargeFactor, RetailDecouplingMechanismFactor, DeliveryRateSurchargeFactor, RealTimeNormalizationFactor, \r\n                      LatePaymentFactor, CurrentAccountBalance, AccountArrears, TerminationBalance, TotalPaymentsPosted, DateLastPayment, \r\n                      MiscellaneousChargeAmount, MiscellaneousChargeType\r\nFROM CrisNationalGridWest.UploadAccountBillingDetailPreload\r\n--\r\n--\r\n-- Save UploadExchangeDetailPreload to Archive\r\n--\r\nINSERT INTO ActualBill.HistoryCrisNationalGridWestUploadExchangeDetailPreload\r\n                      (UploadExchangeDetailPreloadSeqid, UtilityCompanyID, AccountBillingGroup, BillingPeriod, BillingPeriodRevision, AccountNumber, Filler1, \r\n                      MeterReadWorkDay, UtilityServiceAccountName, UtilityServiceAddress, Borough, Zipcode, State, ActivityCode, ActivityDate, ActivityTime, \r\n                      TransactionCode, SpecialLedgerAccountNUmber, SpecialLedgerWorkDay, Filler2, ExchangeCode, MeterNumber, MeterConstant, NumberOfDials, \r\n                      MeterType, GasRateCode, RateCodeChangeDate, MeterStatus, OldMeterStatus, MeterEffectiveActionDate, MeterStatusChangeReason, \r\n                      AccountTerminationDate, AccountStatus, OldAccountStatus, OldMeterNumber, AccountStartDate, OldGasRateCode, OldMeterReadWorkDay)\r\n                      \r\nselect\t\t\tUploadExchangeDetailPreloadSeqid, UtilityCompanyID, AccountBillingGroup, BillingPeriod, BillingPeriodRevision, AccountNumber, Filler1, \r\n                      MeterReadWorkDay, UtilityServiceAccountName, UtilityServiceAddress, Borough, Zipcode, State, ActivityCode, ActivityDate, ActivityTime, \r\n                      TransactionCode, SpecialLedgerAccountNUmber, SpecialLedgerWorkDay, Filler2, ExchangeCode, MeterNumber, MeterConstant, NumberOfDials, \r\n                      MeterType, GasRateCode, RateCodeChangeDate, MeterStatus, OldMeterStatus, MeterEffectiveActionDate, MeterStatusChangeReason, \r\n                      AccountTerminationDate, AccountStatus, OldAccountStatus, OldMeterNumber, AccountStartDate, OldGasRateCode, OldMeterReadWorkDay\r\nfrom CrisNationalGridWest.UploadExchangeDetailPreload                      \r\n--\r\n-- Save UploadMeterReadDetailPreload to Archive\r\n--\r\nINSERT INTO ActualBill.HistoryCrisNationalGridWestUploadMeterReadDetailPreload\r\n                      (UploadMeterReadDetailPreloadSeqid, UtilityCompanyID, AccountBillingGroup, BillingPeriod, BillingPeriodRevision, AccountNumber, Filler1, \r\n                      MeterReadWorkDay, UtilityServiceAccountName, UtilityServiceAddress, Borough, Zipcode, State, ActivityCode, ActivityDate, ActivityTime, \r\n                      TransactionCode, SpecialLedgerAccountNumber, SpecialLedgerWorkDay, Filler2, MeterNumber, MeterConstant, NumberOfDials, MeterReadType, \r\n                      EstimatedOrActual, MeterReadStatus, MeterReadSource, MeterReadReason, MeterType, MeterReadingFromDate, MeterReadingToDate, \r\n                      MeterFromReading, MeterToReading, MeterReadTime, MeterCCF, FixFactor, PartSupplied, HasMeterRolledOver)\r\nselect\t\t\t\t  UploadMeterReadDetailPreloadSeqid, UtilityCompanyID, AccountBillingGroup, BillingPeriod, BillingPeriodRevision, AccountNumber, Filler1, \r\n                      MeterReadWorkDay, UtilityServiceAccountName, UtilityServiceAddress, Borough, Zipcode, State, ActivityCode, ActivityDate, ActivityTime, \r\n                      TransactionCode, SpecialLedgerAccountNumber, SpecialLedgerWorkDay, Filler2, MeterNumber, MeterConstant, NumberOfDials, MeterReadType, \r\n                      EstimatedOrActual, MeterReadStatus, MeterReadSource, MeterReadReason, MeterType, MeterReadingFromDate, MeterReadingToDate, \r\n                      MeterFromReading, MeterToReading, MeterReadTime, MeterCCF, FixFactor, PartSupplied, HasMeterRolledOver\r\nfrom CrisNationalGridWest.UploadMeterReadDetailPreload\r\n--\r\n-- Save UploadPaymentDetailPreload to Archive\r\n--\r\n\r\nINSERT INTO ActualBill.HistoryCrisNationalGridWestUploadPaymentDetailPreload\r\n                      (UtilityCompanyID, AccountBillingGroup, BillingPeriod, BillingPeriodRevision, AccountNumber, Filler1, MeterReadWorkDay, \r\n                      UtilityServiceAccountName, UtilityServiceAddress, Borough, Zipcode, State, ActivityCode, ActivityDate, ActivityTime, TransactionCode, \r\n                      SLAccountNUmber, SLWorkDay, Filler2, AccountStatus, PaymentAmount, PaymentDate, CurrentAccountBalance, AcountArrears, TerminationBalance, \r\n                      OldCurrentAccountBalance, OldAcountArrears, OldTerminationBalance, MiscellaneousCreditAmount, MiscellaneousCreditType, GasRateCode)\r\nselect\t\t\t\t  UtilityCompanyID, AccountBillingGroup, BillingPeriod, BillingPeriodRevision, AccountNumber, Filler1, MeterReadWorkDay, \r\n                      UtilityServiceAccountName, UtilityServiceAddress, Borough, Zipcode, State, ActivityCode, ActivityDate, ActivityTime, TransactionCode, \r\n                      SLAccountNUmber, SLWorkDay, Filler2, AccountStatus, PaymentAmount, PaymentDate, CurrentAccountBalance, AcountArrears, TerminationBalance, \r\n                      OldCurrentAccountBalance, OldAcountArrears, OldTerminationBalance, MiscellaneousCreditAmount, MiscellaneousCreditType, GasRateCode\r\nFROM CrisNationalGridWest.UploadPaymentDetailPreload                    \r\n--\r\n-- Save UploadAccountBillingDetailPreload to Archive\r\n--\r\nINSERT INTO ActualBill.HistoryCrisNationalGridWestUploadUploadBillingSummaryPreload\r\n                      (UtilityCompanySeqid, InvoiceBillingGroup, BillingPeriod, OriginalAdjustment, GasRateCode, TotalBilledAmount, TotalCanceledAmount, \r\n                      TotalNetAmount, TotalBilledCCF, TotalCanceledCCF, TotalNetCCF, TotalBilledTherms, TotalCanceledTherms, TotalNetTherms, \r\n                      TotalBilledMTACommodityTax, TotalBilledMTADeliveryTax, TotalBilledDeliveryChargeAmount, TotalBilledCommodityChargeAmount, \r\n                      TotalBilledSalesTax, TotalBilledSystemBenefitsCharge, TotalBilledRetailDecouplingMechanismCharge, TotalDeliveryRateSurcharge, \r\n                      TotalRealTimeNormalizationCharge, TotalBilledPaperBillCharge, TotalCanceledMTACommodityTax, TotalCanceledMTADeliveryTax, \r\n                      TotalCanceledDeliveryChargeAmount, TotalCanceledCommodityChargeAmount, TotalCanceledSalesTax, TotalCanceledSystemBenefitsCharge, \r\n                      TotalCanceledRetailDecouplingMechanismCharge, TotalCanceledDeliveryRateSurcharge, TotalCanceledRealTimeNormalizationCharge, \r\n                      TotalCanceledPaperBillCharge, TotalNetMTACommodityTax, TotalNetMTADeliveryTax, TotalNetDeliveryChargeAmount, \r\n                      TotalNetCommodityChargeAmount, TotalNetSalesTax, TotalNetSystemBenefitsCharge, TotalNetRetailDecouplingMechanismCharge, \r\n                      TotalNetDeliveryRateSurcharge, TotalNetRealTimeNormalizationCharge, TotalNetPaperBillCharge, TotalPaymentsPosted, TotalNetCredits, \r\n                      TotalNetCreditsFinalledAccounts)\r\nSELECT UtilityCompanySeqid, InvoiceBillingGroup, BillingPeriod, OriginalAdjustment, GasRateCode, TotalBilledAmount, TotalCanceledAmount, TotalNetAmount,\r\n                       TotalBilledCCF, TotalCanceledCCF, TotalNetCCF, TotalBilledTherms, TotalCanceledTherms, TotalNetTherms, TotalBilledMTACommodityTax, \r\n                      TotalBilledMTADeliveryTax, TotalBilledDeliveryChargeAmount, TotalBilledCommodityChargeAmount, TotalBilledSalesTax, \r\n                      TotalBilledSystemBenefitsCharge, TotalBilledRetailDecouplingMechanismCharge, TotalDeliveryRateSurcharge, TotalRealTimeNormalizationCharge, \r\n                      TotalBilledPaperBillCharge, TotalCanceledMTACommodityTax, TotalCanceledMTADeliveryTax, TotalCanceledDeliveryChargeAmount, \r\n                      TotalCanceledCommodityChargeAmount, TotalCanceledSalesTax, TotalCanceledSystemBenefitsCharge, \r\n                      TotalCanceledRetailDecouplingMechanismCharge, TotalCanceledDeliveryRateSurcharge, TotalCanceledRealTimeNormalizationCharge, \r\n                      TotalCanceledPaperBillCharge, TotalNetMTACommodityTax, TotalNetMTADeliveryTax, TotalNetDeliveryChargeAmount, \r\n                      TotalNetCommodityChargeAmount, TotalNetSalesTax, TotalNetSystemBenefitsCharge, TotalNetRetailDecouplingMechanismCharge, \r\n                      TotalNetDeliveryRateSurcharge, TotalNetRealTimeNormalizationCharge, TotalNetPaperBillCharge, TotalPaymentsPosted, TotalNetCredits, \r\n                      TotalNetCreditsFinalledAccounts\r\nFROM CrisNationalGridWest.UploadBillingSummaryPreload\r\n--\r\nset @StatusCode = 0\r\n--\r\nend"
        }
      ]
    }
  ]
}