{
  "version": 1,
  "type": "doc",
  "content": [
    {
      "type": "bodiedExtension",
      "attrs": {
        "extensionType": "com.atlassian.confluence.macro.core",
        "extensionKey": "details",
        "parameters": {
          "macroParams": {
            "hidden": {
              "value": "true"
            }
          },
          "macroMetadata": {
            "schemaVersion": {
              "value": "1"
            },
            "title": "Page Properties"
          }
        }
      },
      "content": [
        {
          "type": "table",
          "attrs": {
            "isNumberColumnEnabled": false,
            "layout": "default"
          },
          "content": [
            {
              "type": "tableRow",
              "content": [
                {
                  "type": "tableHeader",
                  "attrs": {
                    "colspan": 1,
                    "background": "#f4f5f7",
                    "rowspan": 1
                  },
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "text": "Schema Name",
                          "type": "text",
                          "marks": [
                            {
                              "type": "strong"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "attrs": {
                    "colspan": 1,
                    "rowspan": 1
                  },
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "text": "dbo",
                          "type": "text"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": "tableRow",
              "content": [
                {
                  "type": "tableHeader",
                  "attrs": {
                    "colspan": 1,
                    "background": "#f4f5f7",
                    "rowspan": 1
                  },
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "text": "Function Name",
                          "type": "text",
                          "marks": [
                            {
                              "type": "strong"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "attrs": {
                    "colspan": 1,
                    "rowspan": 1
                  },
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "text": "ProcessServiceTariff",
                          "type": "text"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": "tableRow",
              "content": [
                {
                  "type": "tableHeader",
                  "attrs": {
                    "colspan": 1,
                    "background": "#f4f5f7",
                    "rowspan": 1
                  },
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "text": "Complexity Level",
                          "type": "text",
                          "marks": [
                            {
                              "type": "strong"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "attrs": {
                    "colspan": 1,
                    "rowspan": 1
                  },
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "text": "Medium",
                          "type": "text"
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "type": "paragraph",
      "content": [
        {
          "type": "text",
          "text": "Certainly! Please provide the SQL code for the "
        },
        {
          "type": "text",
          "text": "ProcessServiceTariff",
          "marks": [
            {
              "type": "code"
            }
          ]
        },
        {
          "type": "text",
          "text": " function so that I can analyze it according to your specified format."
        }
      ]
    },
    {
      "type": "heading",
      "attrs": {
        "level": 1
      },
      "content": [
        {
          "type": "text",
          "text": "2. Function Definition"
        }
      ]
    },
    {
      "type": "codeBlock",
      "attrs": {
        "language": "sql"
      },
      "content": [
        {
          "type": "text",
          "text": "CREATE FUNCTION [dbo].[ProcessServiceTariff]\n(\r\n\t@ServiceTariff AS VARCHAR(14),\r\n\t@CommodityOrDelivery AS VARCHAR(1)\r\n)\r\nRETURNS VARCHAR(3) AS\r\nBEGIN\r\n\tIF (@ServiceTariff = '16-1 /C-1 /062')\r\n\tBEGIN\r\n      IF (@CommodityOrDelivery = 'D')\r\n          RETURN '062';\r\n      ELSE\r\n          RETURN '001';\r\n\tEND;\r\n\tELSE IF (@ServiceTariff = '16-2 /H-1 /069')\r\n\tBEGIN\r\n\t\tIF (@CommodityOrDelivery = 'D')\r\n\t\t\tRETURN '069';\r\n\t\tELSE\r\n\t\t\tRETURN '002';\r\n\tEND;\r\n\tELSE IF (@ServiceTariff = '16-4 /A-1 /091')\r\n\tBEGIN\r\n\t\tIF (@CommodityOrDelivery = 'D')\r\n\t\t\tRETURN '911';\r\n\t\tELSE\r\n\t\t\tRETURN '041';\r\n\tEND;\r\n\tELSE IF (@ServiceTariff = '16-4 /A-1 /091')\r\n\tBEGIN\r\n\t\tIF (@CommodityOrDelivery = 'D')\r\n\t\t\tRETURN '912';\r\n\t\tELSE\r\n\t\t\tRETURN '042';\r\n\tEND;\r\n\tELSE IF (@ServiceTariff = '16-4 /A-2 /093')\r\n\tBEGIN\r\n\t\tIF (@CommodityOrDelivery = 'D')\r\n\t\t\tRETURN '931';\r\n\t\tELSE\r\n\t\t\tRETURN '041';\r\n\tEND;\r\n\tELSE IF (@ServiceTariff = '16-4 /A-3 /098')\r\n\tBEGIN\r\n\t\tIF (@CommodityOrDelivery = 'D')\r\n\t\t\tRETURN '981';\r\n\t\tELSE\r\n\t\t\tRETURN '041';\r\n\tEND;\r\n\r\n\tRETURN 'ERR';\r\nEND;"
        }
      ]
    }
  ]
}